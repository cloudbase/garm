import"../chunks/DsnmJJEf.js";import{i as ct}from"../chunks/TJn6xDN9.js";import{p as vt,o as mt,l as ut,h as gt,f as y,a as de,t as C,b as x,c as xt,u as n,q as J,e as p,g as e,m as k,d as r,s,k as l,r as a,A as pt,i as j,z as se,x as ft,D as Fe,w as Q}from"../chunks/DniTuB_0.js";import{i as $,s as bt,a as yt}from"../chunks/DbNhg6mG.js";import{e as Be,i as Ee}from"../chunks/Ck5PkeSc.js";import{d as ie,c as oe,g as le,r as Se,B as Ue}from"../chunks/DD3srElq.js";import{b as ne}from"../chunks/CCQwxxp9.js";import{p as ht}from"../chunks/D4Caz1gY.js";import{p as _t}from"../chunks/CzKtu-7o.js";import{g as kt}from"../chunks/DeKGyprh.js";import{t as D}from"../chunks/CBJzOE8U.js";import{e as V}from"../chunks/BZiHL9L3.js";import{f as Ce,a as W}from"../chunks/aK-A9Gop.js";import{D as wt}from"../chunks/B6XSaEl0.js";import{M as jt}from"../chunks/PC4wJWhj.js";import{B as $t}from"../chunks/DcQdHuVc.js";var Dt=y('<div class="bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-800 rounded-md p-4 mb-6"><div class="flex"><div class="ml-3"><h3 class="text-sm font-medium text-red-800 dark:text-red-200">Error</h3> <div class="mt-2 text-sm text-red-700 dark:text-red-300"> </div></div></div></div>'),Mt=y('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-6 py-4 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading object details...</p></div></div>'),Ot=y('<div class="flex flex-wrap gap-2"></div>'),Tt=y('<span class="text-gray-500 dark:text-gray-400 italic">No tags</span>'),At=y('<div class="mt-6 bg-white dark:bg-gray-800 shadow rounded-lg p-6"><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Description</h3> <div class="text-sm text-gray-900 dark:text-white whitespace-pre-wrap break-words"> </div></div>'),Ft=y('<div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white">File Information</h3> <div class="flex items-center space-x-3"><button class="px-4 py-2 bg-gray-600 hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-800 text-white rounded-lg font-medium text-sm cursor-pointer">Edit</button> <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white rounded-lg font-medium text-sm cursor-pointer">Download</button> <button class="px-4 py-2 bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-lg font-medium text-sm cursor-pointer">Delete</button></div></div> <dl class="space-y-3"><div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">ID:</dt> <dd class="text-sm font-mono text-gray-900 dark:text-white break-all"> </dd></div> <div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Name:</dt> <dd class="text-sm text-gray-900 dark:text-white"> </dd></div> <div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Size:</dt> <dd class="text-sm text-gray-900 dark:text-white"> </dd></div> <div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">File Type:</dt> <dd class="text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">SHA256:</dt> <dd class="text-xs font-mono text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-2 rounded break-all"> </dd></div></dl></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6"><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Metadata & Timestamps</h3> <dl class="space-y-3"><div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At:</dt> <dd class="text-sm text-gray-900 dark:text-white"> </dd></div> <div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At:</dt> <dd class="text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Tags:</dt> <dd class="text-sm"><!></dd></div></dl></div></div> <!>',1),Bt=y('<span class="inline-flex items-center gap-1 px-2 py-1 text-sm font-medium text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900 rounded-md"> <button type="button" class="inline-flex items-center justify-center w-4 h-4 text-blue-700 dark:text-blue-300 hover:text-blue-900 dark:hover:text-blue-100 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></span>'),Et=y('<div class="max-w-2xl w-full p-6"><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Update Object</h3> <form class="space-y-4"><div><label for="update-file-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">File Name</label> <input id="update-file-name" type="text" class="block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm" placeholder="my-file.bin"/></div> <div><label for="update-file-tags" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tags</label> <div class="block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 min-h-[42px] flex flex-wrap gap-2 items-center"><!> <input id="update-file-tags" type="text" class="flex-1 min-w-[120px] bg-transparent border-none outline-none text-gray-900 dark:text-white text-sm"/></div> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Press Space or Enter to add a tag. Press Backspace on empty field to remove last tag.</p></div> <div><label for="update-file-description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description (optional)</label> <textarea id="update-file-description" maxlength="8192" rows="3" class="block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm resize-y" placeholder="Add a description for this file..."></textarea> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400"> </p></div> <div class="flex justify-end gap-3 pt-4"><!> <!></div></form></div>'),St=y('<nav class="flex mb-6" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Object Storage</a></li> <li><div class="flex items-center"><svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="text-sm font-medium text-gray-500 dark:text-gray-400 ml-1 md:ml-2"> </span></div></li></ol></nav> <!> <!> <!> <!>',1);function Xt(Ie,Le){vt(Le,!1);const[ze,Pe]=bt(),ce=()=>yt(_t,"$page",ze),X=k();let t=k(null),q=k(!0),M=k(""),Y=k(!1),I=k(!1),i=k({name:"",tags:[],description:""}),O=k("");mt(async()=>{await ve()});async function ve(){if(!e(X)){l(M,"Invalid object ID"),l(q,!1);return}try{l(q,!0),l(M,""),l(t,await le.getFileObject(e(X)))}catch(d){l(M,V(d)),D.add({type:"error",title:"Failed to load object",message:e(M)})}finally{l(q,!1)}}async function Ne(){if(e(t)?.id)try{await le.deleteFileObject(e(t).id.toString()),D.add({type:"success",title:"Object deleted",message:`Object "${e(t).name}" has been deleted successfully.`}),kt(ie("/objects"))}catch(d){const o=V(d);D.add({type:"error",title:"Failed to delete object",message:o})}}async function Re(){if(e(t)?.id)try{const o=`${window.location.origin}/api/v1/objects/${e(t).id}/download`,c=await fetch(o,{method:"HEAD",credentials:"include"});if(!c.ok){const u=await c.text();throw new Error(u||`Download failed with status ${c.status}`)}const v=document.createElement("a");v.href=o,v.download=e(t).name||"download",document.body.appendChild(v),v.click(),document.body.removeChild(v),D.add({type:"success",title:"Download started",message:`Downloading "${e(t).name}"...`})}catch(d){const o=V(d);D.add({type:"error",title:"Download failed",message:o})}}function He(){e(t)&&(l(i,{name:e(t).name||"",tags:e(t).tags||[],description:e(t).description||""}),l(O,""),l(I,!0))}async function qe(){if(e(t)?.id)try{await le.updateFileObject(e(t).id.toString(),{name:e(i).name||void 0,tags:e(i).tags,description:e(i).description||void 0}),D.add({type:"success",title:"Object updated",message:"Object has been updated successfully."}),l(I,!1),await ve()}catch(d){const o=V(d);D.add({type:"error",title:"Failed to update object",message:o})}}function Ke(d){const c=d.target.value.trim();(d.key===" "||d.key==="Enter")&&c?(d.preventDefault(),me(c),l(O,"")):d.key==="Backspace"&&!c&&e(i).tags.length>0&&(d.preventDefault(),ue(e(i).tags.length-1))}function Ge(){const d=e(O).trim();d&&(me(d),l(O,""))}function me(d){const o=d.trim().toLowerCase();o&&(e(i).tags.includes(o)||Q(i,e(i).tags=[...e(i).tags,o]))}function ue(d){Q(i,e(i).tags=e(i).tags.filter((o,c)=>c!==d))}ut(()=>ce(),()=>{l(X,ce().params.id||"")}),gt(),ct();var ge=St(),Z=de(ge),xe=r(Z),ee=r(xe),Je=r(ee);a(ee);var pe=s(ee,2),fe=r(pe),be=s(r(fe),2),Qe=r(be,!0);a(be),a(fe),a(pe),a(xe),a(Z);var ye=s(Z,2);{var Ve=d=>{var o=Dt(),c=r(o),v=r(c),u=s(r(v),2),h=r(u,!0);a(u),a(v),a(c),a(o),C(()=>p(h,e(M))),x(d,o)};$(ye,d=>{e(M)&&d(Ve)})}var he=s(ye,2);{var We=d=>{var o=Mt();x(d,o)},Xe=d=>{var o=pt(),c=de(o);{var v=u=>{var h=Ft(),T=de(h),w=r(T),A=r(w),L=s(r(A),2),_=r(L),F=s(_,2),z=s(F,2);a(L),a(A);var P=s(A,2),N=r(P),R=s(r(N),2),K=r(R,!0);a(R),a(N);var H=s(N,2),m=s(r(H),2),B=r(m,!0);a(m),a(H);var b=s(H,2),E=s(r(b),2),G=r(E,!0);a(E),a(b);var S=s(b,2),ke=s(r(S),2),tt=r(ke,!0);a(ke),a(S);var we=s(S,2),je=s(r(we),2),at=r(je,!0);a(je),a(we),a(P),a(w);var $e=s(w,2),De=s(r($e),2),te=r(De),Me=s(r(te),2),rt=r(Me,!0);a(Me),a(te);var ae=s(te,2),Oe=s(r(ae),2),dt=r(Oe,!0);a(Oe),a(ae);var Te=s(ae,2),Ae=s(r(Te),2),st=r(Ae);{var it=g=>{var f=Ot();Be(f,5,()=>(e(t),n(()=>e(t).tags)),Ee,(U,re)=>{$t(U,{variant:"blue",get text(){return e(re)}})}),a(f),x(g,f)},ot=g=>{var f=Tt();x(g,f)};$(st,g=>{e(t),n(()=>e(t).tags&&e(t).tags.length>0)?g(it):g(ot,!1)})}a(Ae),a(Te),a(De),a($e),a(T);var lt=s(T,2);{var nt=g=>{var f=At(),U=s(r(f),2),re=r(U,!0);a(U),a(f),C(()=>p(re,(e(t),n(()=>e(t).description)))),x(g,f)};$(lt,g=>{e(t),n(()=>e(t).description)&&g(nt)})}C((g,f,U)=>{p(K,(e(t),n(()=>e(t).id))),p(B,(e(t),n(()=>e(t).name))),p(G,g),p(tt,(e(t),n(()=>e(t).file_type||"N/A"))),p(at,(e(t),n(()=>e(t).sha256||"N/A"))),p(rt,f),p(dt,U)},[()=>(J(Ce),e(t),n(()=>Ce(e(t).size||0))),()=>(J(W),e(t),n(()=>W(e(t).created_at))),()=>(J(W),e(t),n(()=>W(e(t).updated_at)))]),j("click",_,He),j("click",F,Re),j("click",z,()=>l(Y,!0)),x(u,h)};$(c,u=>{e(t)&&u(v)},!0)}x(d,o)};$(he,d=>{e(q)?d(We):d(Xe,!1)})}var _e=s(he,2);{var Ye=d=>{jt(d,{$$events:{close:()=>l(I,!1)},children:(o,c)=>{var v=Et(),u=s(r(v),2),h=r(u),T=s(r(h),2);Se(T),a(h);var w=s(h,2),A=s(r(w),2),L=r(A);Be(L,1,()=>(e(i),n(()=>e(i).tags)),Ee,(m,B,b)=>{var E=Bt(),G=r(E),S=s(G);a(E),C(()=>{p(G,`${e(B)??""} `),oe(S,"aria-label",`Remove tag ${e(B)??""}`)}),j("click",S,()=>ue(b)),x(m,E)});var _=s(L,2);Se(_),a(A),se(2),a(w);var F=s(w,2),z=s(r(F),2);ft(z);var P=s(z,2),N=r(P);a(P),a(F);var R=s(F,2),K=r(R);Ue(K,{type:"button",variant:"secondary",$$events:{click:()=>l(I,!1)},children:(m,B)=>{se();var b=Fe("Cancel");x(m,b)},$$slots:{default:!0}});var H=s(K,2);Ue(H,{type:"submit",variant:"primary",children:(m,B)=>{se();var b=Fe("Update Object");x(m,b)},$$slots:{default:!0}}),a(R),a(u),a(v),C(()=>{oe(_,"placeholder",(e(i),n(()=>e(i).tags.length===0?"Type and press Space or Enter":""))),p(N,`${e(i),n(()=>e(i).description.length)??""} / 8192 characters`)}),ne(T,()=>e(i).name,m=>Q(i,e(i).name=m)),ne(_,()=>e(O),m=>l(O,m)),j("keydown",_,Ke),j("blur",_,Ge),ne(z,()=>e(i).description,m=>Q(i,e(i).description=m)),j("submit",u,ht(qe)),x(o,v)},$$slots:{default:!0}})};$(_e,d=>{e(I)&&e(t)&&d(Ye)})}var Ze=s(_e,2);{var et=d=>{wt(d,{title:"Delete Object",get message(){return`Are you sure you want to delete the object '${e(t),n(()=>e(t).name)??""}'? This action cannot be undone.`},$$events:{confirm:Ne,close:()=>l(Y,!1)}})};$(Ze,d=>{e(Y)&&e(t)&&d(et)})}C(d=>{oe(Je,"href",d),p(Qe,(e(t),n(()=>e(t)?e(t).name:"Object Details")))},[()=>(J(ie),n(()=>ie("/objects")))]),x(Ie,ge),xt(),Pe()}export{Xt as component};
