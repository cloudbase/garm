import"../chunks/DsnmJJEf.js";import{i as ze}from"../chunks/C7KraPli.js";import{p as He,o as Ve,A as We,l as Ke,h as Qe,f as _,j as Xe,a as F,t as b,b as u,c as Ye,u as i,q as g,e as n,g as t,m as k,d as r,s,k as v,$ as Ze,r as a,w as M,B as Qt,v as E}from"../chunks/cPTQ2Ibn.js";import{i as f}from"../chunks/DqFqoVWr.js";import{e as ta,i as ea}from"../chunks/CiWDXYQd.js";import{d as $,c as gt,g as C,s as aa}from"../chunks/DqbUkQgD.js";import{p as Xt}from"../chunks/BgSaD1r_.js";import{g as Yt}from"../chunks/CTvJf3dP.js";import{U as ra}from"../chunks/2Xl6sR6s.js";import{D as Zt}from"../chunks/91PQ6UtW.js";import{I as da}from"../chunks/DliFOxtc.js";import{D as sa}from"../chunks/oOdVuDuv.js";import{w as te}from"../chunks/BV_mDmfH.js";import{t as T}from"../chunks/Bgbd8SZ5.js";import{e as D,i as L,j as ee,b as O,g as ae}from"../chunks/DJsB5Z5V.js";import{e as G}from"../chunks/BZiHL9L3.js";var ia=_('<div class="p-6 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading pool...</p></div>'),oa=_('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),la=_('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Install Template</dt> <dd class="mt-1"><a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></dd></div>'),na=_('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">GitHub Runner Group</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div>'),va=_('<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"> </span>'),ma=_('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Tags</dt> <dd class="mt-1"><div class="flex flex-wrap gap-2"></div></dd></div>'),ca=_('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Extra Specifications</h2> <pre class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md overflow-x-auto text-sm text-gray-900 dark:text-white font-mono"> </pre></div></div>'),xa=_('<!> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Basic Information</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Pool ID</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white font-mono"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Provider</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Image</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"><code class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs"> </code></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Flavor</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Status</dt> <dd class="mt-1"><span> </span></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Entity</dt> <dd class="mt-1"><div class="flex items-center space-x-2"><span class="inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"> </span> <a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></div></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Configuration</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Max Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Min Idle Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Bootstrap Timeout</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Priority</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Prefix</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">OS Type / Architecture</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <!> <!> <!></dl></div></div></div> <!> <!>',1),ua=_('<div class="space-y-6"><nav class="flex" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg> Pools</a></li> <li><div class="flex items-center"><svg class="w-3 h-3 text-gray-400 mx-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"> </span></div></li></ol></nav> <!></div> <!> <!> <!>',1);function Aa(re,de){He(de,!1);const J=k();let e=k(null),j=k(!0),A=k(""),U=k(!1),S=k(!1),B=k(!1),p=k(null),N=null;async function se(){if(t(J))try{v(j,!0),v(A,""),v(e,await C.getPool(t(J))),t(e).instances||M(e,t(e).instances=[])}catch(d){v(A,G(d))}finally{v(j,!1)}}async function ie(d){if(t(e))try{const o=await C.updatePool(t(e).id,d);v(e,o),v(U,!1),T.success("Pool Updated",`Pool ${t(e).id} has been updated successfully.`)}catch(o){const y=G(o);T.error("Update Failed",y)}}async function oe(){if(t(e)){try{await C.deletePool(t(e).id),Yt($("/pools"))}catch(d){const o=G(d);T.error("Delete Failed",o)}v(S,!1)}}async function le(){if(t(p)){try{await C.deleteInstance(t(p).name),T.success("Instance Deleted",`Instance ${t(p).name} has been deleted successfully.`)}catch(d){const o=G(d);T.error("Delete Failed",o)}v(B,!1),v(p,null)}}function ne(d){v(p,d),v(B,!0)}function ve(d){if(!d)return"{}";try{if(typeof d=="string"){const o=JSON.parse(d);return JSON.stringify(o,null,2)}return JSON.stringify(d,null,2)}catch{return d.toString()}}function me(d){if(d.operation==="update"){const o=d.payload;t(e)&&o.id===t(e).id&&v(e,o)}else if(d.operation==="delete"){const o=d.payload.id||d.payload;t(e)&&t(e).id===o&&Yt($("/pools"))}}function ce(d){if(!t(e))return;const o=d.payload;if(o.pool_id===t(e).id){if(t(e).instances||M(e,t(e).instances=[]),d.operation==="create")M(e,t(e).instances=[...t(e).instances,o]);else if(d.operation==="update")M(e,t(e).instances=t(e).instances.map(y=>y.id===o.id?o:y));else if(d.operation==="delete"){const y=o.id||o;M(e,t(e).instances=t(e).instances.filter(V=>V.id!==y))}v(e,t(e))}}Ve(()=>{se();const d=te.subscribeToEntity("pool",["update","delete"],me),o=te.subscribeToEntity("instance",["create","update","delete"],ce);N=()=>{d(),o()}}),We(()=>{N&&(N(),N=null)}),Ke(()=>Xt,()=>{v(J,Xt.params.id)}),Qe(),ze();var ft=ua();Xe(d=>{b(()=>Ze.title=`${t(e),i(()=>t(e)?`Pool ${t(e).id} - Pool Details`:"Pool Details")??""} - GARM`)});var q=F(ft),z=r(q),pt=r(z),H=r(pt),xe=r(H);a(H);var _t=s(H,2),yt=r(_t),ht=s(r(yt),2),ue=r(ht,!0);a(ht),a(yt),a(_t),a(pt),a(z);var ge=s(z,2);{var fe=d=>{var o=ia();u(d,o)},pe=d=>{var o=Qt(),y=F(o);{var V=I=>{var P=oa(),R=r(P),W=r(R,!0);a(R),a(P),b(()=>n(W,t(A))),u(I,P)},ke=I=>{var P=Qt(),R=F(P);{var W=K=>{var wt=xa(),It=F(wt);{let l=E(()=>(g(D),t(e),i(()=>D(t(e))))),m=E(()=>(g(L),t(e),i(()=>L(t(e))))),c=E(()=>(g(ae),t(e),i(()=>ae(t(e).endpoint?.endpoint_type||"unknown"))));sa(It,{get title(){return t(e),i(()=>t(e).id)},get subtitle(){return`Pool for ${t(l)??""} (${t(m)??""})`},get forgeIcon(){return t(c)},onEdit:()=>v(U,!0),onDelete:()=>v(S,!0)})}var Q=s(It,2),X=r(Q),Pt=r(X),$t=s(r(Pt),2),Y=r($t),Dt=s(r(Y),2),we=r(Dt,!0);a(Dt),a(Y);var Z=s(Y,2),Mt=s(r(Z),2),Ie=r(Mt,!0);a(Mt),a(Z);var tt=s(Z,2),Et=s(r(tt),2),Tt=r(Et),Pe=r(Tt,!0);a(Tt),a(Et),a(tt);var et=s(tt,2),At=s(r(et),2),$e=r(At,!0);a(At),a(et);var at=s(et,2),Ut=s(r(at),2),rt=r(Ut),De=r(rt,!0);a(rt),a(Ut),a(at);var dt=s(at,2),St=s(r(dt),2),Bt=r(St),st=r(Bt),Me=r(st,!0);a(st);var it=s(st,2),Ee=r(it,!0);a(it),a(Bt),a(St),a(dt);var ot=s(dt,2),Nt=s(r(ot),2),Te=r(Nt,!0);a(Nt),a(ot);var Rt=s(ot,2),Ft=s(r(Rt),2),Ae=r(Ft,!0);a(Ft),a(Rt),a($t),a(Pt),a(X);var Ct=s(X,2),Lt=r(Ct),Ot=s(r(Lt),2),lt=r(Ot),Gt=s(r(lt),2),Ue=r(Gt,!0);a(Gt),a(lt);var nt=s(lt,2),Jt=s(r(nt),2),Se=r(Jt,!0);a(Jt),a(nt);var vt=s(nt,2),jt=s(r(vt),2),Be=r(jt);a(jt),a(vt);var mt=s(vt,2),qt=s(r(mt),2),Ne=r(qt,!0);a(qt),a(mt);var ct=s(mt,2),zt=s(r(ct),2),Re=r(zt,!0);a(zt),a(ct);var xt=s(ct,2),Ht=s(r(xt),2),Fe=r(Ht);a(Ht),a(xt);var Vt=s(xt,2);{var Ce=l=>{var m=la(),c=s(r(m),2),x=r(c),w=r(x,!0);a(x),a(c),a(m),b(h=>{gt(x,"href",h),n(w,(t(e),i(()=>t(e).template_name)))},[()=>(g($),t(e),i(()=>$(`/templates/${t(e).template_id}`)))]),u(l,m)};f(Vt,l=>{t(e),i(()=>t(e).template_name)&&l(Ce)})}var Wt=s(Vt,2);{var Le=l=>{var m=na(),c=s(r(m),2),x=r(c,!0);a(c),a(m),b(()=>n(x,(t(e),i(()=>t(e)["github-runner-group"])))),u(l,m)};f(Wt,l=>{t(e),i(()=>t(e)["github-runner-group"])&&l(Le)})}var Oe=s(Wt,2);{var Ge=l=>{var m=ma(),c=s(r(m),2),x=r(c);ta(x,5,()=>(t(e),i(()=>t(e).tags)),ea,(w,h)=>{var ut=va(),qe=r(ut,!0);a(ut),b(()=>n(qe,(t(h),i(()=>typeof t(h)=="string"?t(h):t(h).name)))),u(w,ut)}),a(x),a(c),a(m),u(l,m)};f(Oe,l=>{t(e),i(()=>t(e).tags&&t(e).tags.length>0)&&l(Ge)})}a(Ot),a(Lt),a(Ct),a(Q);var Kt=s(Q,2);{var Je=l=>{var m=ca(),c=r(m),x=s(r(c),2),w=r(x,!0);a(x),a(c),a(m),b(h=>n(w,h),[()=>(t(e),i(()=>ve(t(e).extra_specs)))]),u(l,m)};f(Kt,l=>{t(e),i(()=>t(e).extra_specs)&&l(Je)})}var je=s(Kt,2);{let l=E(()=>(t(e),i(()=>t(e).instances||[])));da(je,{get instances(){return t(l)},entityType:"pool",onDeleteInstance:ne})}b((l,m,c,x,w)=>{n(we,(t(e),i(()=>t(e).id))),n(Ie,(t(e),i(()=>t(e).provider_name))),n(Pe,(t(e),i(()=>t(e).image))),n($e,(t(e),i(()=>t(e).flavor))),aa(rt,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enabled?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200")??""}`),n(De,(t(e),i(()=>t(e).enabled?"Enabled":"Disabled"))),n(Me,l),gt(it,"href",m),n(Ee,c),n(Te,x),n(Ae,w),n(Ue,(t(e),i(()=>t(e).max_runners))),n(Se,(t(e),i(()=>t(e).min_idle_runners))),n(Be,`${t(e),i(()=>t(e).runner_bootstrap_timeout)??""} minutes`),n(Ne,(t(e),i(()=>t(e).priority))),n(Re,(t(e),i(()=>t(e).runner_prefix||"garm"))),n(Fe,`${t(e),i(()=>t(e).os_type)??""} / ${t(e),i(()=>t(e).os_arch)??""}`)},[()=>(g(L),t(e),i(()=>L(t(e)))),()=>(g(ee),t(e),i(()=>ee(t(e)))),()=>(g(D),t(e),i(()=>D(t(e)))),()=>(g(O),t(e),i(()=>O(t(e).created_at||""))),()=>(g(O),t(e),i(()=>O(t(e).updated_at||"")))]),u(K,wt)};f(R,K=>{t(e)&&K(W)},!0)}u(I,P)};f(y,I=>{t(A)?I(V):I(ke,!1)},!0)}u(d,o)};f(ge,d=>{t(j)?d(fe):d(pe,!1)})}a(q);var bt=s(q,2);{var _e=d=>{ra(d,{get pool(){return t(e)},$$events:{close:()=>v(U,!1),submit:o=>ie(o.detail)}})};f(bt,d=>{t(U)&&t(e)&&d(_e)})}var kt=s(bt,2);{var ye=d=>{{let o=E(()=>(t(e),g(D),i(()=>`Pool ${t(e).id} (${D(t(e))})`)));Zt(d,{title:"Delete Pool",message:"Are you sure you want to delete this pool? This action cannot be undone and will remove all associated runners.",get itemName(){return t(o)},$$events:{close:()=>v(S,!1),confirm:oe}})}};f(kt,d=>{t(S)&&t(e)&&d(ye)})}var he=s(kt,2);{var be=d=>{Zt(d,{title:"Delete Instance",message:"Are you sure you want to delete this instance? This action cannot be undone.",get itemName(){return t(p),i(()=>t(p).name)},$$events:{close:()=>{v(B,!1),v(p,null)},confirm:le}})};f(he,d=>{t(B)&&t(p)&&d(be)})}b(d=>{gt(xe,"href",d),n(ue,(t(e),i(()=>t(e)?t(e).id:"Loading...")))},[()=>(g($),i(()=>$("/pools")))]),u(re,ft),Ye()}export{Aa as component};
