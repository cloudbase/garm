import{f as _,h as Ze,a as u,s as o,c as ee}from"../chunks/o8CdT7B0.js";import{i as ta}from"../chunks/ChJfoPF0.js";import{p as ea,o as aa,q as ra,l as da,b as sa,f as B,t as h,a as ia,u as i,h as g,g as t,m as k,c as r,s,d as v,$ as la,r as a,j as M,i as E}from"../chunks/DUMcBckj.js";import{i as f}from"../chunks/i7pKks78.js";import{e as oa,i as na}from"../chunks/DC7Aeygn.js";import{d as P,c as _t,g as C,s as ae}from"../chunks/BrpPrY5G.js";import{p as re}from"../chunks/DexHAbFp.js";import{g as de}from"../chunks/D_0Q1Op_.js";import{U as va}from"../chunks/DRVZth4H.js";import{D as se}from"../chunks/BcNnZUp-.js";import{I as ma}from"../chunks/B3zCjiMR.js";import{D as ca}from"../chunks/D3BvOzvb.js";import{w as ie}from"../chunks/DTRhxHIE.js";import{t as T}from"../chunks/Bbk4dQfI.js";import{e as D,i as L,j as le,b as O,g as oe}from"../chunks/CDFYnmbx.js";import{e as G}from"../chunks/BZiHL9L3.js";import{F as xa}from"../chunks/YlnyRm2h.js";var ua=_('<div class="p-6 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading pool...</p></div>'),ga=_('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),fa=_('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Install Template</dt> <dd class="mt-1"><a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></dd></div>'),pa=_('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">GitHub Runner Group</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div>'),_a=_('<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"> </span>'),ya=_('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Tags</dt> <dd class="mt-1"><div class="flex flex-wrap gap-2"></div></dd></div>'),ba=_('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Extra Specifications</h2> <pre class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md overflow-x-auto text-sm text-gray-900 dark:text-white font-mono"> </pre></div></div>'),ha=_('<!> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Basic Information</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Pool ID</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white font-mono"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Provider</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Forge Type</dt> <dd class="mt-1"><!></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Image</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"><code class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs"> </code></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Flavor</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Status</dt> <dd class="mt-1"><span> </span></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Entity</dt> <dd class="mt-1"><div class="flex items-center space-x-2"><span class="inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"> </span> <a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></div></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Configuration</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Max Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Min Idle Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Bootstrap Timeout</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Priority</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Prefix</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">OS Type / Architecture</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Shell Access</dt> <dd class="mt-1"><span> </span></dd></div> <!> <!> <!></dl></div></div></div> <!> <!>',1),ka=_('<div class="space-y-6"><nav class="flex" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg> Pools</a></li> <li><div class="flex items-center"><svg class="w-3 h-3 text-gray-400 mx-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"> </span></div></li></ol></nav> <!></div> <!> <!> <!>',1);function Oa(ne,ve){ea(ve,!1);const J=k();let e=k(null),j=k(!0),A=k(""),F=k(!1),S=k(!1),U=k(!1),p=k(null),N=null;async function me(){if(t(J))try{v(j,!0),v(A,""),v(e,await C.getPool(t(J))),t(e).instances||M(e,t(e).instances=[])}catch(d){v(A,G(d))}finally{v(j,!1)}}async function ce(d){if(t(e))try{const l=await C.updatePool(t(e).id,d);v(e,l),v(F,!1),T.success("Pool Updated",`Pool ${t(e).id} has been updated successfully.`)}catch(l){const y=G(l);T.error("Update Failed",y)}}async function xe(){if(t(e)){try{await C.deletePool(t(e).id),de(P("/pools"))}catch(d){const l=G(d);T.error("Delete Failed",l)}v(S,!1)}}async function ue(){if(t(p)){try{await C.deleteInstance(t(p).name),T.success("Instance Deleted",`Instance ${t(p).name} has been deleted successfully.`)}catch(d){const l=G(d);T.error("Delete Failed",l)}v(U,!1),v(p,null)}}function ge(d){v(p,d),v(U,!0)}function fe(d){if(!d)return"{}";try{if(typeof d=="string"){const l=JSON.parse(d);return JSON.stringify(l,null,2)}return JSON.stringify(d,null,2)}catch{return d.toString()}}function pe(d){if(d.operation==="update"){const l=d.payload;t(e)&&l.id===t(e).id&&v(e,l)}else if(d.operation==="delete"){const l=d.payload.id||d.payload;t(e)&&t(e).id===l&&de(P("/pools"))}}function _e(d){if(!t(e))return;const l=d.payload;if(l.pool_id===t(e).id){if(t(e).instances||M(e,t(e).instances=[]),d.operation==="create")M(e,t(e).instances=[...t(e).instances,l]);else if(d.operation==="update")M(e,t(e).instances=t(e).instances.map(y=>y.id===l.id?l:y));else if(d.operation==="delete"){const y=l.id||l;M(e,t(e).instances=t(e).instances.filter(V=>V.id!==y))}v(e,t(e))}}aa(()=>{me();const d=ie.subscribeToEntity("pool",["update","delete"],pe),l=ie.subscribeToEntity("instance",["create","update","delete"],_e);N=()=>{d(),l()}}),ra(()=>{N&&(N(),N=null)}),da(()=>re,()=>{v(J,re.params.id)}),sa(),ta();var yt=ka();Ze(d=>{h(()=>la.title=`${t(e),i(()=>t(e)?`Pool ${t(e).id} - Pool Details`:"Pool Details")??""} - GARM`)});var q=B(yt),z=r(q),bt=r(z),H=r(bt),ye=r(H);a(H);var ht=s(H,2),kt=r(ht),wt=s(r(kt),2),be=r(wt,!0);a(wt),a(kt),a(ht),a(bt),a(z);var he=s(z,2);{var ke=d=>{var l=ua();u(d,l)},we=d=>{var l=ee(),y=B(l);{var V=$=>{var I=ga(),R=r(I),W=r(R,!0);a(R),a(I),h(()=>o(W,t(A))),u($,I)},Me=$=>{var I=ee(),R=B(I);{var W=K=>{var Pt=ha(),Dt=B(Pt);{let n=E(()=>(g(D),t(e),i(()=>D(t(e))))),m=E(()=>(g(L),t(e),i(()=>L(t(e))))),c=E(()=>(g(oe),t(e),i(()=>oe(t(e).endpoint?.endpoint_type||"unknown"))));ca(Dt,{get title(){return t(e),i(()=>t(e).id)},get subtitle(){return`Pool for ${t(n)??""} (${t(m)??""})`},get forgeIcon(){return t(c)},onEdit:()=>v(F,!0),onDelete:()=>v(S,!0)})}var Q=s(Dt,2),X=r(Q),Mt=r(X),Et=s(r(Mt),2),Y=r(Et),Tt=s(r(Y),2),Ee=r(Tt,!0);a(Tt),a(Y);var Z=s(Y,2),At=s(r(Z),2),Te=r(At,!0);a(At),a(Z);var tt=s(Z,2),Ft=s(r(tt),2),Ae=r(Ft);xa(Ae,{get item(){return t(e)}}),a(Ft),a(tt);var et=s(tt,2),St=s(r(et),2),Ut=r(St),Fe=r(Ut,!0);a(Ut),a(St),a(et);var at=s(et,2),Nt=s(r(at),2),Se=r(Nt,!0);a(Nt),a(at);var rt=s(at,2),Rt=s(r(rt),2),dt=r(Rt),Ue=r(dt,!0);a(dt),a(Rt),a(rt);var st=s(rt,2),Bt=s(r(st),2),Ct=r(Bt),it=r(Ct),Ne=r(it,!0);a(it);var lt=s(it,2),Re=r(lt,!0);a(lt),a(Ct),a(Bt),a(st);var ot=s(st,2),Lt=s(r(ot),2),Be=r(Lt,!0);a(Lt),a(ot);var Ot=s(ot,2),Gt=s(r(Ot),2),Ce=r(Gt,!0);a(Gt),a(Ot),a(Et),a(Mt),a(X);var Jt=s(X,2),jt=r(Jt),qt=s(r(jt),2),nt=r(qt),zt=s(r(nt),2),Le=r(zt,!0);a(zt),a(nt);var vt=s(nt,2),Ht=s(r(vt),2),Oe=r(Ht,!0);a(Ht),a(vt);var mt=s(vt,2),Vt=s(r(mt),2),Ge=r(Vt);a(Vt),a(mt);var ct=s(mt,2),Wt=s(r(ct),2),Je=r(Wt,!0);a(Wt),a(ct);var xt=s(ct,2),Kt=s(r(xt),2),je=r(Kt,!0);a(Kt),a(xt);var ut=s(xt,2),Qt=s(r(ut),2),qe=r(Qt);a(Qt),a(ut);var gt=s(ut,2),Xt=s(r(gt),2),ft=r(Xt),ze=r(ft,!0);a(ft),a(Xt),a(gt);var Yt=s(gt,2);{var He=n=>{var m=fa(),c=s(r(m),2),x=r(c),w=r(x,!0);a(x),a(c),a(m),h(b=>{_t(x,"href",b),o(w,(t(e),i(()=>t(e).template_name)))},[()=>(g(P),t(e),i(()=>P(`/templates/${t(e).template_id}`)))]),u(n,m)};f(Yt,n=>{t(e),i(()=>t(e).template_name)&&n(He)})}var Zt=s(Yt,2);{var Ve=n=>{var m=pa(),c=s(r(m),2),x=r(c,!0);a(c),a(m),h(()=>o(x,(t(e),i(()=>t(e)["github-runner-group"])))),u(n,m)};f(Zt,n=>{t(e),i(()=>t(e)["github-runner-group"])&&n(Ve)})}var We=s(Zt,2);{var Ke=n=>{var m=ya(),c=s(r(m),2),x=r(c);oa(x,5,()=>(t(e),i(()=>t(e).tags)),na,(w,b)=>{var pt=_a(),Ye=r(pt,!0);a(pt),h(()=>o(Ye,(t(b),i(()=>typeof t(b)=="string"?t(b):t(b).name)))),u(w,pt)}),a(x),a(c),a(m),u(n,m)};f(We,n=>{t(e),i(()=>t(e).tags&&t(e).tags.length>0)&&n(Ke)})}a(qt),a(jt),a(Jt),a(Q);var te=s(Q,2);{var Qe=n=>{var m=ba(),c=r(m),x=s(r(c),2),w=r(x,!0);a(x),a(c),a(m),h(b=>o(w,b),[()=>(t(e),i(()=>fe(t(e).extra_specs)))]),u(n,m)};f(te,n=>{t(e),i(()=>t(e).extra_specs)&&n(Qe)})}var Xe=s(te,2);{let n=E(()=>(t(e),i(()=>t(e).instances||[])));ma(Xe,{get instances(){return t(n)},entityType:"pool",onDeleteInstance:ge})}h((n,m,c,x,w)=>{o(Ee,(t(e),i(()=>t(e).id))),o(Te,(t(e),i(()=>t(e).provider_name))),o(Fe,(t(e),i(()=>t(e).image))),o(Se,(t(e),i(()=>t(e).flavor))),ae(dt,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enabled?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200")??""}`),o(Ue,(t(e),i(()=>t(e).enabled?"Enabled":"Disabled"))),o(Ne,n),_t(lt,"href",m),o(Re,c),o(Be,x),o(Ce,w),o(Le,(t(e),i(()=>t(e).max_runners))),o(Oe,(t(e),i(()=>t(e).min_idle_runners))),o(Ge,`${t(e),i(()=>t(e).runner_bootstrap_timeout)??""} minutes`),o(Je,(t(e),i(()=>t(e).priority))),o(je,(t(e),i(()=>t(e).runner_prefix||"garm"))),o(qe,`${t(e),i(()=>t(e).os_type)??""} / ${t(e),i(()=>t(e).os_arch)??""}`),ae(ft,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enable_shell?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200")??""}`),o(ze,(t(e),i(()=>t(e).enable_shell?"Enabled":"Disabled")))},[()=>(g(L),t(e),i(()=>L(t(e)))),()=>(g(le),t(e),i(()=>le(t(e)))),()=>(g(D),t(e),i(()=>D(t(e)))),()=>(g(O),t(e),i(()=>O(t(e).created_at||""))),()=>(g(O),t(e),i(()=>O(t(e).updated_at||"")))]),u(K,Pt)};f(R,K=>{t(e)&&K(W)},!0)}u($,I)};f(y,$=>{t(A)?$(V):$(Me,!1)},!0)}u(d,l)};f(he,d=>{t(j)?d(ke):d(we,!1)})}a(q);var $t=s(q,2);{var $e=d=>{va(d,{get pool(){return t(e)},$$events:{close:()=>v(F,!1),submit:l=>ce(l.detail)}})};f($t,d=>{t(F)&&t(e)&&d($e)})}var It=s($t,2);{var Ie=d=>{{let l=E(()=>(t(e),g(D),i(()=>`Pool ${t(e).id} (${D(t(e))})`)));se(d,{title:"Delete Pool",message:"Are you sure you want to delete this pool? This action cannot be undone and will remove all associated runners.",get itemName(){return t(l)},$$events:{close:()=>v(S,!1),confirm:xe}})}};f(It,d=>{t(S)&&t(e)&&d(Ie)})}var Pe=s(It,2);{var De=d=>{se(d,{title:"Delete Instance",message:"Are you sure you want to delete this instance? This action cannot be undone.",get itemName(){return t(p),i(()=>t(p).name)},$$events:{close:()=>{v(U,!1),v(p,null)},confirm:ue}})};f(Pe,d=>{t(U)&&t(p)&&d(De)})}h(d=>{_t(ye,"href",d),o(be,(t(e),i(()=>t(e)?t(e).id:"Loading...")))},[()=>(g(P),i(()=>P("/pools")))]),u(ne,yt),ia()}export{Oa as component};
