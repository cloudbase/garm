import"../chunks/DsnmJJEf.js";import{i as ze}from"../chunks/B3Pzt0F_.js";import{p as He,o as Ve,A as We,l as Ke,a as Qe,f as h,h as Xe,b as S,t as b,c as u,d as Ye,s as n,m as y,u as i,$ as Ze,g as t,j as r,r as a,k as s,v as l,y as mt,B as Wt,q as B,n as f}from"../chunks/D8EpLgQ1.js";import{i as g,s as ta,a as ea}from"../chunks/5WA7h8uK.js";import{w as Kt,e as aa,i as ra}from"../chunks/u94nIB4-.js";import{c as Qt,g as N,s as da}from"../chunks/CiE1LlKV.js";import{p as sa}from"../chunks/C41YH50Q.js";import{g as Xt}from"../chunks/CTf6mQoE.js";import{b as xt}from"../chunks/CoIRRsD9.js";import{U as ia}from"../chunks/DQP15tlf.js";import{D as Yt}from"../chunks/KQ2xQpA3.js";import{D as oa,I as na}from"../chunks/DDhBTdDt.js";import{t as E}from"../chunks/BEkVdVE1.js";import{e as P,i as R,j as Zt,b as C,g as te}from"../chunks/BGVHQGl-.js";var la=h('<div class="p-6 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading pool...</p></div>'),va=h('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),ca=h('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">GitHub Runner Group</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div>'),ma=h('<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"> </span>'),xa=h('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Tags</dt> <dd class="mt-1"><div class="flex flex-wrap gap-2"></div></dd></div>'),ua=h('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Extra Specifications</h2> <pre class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md overflow-x-auto text-sm text-gray-900 dark:text-white font-mono"> </pre></div></div>'),ga=h('<!> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Basic Information</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Pool ID</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white font-mono"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Provider</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Image</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"><code class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs"> </code></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Flavor</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Status</dt> <dd class="mt-1"><span> </span></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Entity</dt> <dd class="mt-1"><div class="flex items-center space-x-2"><span class="inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"> </span> <a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></div></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Configuration</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Max Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Min Idle Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Bootstrap Timeout</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Priority</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Prefix</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">OS Type / Architecture</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <!> <!></dl></div></div></div> <!> <!>',1),pa=h('<div class="space-y-6"><nav class="flex" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg> Pools</a></li> <li><div class="flex items-center"><svg class="w-3 h-3 text-gray-400 mx-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"> </span></div></li></ol></nav> <!></div> <!> <!> <!>',1);function Ta(ee,ae){He(ae,!1);const[re,de]=ta(),ut=()=>ea(sa,"$page",re),L=y();let e=y(null),O=y(!0),M=y(""),F=y(!1),T=y(!1),D=y(!1),x=y(null),A=null;async function se(){if(t(L))try{n(O,!0),n(M,""),n(e,await N.getPool(t(L)))}catch(d){n(M,d instanceof Error?d.message:"Failed to load pool")}finally{n(O,!1)}}async function ie(d){if(t(e))try{const o=await N.updatePool(t(e).id,d);n(e,o),n(F,!1),E.success("Pool Updated",`Pool ${t(e).id} has been updated successfully.`)}catch(o){const _=o instanceof Error?o.message:"Failed to update pool";E.error("Update Failed",_)}}async function oe(){if(t(e)){try{await N.deletePool(t(e).id),Xt(`${xt}/pools`)}catch(d){const o=d instanceof Error?d.message:"Failed to delete pool";E.error("Delete Failed",o)}n(T,!1)}}async function ne(){if(t(x)){try{await N.deleteInstance(t(x).name),E.success("Instance Deleted",`Instance ${t(x).name} has been deleted successfully.`),n(D,!1),n(x,null)}catch(d){const o=d instanceof Error?d.message:"Failed to delete instance";E.error("Delete Failed",o)}n(D,!1),n(x,null)}}function le(d){n(x,d),n(D,!0)}function ve(d){if(!d)return"{}";try{if(typeof d=="string"){const o=JSON.parse(d);return JSON.stringify(o,null,2)}return JSON.stringify(d,null,2)}catch{return d.toString()}}function ce(d){if(d.operation==="update"){const o=d.payload;t(e)&&o.id===t(e).id&&n(e,o)}else if(d.operation==="delete"){const o=d.payload.id||d.payload;t(e)&&t(e).id===o&&Xt(`${xt}/pools`)}}function me(d){if(!t(e)||!t(e).instances)return;const o=d.payload;if(o.pool_id===t(e).id){if(d.operation==="create")mt(e,t(e).instances=[...t(e).instances,o]);else if(d.operation==="update")mt(e,t(e).instances=t(e).instances.map(_=>_.id===o.id?o:_));else if(d.operation==="delete"){const _=o.id||o;mt(e,t(e).instances=t(e).instances.filter(q=>q.id!==_))}n(e,t(e))}}Ve(()=>{se();const d=Kt.subscribeToEntity("pool",["update","delete"],ce),o=Kt.subscribeToEntity("instance",["create","update","delete"],me);A=()=>{d(),o()}}),We(()=>{A&&(A(),A=null)}),Ke(()=>ut(),()=>{n(L,ut().params.id)}),Qe(),ze();var gt=pa();Xe(d=>{b(()=>Ze.title=`${t(e),i(()=>t(e)?`Pool ${t(e).id} - Pool Details`:"Pool Details")??""} - GARM`)});var G=S(gt),J=r(G),pt=r(J),j=r(pt),xe=r(j);a(j);var ft=s(j,2),_t=r(ft),yt=s(r(_t),2),ue=r(yt,!0);a(yt),a(_t),a(ft),a(pt),a(J);var ge=s(J,2);{var pe=d=>{var o=la();u(d,o)},fe=d=>{var o=Wt(),_=S(o);{var q=k=>{var w=va(),U=r(w),z=r(U,!0);a(U),a(w),b(()=>l(z,t(M))),u(k,w)},ke=k=>{var w=Wt(),U=S(w);{var z=H=>{var kt=ga(),wt=S(kt);{let v=B(()=>(f(P),t(e),i(()=>P(t(e))))),c=B(()=>(f(R),t(e),i(()=>R(t(e))))),m=B(()=>(f(te),t(e),i(()=>te(t(e).endpoint?.endpoint_type||"unknown"))));oa(wt,{get title(){return t(e),i(()=>t(e).id)},get subtitle(){return`Pool for ${t(v)??""} (${t(c)??""})`},get forgeIcon(){return t(m)},onEdit:()=>n(F,!0),onDelete:()=>n(T,!0)})}var V=s(wt,2),W=r(V),$t=r(W),Pt=s(r($t),2),K=r(Pt),Dt=s(r(K),2),we=r(Dt,!0);a(Dt),a(K);var Q=s(K,2),It=s(r(Q),2),$e=r(It,!0);a(It),a(Q);var X=s(Q,2),Et=s(r(X),2),Mt=r(Et),Pe=r(Mt,!0);a(Mt),a(Et),a(X);var Y=s(X,2),Ft=s(r(Y),2),De=r(Ft,!0);a(Ft),a(Y);var Z=s(Y,2),Tt=s(r(Z),2),tt=r(Tt),Ie=r(tt,!0);a(tt),a(Tt),a(Z);var et=s(Z,2),At=s(r(et),2),Ut=r(At),at=r(Ut),Ee=r(at,!0);a(at);var rt=s(at,2),Me=r(rt,!0);a(rt),a(Ut),a(At),a(et);var dt=s(et,2),St=s(r(dt),2),Fe=r(St,!0);a(St),a(dt);var Bt=s(dt,2),Nt=s(r(Bt),2),Te=r(Nt,!0);a(Nt),a(Bt),a(Pt),a($t),a(W);var Rt=s(W,2),Ct=r(Rt),Lt=s(r(Ct),2),st=r(Lt),Ot=s(r(st),2),Ae=r(Ot,!0);a(Ot),a(st);var it=s(st,2),Gt=s(r(it),2),Ue=r(Gt,!0);a(Gt),a(it);var ot=s(it,2),Jt=s(r(ot),2),Se=r(Jt);a(Jt),a(ot);var nt=s(ot,2),jt=s(r(nt),2),Be=r(jt,!0);a(jt),a(nt);var lt=s(nt,2),qt=s(r(lt),2),Ne=r(qt,!0);a(qt),a(lt);var vt=s(lt,2),zt=s(r(vt),2),Re=r(zt);a(zt),a(vt);var Ht=s(vt,2);{var Ce=v=>{var c=ca(),m=s(r(c),2),p=r(m,!0);a(m),a(c),b(()=>l(p,(t(e),i(()=>t(e)["github-runner-group"])))),u(v,c)};g(Ht,v=>{t(e),i(()=>t(e)["github-runner-group"])&&v(Ce)})}var Le=s(Ht,2);{var Oe=v=>{var c=xa(),m=s(r(c),2),p=r(m);aa(p,5,()=>(t(e),i(()=>t(e).tags)),ra,(I,$)=>{var ct=ma(),qe=r(ct,!0);a(ct),b(()=>l(qe,(t($),i(()=>typeof t($)=="string"?t($):t($).name)))),u(I,ct)}),a(p),a(m),a(c),u(v,c)};g(Le,v=>{t(e),i(()=>t(e).tags&&t(e).tags.length>0)&&v(Oe)})}a(Lt),a(Ct),a(Rt),a(V);var Vt=s(V,2);{var Ge=v=>{var c=ua(),m=r(c),p=s(r(m),2),I=r(p,!0);a(p),a(m),a(c),b($=>l(I,$),[()=>(t(e),i(()=>ve(t(e).extra_specs)))]),u(v,c)};g(Vt,v=>{t(e),i(()=>t(e).extra_specs)&&v(Ge)})}var Je=s(Vt,2);{var je=v=>{na(v,{get instances(){return t(e),i(()=>t(e).instances)},entityType:"repository",onDeleteInstance:le})};g(Je,v=>{t(e),i(()=>t(e).instances)&&v(je)})}b((v,c,m,p,I)=>{l(we,(t(e),i(()=>t(e).id))),l($e,(t(e),i(()=>t(e).provider_name))),l(Pe,(t(e),i(()=>t(e).image))),l(De,(t(e),i(()=>t(e).flavor))),da(tt,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enabled?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200")??""}`),l(Ie,(t(e),i(()=>t(e).enabled?"Enabled":"Disabled"))),l(Ee,v),Qt(rt,"href",c),l(Me,m),l(Fe,p),l(Te,I),l(Ae,(t(e),i(()=>t(e).max_runners))),l(Ue,(t(e),i(()=>t(e).min_idle_runners))),l(Se,`${t(e),i(()=>t(e).runner_bootstrap_timeout)??""} minutes`),l(Be,(t(e),i(()=>t(e).priority))),l(Ne,(t(e),i(()=>t(e).runner_prefix||"garm"))),l(Re,`${t(e),i(()=>t(e).os_type)??""} / ${t(e),i(()=>t(e).os_arch)??""}`)},[()=>(f(R),t(e),i(()=>R(t(e)))),()=>(f(Zt),t(e),i(()=>Zt(t(e)))),()=>(f(P),t(e),i(()=>P(t(e)))),()=>(f(C),t(e),i(()=>C(t(e).created_at||""))),()=>(f(C),t(e),i(()=>C(t(e).updated_at||"")))]),u(H,kt)};g(U,H=>{t(e)&&H(z)},!0)}u(k,w)};g(_,k=>{t(M)?k(q):k(ke,!1)},!0)}u(d,o)};g(ge,d=>{t(O)?d(pe):d(fe,!1)})}a(G);var ht=s(G,2);{var _e=d=>{ia(d,{get pool(){return t(e)},$$events:{close:()=>n(F,!1),submit:o=>ie(o.detail)}})};g(ht,d=>{t(F)&&t(e)&&d(_e)})}var bt=s(ht,2);{var ye=d=>{{let o=B(()=>(t(e),f(P),i(()=>`Pool ${t(e).id} (${P(t(e))})`)));Yt(d,{title:"Delete Pool",message:"Are you sure you want to delete this pool? This action cannot be undone and will remove all associated runners.",get itemName(){return t(o)},$$events:{close:()=>n(T,!1),confirm:oe}})}};g(bt,d=>{t(T)&&t(e)&&d(ye)})}var he=s(bt,2);{var be=d=>{Yt(d,{title:"Delete Instance",message:"Are you sure you want to delete this instance? This action cannot be undone.",get itemName(){return t(x),i(()=>t(x).name)},$$events:{close:()=>{n(D,!1),n(x,null)},confirm:ne}})};g(he,d=>{t(D)&&t(x)&&d(be)})}b(()=>{Qt(xe,"href",`${xt}/pools`),l(ue,(t(e),i(()=>t(e)?t(e).id:"Loading...")))}),u(ee,gt),Ye(),de()}export{Ta as component};
