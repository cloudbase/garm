import"../chunks/DsnmJJEf.js";import{i as He}from"../chunks/DT0EGONV.js";import{p as Je,o as Pe,A as je,l as qe,a as ze,f as $,h as Ve,b as B,t as k,c as f,d as We,u as i,n as m,v as o,g as t,m as p,j as a,k as d,s as l,$ as Ke,r,w as I,B as zt,q as S}from"../chunks/CRKWEg6v.js";import{i as _,s as Qe,a as Xe}from"../chunks/e1m7WRO5.js";import{d as R,c as Vt,g as F,s as Ye}from"../chunks/-esynYXT.js";import{p as Ze}from"../chunks/B0m3rqSR.js";import{g as Wt}from"../chunks/Dkb9lSSG.js";import{U as ta}from"../chunks/DJ6ZD3Tj.js";import{D as Kt}from"../chunks/BXdh0O4_.js";import{D as ea,I as aa}from"../chunks/CrNwrvNH.js";import{w as Qt}from"../chunks/C73ZVvpW.js";import{t as C}from"../chunks/D6DjlyIQ.js";import{e as Xt}from"../chunks/BZiHL9L3.js";import{e as w,i as G,j as Yt,b as L,g as Zt}from"../chunks/c_t0vA9G.js";var ra=$('<div class="p-6 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading scale set...</p></div>'),sa=$('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),da=$('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">GitHub Runner Group</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div>'),ia=$('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Extra Specifications</h2> <pre class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md overflow-x-auto text-sm text-gray-900 dark:text-white font-mono"> </pre></div></div>'),na=$('<!> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Basic Information</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Scale Set ID</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Name</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white font-medium"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Provider</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Image</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"><code class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs"> </code></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Flavor</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Status</dt> <dd class="mt-1"><span> </span></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Entity</dt> <dd class="mt-1"><div class="flex items-center space-x-2"><span class="inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"> </span> <a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></div></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Configuration</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Max Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Min Idle Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Bootstrap Timeout</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Prefix</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">OS Type / Architecture</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <!></dl></div></div></div> <!> <!>',1),la=$('<div class="space-y-6"><nav class="flex" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg> Scale Sets</a></li> <li><div class="flex items-center"><svg class="w-3 h-3 text-gray-400 mx-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"> </span></div></li></ol></nav> <!></div> <!> <!> <!>',1);function Sa(te,ee){Je(ee,!1);const[ae,re]=Qe(),mt=()=>Xe(Ze,"$page",ae),D=p();let e=p(null),O=p(!0),E=p(""),M=p(!1),A=p(!1),N=p(!1),u=p(null),T=null;async function ut(){if(!(!t(D)||isNaN(t(D))))try{l(O,!0),l(E,""),l(e,await F.getScaleSet(t(D))),t(e).instances||I(e,t(e).instances=[])}catch(s){l(E,s instanceof Error?s.message:"Failed to load scale set")}finally{l(O,!1)}}async function se(s){if(t(e))try{await F.updateScaleSet(t(e).id,s),await ut(),C.success("Scale Set Updated",`Scale Set ${t(e).name} has been updated successfully.`),l(M,!1)}catch(n){throw n}}async function de(){if(t(e)){try{await F.deleteScaleSet(t(e).id),Wt(R("/scalesets"))}catch(s){const n=Xt(s);C.error("Delete Failed",n)}l(A,!1)}}async function ie(){if(t(u)){try{await F.deleteInstance(t(u).name),C.success("Instance Deleted",`Instance ${t(u).name} has been deleted successfully.`)}catch(s){const n=Xt(s);C.error("Delete Failed",n)}l(N,!1),l(u,null)}}function ne(s){l(u,s),l(N,!0)}function le(s){if(!s)return"{}";try{if(typeof s=="string"){const n=JSON.parse(s);return JSON.stringify(n,null,2)}return JSON.stringify(s,null,2)}catch{return s.toString()}}function oe(s){if(s.operation==="update"){const n=s.payload;t(e)&&n.id===t(e).id&&l(e,n)}else if(s.operation==="delete"){const n=s.payload.id||s.payload;t(e)&&t(e).id===n&&Wt(R("/scalesets"))}}function ce(s){if(!t(e))return;const n=s.payload;if(n.scale_set_id===t(e).id){if(t(e).instances||I(e,t(e).instances=[]),s.operation==="create")I(e,t(e).instances=[...t(e).instances,n]);else if(s.operation==="update")I(e,t(e).instances=t(e).instances.map(y=>y.id===n.id?n:y));else if(s.operation==="delete"){const y=n.id||n;I(e,t(e).instances=t(e).instances.filter(j=>j.id!==y))}l(e,t(e))}}Pe(()=>{ut();const s=Qt.subscribeToEntity("scaleset",["update","delete"],oe),n=Qt.subscribeToEntity("instance",["create","update","delete"],ce);T=()=>{s(),n()}}),je(()=>{T&&(T(),T=null)}),qe(()=>mt(),()=>{l(D,parseInt(mt().params.id||"0"))}),ze(),He();var xt=la();Ve(s=>{k(()=>Ke.title=`${t(e),i(()=>t(e)?`${t(e).name} - Scale Set Details`:"Scale Set Details")??""} - GARM`)});var H=B(xt),J=a(H),gt=a(J),P=a(gt),ve=a(P);r(P);var ft=d(P,2),pt=a(ft),_t=d(a(pt),2),me=a(_t,!0);r(_t),r(pt),r(ft),r(gt),r(J);var ue=d(J,2);{var xe=s=>{var n=ra();f(s,n)},ge=s=>{var n=zt(),y=B(n);{var j=h=>{var b=sa(),U=a(b),q=a(U,!0);r(U),r(b),k(()=>o(q,t(E))),f(h,b)},he=h=>{var b=zt(),U=B(b);{var q=z=>{var bt=na(),kt=B(bt);{let c=S(()=>(t(e),i(()=>t(e).name||"Scale Set"))),v=S(()=>(m(w),t(e),i(()=>w(t(e))))),x=S(()=>(m(G),t(e),i(()=>G(t(e))))),g=S(()=>(m(Zt),i(()=>Zt("github"))));ea(kt,{get title(){return t(c)},get subtitle(){return`Scale set for ${t(v)??""} (${t(x)??""}) â€¢ GitHub Runner Scale Set`},get forgeIcon(){return t(g)},onEdit:()=>l(M,!0),onDelete:()=>l(A,!0)})}var V=d(kt,2),W=a(V),St=a(W),wt=d(a(St),2),K=a(wt),$t=d(a(K),2),be=a($t,!0);r($t),r(K);var Q=d(K,2),It=d(a(Q),2),ke=a(It,!0);r(It),r(Q);var X=d(Q,2),Dt=d(a(X),2),Se=a(Dt,!0);r(Dt),r(X);var Y=d(X,2),Et=d(a(Y),2),Mt=a(Et),we=a(Mt,!0);r(Mt),r(Et),r(Y);var Z=d(Y,2),At=d(a(Z),2),$e=a(At,!0);r(At),r(Z);var tt=d(Z,2),Nt=d(a(tt),2),et=a(Nt),Ie=a(et,!0);r(et),r(Nt),r(tt);var at=d(tt,2),Tt=d(a(at),2),Ut=a(Tt),rt=a(Ut),De=a(rt,!0);r(rt);var st=d(rt,2),Ee=a(st,!0);r(st),r(Ut),r(Tt),r(at);var dt=d(at,2),Bt=d(a(dt),2),Me=a(Bt,!0);r(Bt),r(dt);var Rt=d(dt,2),Ft=d(a(Rt),2),Ae=a(Ft,!0);r(Ft),r(Rt),r(wt),r(St),r(W);var Ct=d(W,2),Gt=a(Ct),Lt=d(a(Gt),2),it=a(Lt),Ot=d(a(it),2),Ne=a(Ot,!0);r(Ot),r(it);var nt=d(it,2),Ht=d(a(nt),2),Te=a(Ht,!0);r(Ht),r(nt);var lt=d(nt,2),Jt=d(a(lt),2),Ue=a(Jt);r(Jt),r(lt);var ot=d(lt,2),Pt=d(a(ot),2),Be=a(Pt,!0);r(Pt),r(ot);var ct=d(ot,2),jt=d(a(ct),2),Re=a(jt);r(jt),r(ct);var Fe=d(ct,2);{var Ce=c=>{var v=da(),x=d(a(v),2),g=a(x,!0);r(x),r(v),k(()=>o(g,(t(e),i(()=>t(e)["github-runner-group"])))),f(c,v)};_(Fe,c=>{t(e),i(()=>t(e)["github-runner-group"])&&c(Ce)})}r(Lt),r(Gt),r(Ct),r(V);var qt=d(V,2);{var Ge=c=>{var v=ia(),x=a(v),g=d(a(x),2),vt=a(g,!0);r(g),r(x),r(v),k(Oe=>o(vt,Oe),[()=>(t(e),i(()=>le(t(e).extra_specs)))]),f(c,v)};_(qt,c=>{t(e),i(()=>t(e).extra_specs)&&c(Ge)})}var Le=d(qt,2);{let c=S(()=>(t(e),i(()=>t(e).instances||[])));aa(Le,{get instances(){return t(c)},entityType:"scaleset",onDeleteInstance:ne})}k((c,v,x,g,vt)=>{o(be,(t(e),i(()=>t(e).id))),o(ke,(t(e),i(()=>t(e).name))),o(Se,(t(e),i(()=>t(e).provider_name))),o(we,(t(e),i(()=>t(e).image))),o($e,(t(e),i(()=>t(e).flavor))),Ye(et,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enabled?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200")??""}`),o(Ie,(t(e),i(()=>t(e).enabled?"Enabled":"Disabled"))),o(De,c),Vt(st,"href",v),o(Ee,x),o(Me,g),o(Ae,vt),o(Ne,(t(e),i(()=>t(e).max_runners))),o(Te,(t(e),i(()=>t(e).min_idle_runners))),o(Ue,`${t(e),i(()=>t(e).runner_bootstrap_timeout)??""} minutes`),o(Be,(t(e),i(()=>t(e).runner_prefix||"garm"))),o(Re,`${t(e),i(()=>t(e).os_type)??""} / ${t(e),i(()=>t(e).os_arch)??""}`)},[()=>(m(G),t(e),i(()=>G(t(e)))),()=>(m(Yt),t(e),i(()=>Yt(t(e)))),()=>(m(w),t(e),i(()=>w(t(e)))),()=>(m(L),t(e),i(()=>L(t(e).created_at||""))),()=>(m(L),t(e),i(()=>L(t(e).updated_at||"")))]),f(z,bt)};_(U,z=>{t(e)&&z(q)},!0)}f(h,b)};_(y,h=>{t(E)?h(j):h(he,!1)},!0)}f(s,n)};_(ue,s=>{t(O)?s(xe):s(ge,!1)})}r(H);var yt=d(H,2);{var fe=s=>{ta(s,{get scaleSet(){return t(e)},$$events:{close:()=>l(M,!1),submit:n=>se(n.detail)}})};_(yt,s=>{t(M)&&t(e)&&s(fe)})}var ht=d(yt,2);{var pe=s=>{{let n=S(()=>(t(e),m(w),i(()=>`Scale Set ${t(e).name} (${w(t(e))})`)));Kt(s,{title:"Delete Scale Set",message:"Are you sure you want to delete this scale set? This action cannot be undone and will remove all associated runners.",get itemName(){return t(n)},$$events:{close:()=>l(A,!1),confirm:de}})}};_(ht,s=>{t(A)&&t(e)&&s(pe)})}var _e=d(ht,2);{var ye=s=>{Kt(s,{title:"Delete Instance",message:"Are you sure you want to delete this instance? This action cannot be undone.",get itemName(){return t(u),i(()=>t(u).name)},$$events:{close:()=>{l(N,!1),l(u,null)},confirm:ie}})};_(_e,s=>{t(N)&&t(u)&&s(ye)})}k(s=>{Vt(ve,"href",s),o(me,(t(e),i(()=>t(e)?t(e).name:"Loading...")))},[()=>(m(R),i(()=>R("/scalesets")))]),f(te,xt),We(),re()}export{Sa as component};
