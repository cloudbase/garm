import"../chunks/DsnmJJEf.js";import{i as Gr}from"../chunks/TJn6xDN9.js";import{p as Hr,E as ot,o as Nr,l as F,k as r,g as e,m as d,h as Ur,f as k,s as a,d as l,r as o,t as _,i as ke,b,e as q,a as Pe,z as ir,y as we,u as p,D as Se,c as jr,A as Ir,q as qr,j as lt,$ as st,v as nr}from"../chunks/DniTuB_0.js";import{i as M,s as dt,a as it}from"../chunks/DbNhg6mG.js";import{r as V,s as cr,b as $e,g as G,d as zr,c as nt}from"../chunks/DD3srElq.js";import{P as ct}from"../chunks/BlYHwhWl.js";import{e as ur,i as gr}from"../chunks/Ck5PkeSc.js";import{b as Q,a as ut}from"../chunks/CCQwxxp9.js";import{p as gt}from"../chunks/D4Caz1gY.js";import{M as Fr}from"../chunks/PC4wJWhj.js";import{J as vt}from"../chunks/DcEwzE5l.js";import{e as B}from"../chunks/BZiHL9L3.js";import{U as bt}from"../chunks/NLwquURr.js";import{D as pt}from"../chunks/B6XSaEl0.js";import{D as mt,G as vr,A as ft,L as yt}from"../chunks/QtGwBUod.js";import{e as xt,a as Lr}from"../chunks/C-ow2qSP.js";import{t as ne}from"../chunks/CBJzOE8U.js";import{e as Ce,h as ht}from"../chunks/LMA6-4d1.js";import{E as _t}from"../chunks/D3pbRQAB.js";import{E as kt}from"../chunks/hsRG7ppz.js";import{S as wt}from"../chunks/Dn_Ue57e.js";import{P as St}from"../chunks/DW-EakRM.js";import"../chunks/BSR16q_V.js";var $t=k('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),Ct=k('<div class="animate-pulse bg-gray-200 dark:bg-gray-700 h-10 rounded"></div>'),Pt=k("<option><!></option>"),Mt=k('<select id="entity" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option> </option><!></select>'),Tt=k('<div class="animate-pulse bg-gray-200 dark:bg-gray-700 h-10 rounded"></div>'),Et=k("<option> </option>"),Rt=k('<select id="provider" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>Select a provider</option><!></select>'),Dt=k('<div class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 flex items-center"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"></div> <span class="text-sm text-gray-600 dark:text-gray-400">Loading templates...</span></div>'),At=k("<option> <!></option>"),It=k('<select id="template" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"></select> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Templates define how the runner software is installed and configured. <!></p>',1),zt=k('<div class="w-full px-3 py-2 border border-yellow-300 dark:border-yellow-600 rounded-md bg-yellow-50 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-200"><p class="text-sm"> </p> <p class="text-xs mt-1"><a class="text-yellow-700 dark:text-yellow-300 hover:underline">Create a template first</a> or proceed without a template to use default behavior.</p></div>'),Lt=k('<div class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-500 dark:text-gray-400"><p class="text-sm">Select an entity first to see available templates</p></div>'),Gt=k('<div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Entity & Provider Configuration</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="entity" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"> <span class="text-red-500">*</span></label> <!></div> <div><label for="provider" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Provider <span class="text-red-500">*</span></label> <!></div></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Image & OS Configuration</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="image" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Image <span class="text-red-500">*</span></label> <input id="image" type="text" required placeholder="e.g., ubuntu:22.04" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="flavor" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Flavor <span class="text-red-500">*</span></label> <input id="flavor" type="text" required placeholder="e.g., default" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="osType" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">OS Type</label> <select id="osType" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>Linux</option><option>Windows</option></select></div> <div><label for="osArch" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Architecture</label> <select id="osArch" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>AMD64</option><option>ARM64</option></select></div></div> <div><label for="template" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Runner Install Template</label> <!></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Runner Limits & Timing</h3> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label for="minIdleRunners" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Min Idle Runners</label> <input id="minIdleRunners" type="number" min="0" placeholder="0" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="maxRunners" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Max Runners</label> <input id="maxRunners" type="number" min="1" placeholder="10" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="bootstrapTimeout" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Bootstrap Timeout (min)</label> <input id="bootstrapTimeout" type="number" min="1" placeholder="20" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Advanced Settings</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="runnerPrefix" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Runner Prefix</label> <input id="runnerPrefix" type="text" placeholder="garm" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="githubRunnerGroup" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">GitHub Runner Group (optional)</label> <input id="githubRunnerGroup" type="text" placeholder="Default group" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div></div> <div><div class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Extra Specs (JSON)</div> <!></div> <div class="flex items-center"><input id="enabled" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="enabled" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">Enable scale set immediately</label></div></div>',1),Ht=k('<div class="flex items-center"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div> Creating...</div>'),Nt=k('<div class="max-w-6xl w-full max-h-[90vh] overflow-y-auto"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700"><h2 class="text-xl font-semibold text-gray-900 dark:text-white">Create New Scale Set</h2> <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Scale sets are only available for GitHub endpoints</p></div> <form class="p-6 space-y-6"><!> <div><label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Name <span class="text-red-500">*</span></label> <input id="name" type="text" required placeholder="e.g., my-scale-set" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><fieldset><legend class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Entity Level <span class="text-red-500">*</span></legend> <div class="grid grid-cols-3 gap-4"><button type="button"><svg class="w-8 h-8 mb-2 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"></path></svg> <span class="text-sm font-medium text-gray-900 dark:text-white">Repository</span></button> <button type="button"><svg class="w-8 h-8 mb-2 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <span class="text-sm font-medium text-gray-900 dark:text-white">Organization</span></button> <button type="button"><svg class="w-8 h-8 mb-2 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg> <span class="text-sm font-medium text-gray-900 dark:text-white">Enterprise</span></button></div></fieldset></div> <!> <div class="flex justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer">Cancel</button> <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer"><!></button></div></form></div>');function Ut(ze,Le){Hr(Le,!1);const ce=d(),ue=ot();let E=d(!1),A=d(""),u=d(""),C=d([]),re=d([]),x=d([]),J=d(!1),W=d(!1),K=d(!1),w=d(""),g=d(""),I=d(""),H=d(""),N=d(""),m=d(void 0),X=d(void 0),ge=d(void 0),ve=d("garm"),R=d("linux"),te=d("amd64"),ae=d(""),oe=d(!0),Y=d("{}"),z=d(void 0);async function Ge(){try{r(W,!0),r(re,await G.listProviders())}catch(i){r(A,B(i))}finally{r(W,!1)}}async function Me(){try{r(K,!0);const i=be();if(!i){r(x,[]);return}if(r(x,await G.listTemplates(e(R),void 0,i)),!e(z)||!e(x).find(f=>f.id===e(z))){const f=e(x).find(D=>D.owner_id==="system");f?r(z,f.id):e(x).length>0&&r(z,e(x)[0].id)}}catch(i){r(A,B(i))}finally{r(K,!1)}}function be(){if(!e(g)||!e(C))return null;const i=e(C).find(f=>f.id===e(g));if(!i)return null;if("forge_type"in i)return i.forge_type;if("endpoint"in i){const f=i.endpoint;if(f&&"endpoint_type"in f)return f.endpoint_type||null}return"github"}async function He(){if(e(u))try{switch(r(J,!0),r(C,[]),e(u)){case"repository":r(C,await G.listRepositories());break;case"organization":r(C,await G.listOrganizations());break;case"enterprise":r(C,await G.listEnterprises());break}}catch(i){r(A,B(i))}finally{r(J,!1)}}function pe(i){e(u)!==i&&(r(u,i),r(g,""),r(z,void 0),He())}async function Ne(){if(!e(ce)){r(A,"Please fill in all required fields");return}try{r(E,!0),r(A,"");let i={};if(e(Y).trim())try{i=JSON.parse(e(Y))}catch{throw new Error("Invalid JSON in extra specs")}const f={name:e(w),provider_name:e(I),image:e(H),flavor:e(N),max_runners:e(m)||10,min_idle_runners:e(X)||0,runner_bootstrap_timeout:e(ge)||20,runner_prefix:e(ve),os_type:e(R),os_arch:e(te),"github-runner-group":e(ae)||void 0,enabled:e(oe),extra_specs:e(Y).trim()?i:void 0,template_id:e(z)};let D;switch(e(u)){case"repository":D=await G.createRepositoryScaleSet(e(g),f);break;case"organization":D=await G.createOrganizationScaleSet(e(g),f);break;case"enterprise":D=await G.createEnterpriseScaleSet(e(g),f);break;default:throw new Error("Invalid entity level selected")}ue("submit",D)}catch(i){r(A,B(i))}finally{r(E,!1)}}Nr(()=>{Ge()}),F(()=>(e(E),e(w),e(u),e(g),e(I),e(H),e(N)),()=>{r(ce,!e(E)&&e(w).trim()!==""&&e(u)!==""&&e(g)!==""&&e(I)!==""&&e(H).trim()!==""&&e(N).trim()!=="")}),F(()=>(e(g),e(R)),()=>{e(g)&&e(R)&&Me()}),F(()=>(e(R),e(g)),()=>{e(R)&&e(g)&&Me()}),Ur(),Gr(),Fr(ze,{$$events:{close:()=>ue("close")},children:(i,f)=>{var D=Nt(),le=a(l(D),2),me=l(le);{var Ue=S=>{var U=$t(),ie=l(U),Ae=l(ie,!0);o(ie),o(U),_(()=>q(Ae,e(A))),b(S,U)};M(me,S=>{e(A)&&S(Ue)})}var se=a(me,2),Te=a(l(se),2);V(Te),o(se);var de=a(se,2),Ee=l(de),Re=a(l(Ee),2),fe=l(Re),t=a(fe,2),v=a(t,2);o(Re),o(Ee),o(de);var Z=a(de,2);{var ye=S=>{var U=Gt(),ie=Pe(U),Ae=a(l(ie),2),qe=l(Ae),Fe=l(qe),Jr=l(Fe);ir(),o(Fe);var Wr=a(Fe,2);{var Kr=s=>{var y=Ct();b(s,y)},Qr=s=>{var y=Mt();_(()=>{e(g),we(()=>{e(u),e(C)})});var L=l(y),xe=l(L);o(L),L.value=L.__value="";var ee=a(L);ur(ee,1,()=>e(C),gr,(h,n)=>{var T=Pt(),O=l(T);{var he=c=>{var P=Se();_(()=>q(P,`${e(n),p(()=>e(n).owner)??""}/${e(n),p(()=>e(n).name)??""} (${e(n),p(()=>e(n).endpoint?.name||"Unknown endpoint")??""})`)),b(c,P)},j=c=>{var P=Se();_(()=>q(P,`${e(n),p(()=>e(n).name)??""} (${e(n),p(()=>e(n).endpoint?.name||"Unknown endpoint")??""})`)),b(c,P)};M(O,c=>{e(u)==="repository"?c(he):c(j,!1)})}o(T);var $={};_(()=>{$!==($=(e(n),p(()=>e(n).id)))&&(T.value=(T.__value=(e(n),p(()=>e(n).id)))??"")}),b(h,T)}),o(y),_(()=>q(xe,`Select a ${e(u)??""}`)),$e(y,()=>e(g),h=>r(g,h)),b(s,y)};M(Wr,s=>{e(J)?s(Kr):s(Qr,!1)})}o(qe);var pr=a(qe,2),Xr=a(l(pr),2);{var Yr=s=>{var y=Tt();b(s,y)},Zr=s=>{var y=Rt();_(()=>{e(I),we(()=>{e(re)})});var L=l(y);L.value=L.__value="";var xe=a(L);ur(xe,1,()=>e(re),gr,(ee,h)=>{var n=Et(),T=l(n,!0);o(n);var O={};_(()=>{q(T,(e(h),p(()=>e(h).name))),O!==(O=(e(h),p(()=>e(h).name)))&&(n.value=(n.__value=(e(h),p(()=>e(h).name)))??"")}),b(ee,n)}),o(y),$e(y,()=>e(I),ee=>r(I,ee)),b(s,y)};M(Xr,s=>{e(W)?s(Yr):s(Zr,!1)})}o(pr),o(Ae),o(ie);var Oe=a(ie,2),Ve=a(l(Oe),2),Be=l(Ve),mr=a(l(Be),2);V(mr),o(Be);var Je=a(Be,2),fr=a(l(Je),2);V(fr),o(Je);var We=a(Je,2),Ke=a(l(We),2);_(()=>{e(R),we(()=>{})});var Qe=l(Ke);Qe.value=Qe.__value="linux";var yr=a(Qe);yr.value=yr.__value="windows",o(Ke),o(We);var xr=a(We,2),Xe=a(l(xr),2);_(()=>{e(te),we(()=>{})});var Ye=l(Xe);Ye.value=Ye.__value="amd64";var hr=a(Ye);hr.value=hr.__value="arm64",o(Xe),o(xr),o(Ve);var _r=a(Ve,2),et=a(l(_r),2);{var rt=s=>{var y=Dt();b(s,y)},tt=s=>{var y=Ir(),L=Pe(y);{var xe=h=>{var n=It(),T=Pe(n);_(()=>{e(z),we(()=>{e(x)})}),ur(T,5,()=>e(x),gr,($,c)=>{var P=At(),_e=l(P),lr=a(_e);{var sr=dr=>{var Ar=Se();_(()=>q(Ar,`- ${e(c),p(()=>e(c).description)??""}`)),b(dr,Ar)};M(lr,dr=>{e(c),p(()=>e(c).description)&&dr(sr)})}o(P);var Ie={};_(()=>{q(_e,`${e(c),p(()=>e(c).name)??""} ${e(c),p(()=>e(c).owner_id==="system"?"(System)":"")??""} `),Ie!==(Ie=(e(c),p(()=>e(c).id)))&&(P.value=(P.__value=(e(c),p(()=>e(c).id)))??"")}),b($,P)}),o(T);var O=a(T,2),he=a(l(O));{var j=$=>{var c=Se();_(P=>q(c,`Showing templates for ${P??""} ${e(R)??""}.`),[()=>p(be)]),b($,c)};M(he,$=>{e(g)&&$(j)})}o(O),$e(T,()=>e(z),$=>r(z,$)),b(h,n)},ee=h=>{var n=Ir(),T=Pe(n);{var O=j=>{var $=zt(),c=l($),P=l(c);o(c);var _e=a(c,2),lr=l(_e);ir(),o(_e),o($),_((sr,Ie)=>{q(P,`No templates found for ${sr??""} ${e(R)??""}.`),nt(lr,"href",Ie)},[()=>p(be),()=>(qr(zr),p(()=>zr("/templates")))]),b(j,$)},he=j=>{var $=Lt();b(j,$)};M(T,j=>{e(g)?j(O):j(he,!1)},!0)}b(h,n)};M(L,h=>{e(x),p(()=>e(x).length>0)?h(xe):h(ee,!1)},!0)}b(s,y)};M(et,s=>{e(K)?s(rt):s(tt,!1)})}o(_r),o(Oe);var Ze=a(Oe,2),kr=a(l(Ze),2),er=l(kr),wr=a(l(er),2);V(wr),o(er);var rr=a(er,2),Sr=a(l(rr),2);V(Sr),o(rr);var $r=a(rr,2),Cr=a(l($r),2);V(Cr),o($r),o(kr),o(Ze);var Pr=a(Ze,2),tr=a(l(Pr),2),ar=l(tr),Mr=a(l(ar),2);V(Mr),o(ar);var Tr=a(ar,2),Er=a(l(Tr),2);V(Er),o(Tr),o(tr);var or=a(tr,2),at=a(l(or),2);vt(at,{rows:4,placeholder:"{}",get value(){return e(Y)},set value(s){r(Y,s)},$$legacy:!0}),o(or);var Rr=a(or,2),Dr=l(Rr);V(Dr),ir(2),o(Rr),o(Pr),_(s=>q(Jr,`${s??""} `),[()=>(e(u),p(()=>e(u).charAt(0).toUpperCase()+e(u).slice(1)))]),Q(mr,()=>e(H),s=>r(H,s)),Q(fr,()=>e(N),s=>r(N,s)),$e(Ke,()=>e(R),s=>r(R,s)),$e(Xe,()=>e(te),s=>r(te,s)),Q(wr,()=>e(X),s=>r(X,s)),Q(Sr,()=>e(m),s=>r(m,s)),Q(Cr,()=>e(ge),s=>r(ge,s)),Q(Mr,()=>e(ve),s=>r(ve,s)),Q(Er,()=>e(ae),s=>r(ae,s)),ut(Dr,()=>e(oe),s=>r(oe,s)),b(S,U)};M(Z,S=>{e(u)&&S(ye)})}var De=a(Z,2),br=l(De),je=a(br,2),Or=l(je);{var Vr=S=>{var U=Ht();b(S,U)},Br=S=>{var U=Se("Create Scale Set");b(S,U)};M(Or,S=>{e(E)?S(Vr):S(Br,!1)})}o(je),o(De),o(le),o(D),_(()=>{cr(fe,1,`flex flex-col items-center justify-center p-4 border-2 rounded-lg transition-colors cursor-pointer ${e(u)==="repository"?"border-blue-500 bg-blue-50 dark:bg-blue-900":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`),cr(t,1,`flex flex-col items-center justify-center p-4 border-2 rounded-lg transition-colors cursor-pointer ${e(u)==="organization"?"border-blue-500 bg-blue-50 dark:bg-blue-900":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`),cr(v,1,`flex flex-col items-center justify-center p-4 border-2 rounded-lg transition-colors cursor-pointer ${e(u)==="enterprise"?"border-blue-500 bg-blue-50 dark:bg-blue-900":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`),je.disabled=!e(ce)}),Q(Te,()=>e(w),S=>r(w,S)),ke("click",fe,()=>pe("repository")),ke("click",t,()=>pe("organization")),ke("click",v,()=>pe("enterprise")),ke("click",br,()=>ue("close")),ke("submit",le,gt(Ne)),b(i,D)},$$slots:{default:!0}}),jr()}const jt={};var qt=k('<div class="p-6"><!></div>'),Ft=k('<div class="space-y-6"><!> <!></div> <!> <!> <!> <!>',1);function va(ze,Le){Hr(Le,!1);const[ce,ue]=dt(),E=()=>it(xt,"$eagerCache",ce),A=d(),u=d(),C=d(),re=d();let x=d([]),J=d(!0),W=d(""),K=d(""),w=d(1),g=d(25),I=d(!1),H=d(!1),N=d(!1),m=d(null),X=d(!1);async function ge(t){try{r(W,""),r(I,!1),ne.success("Scale Set Created","Scale set has been created successfully.")}catch(v){throw r(W,B(v)),v}}async function ve(t){if(e(m))try{await G.updateScaleSet(e(m).id,t),ne.success("Scale Set Updated",`Scale set ${e(m).name} has been updated successfully.`),r(H,!1),r(m,null)}catch(v){const Z=B(v);throw ne.error("Update Failed",Z),v}}async function R(){if(e(m))try{await G.deleteScaleSet(e(m).id),ne.success("Scale Set Deleted",`Scale set ${e(m).name} has been deleted successfully.`)}catch(t){const v=B(t);ne.error("Delete Failed",v)}finally{r(N,!1),r(m,null)}}function te(){r(I,!0)}async function ae(t){try{r(X,!0);const v=await G.getScaleSet(t.id);r(m,v),r(H,!0)}catch(v){const Z=B(v);ne.error("Failed to Load Scale Set Details",Z)}finally{r(X,!1)}}function oe(t){r(m,t),r(N,!0)}Nr(async()=>{try{r(J,!0);const t=await Lr.getScaleSets();t&&Array.isArray(t)&&r(x,t)}catch(t){jt?.VITEST||console.error("Failed to load scale sets:",t),r(W,B(t))}finally{r(J,!1)}});async function Y(){try{await Lr.retryResource("scalesets")}catch(t){console.error("Retry failed:",t)}}const z=[{key:"name",title:"Name",cellComponent:_t,cellProps:{entityType:"scaleset"}},{key:"image",title:"Image",cellComponent:vr,cellProps:{field:"image",type:"code",showTitle:!0}},{key:"provider",title:"Provider",cellComponent:vr,cellProps:{field:"provider_name"}},{key:"flavor",title:"Flavor",cellComponent:vr,cellProps:{field:"flavor"}},{key:"entity",title:"Entity",cellComponent:St},{key:"endpoint",title:"Endpoint",cellComponent:kt},{key:"status",title:"Status",cellComponent:wt,cellProps:{statusType:"enabled"}},{key:"actions",title:"Actions",align:"right",cellComponent:ft}],Ge={entityType:"scaleset",primaryText:{field:"name",isClickable:!0,href:"/scalesets/{id}"},secondaryText:{field:"entity_name",computedValue:t=>Ce(t)},badges:[{type:"custom",value:t=>({variant:t.enabled?"success":"error",text:t.enabled?"Enabled":"Disabled"})}],actions:[{type:"edit",handler:t=>ae(t)},{type:"delete",handler:t=>oe(t)}]};function Me(t){r(K,t.detail.term),r(w,1)}function be(t){r(w,t.detail.page)}function He(t){r(g,t.detail.perPage),r(w,1)}function pe(t){ae(t.detail.item)}function Ne(t){oe(t.detail.item)}F(()=>(e(x),E()),()=>{(!e(x).length||E().loaded.scalesets)&&r(x,E().scalesets)}),F(()=>E(),()=>{r(J,E().loading.scalesets)}),F(()=>E(),()=>{r(A,E().errorMessages.scalesets)}),F(()=>(e(x),e(K),Ce),()=>{r(u,ht(e(x),e(K),t=>Ce(t)))}),F(()=>(e(u),e(g)),()=>{r(C,Math.ceil(e(u).length/e(g)))}),F(()=>(e(w),e(C)),()=>{e(w)>e(C)&&e(C)>0&&r(w,e(C))}),F(()=>(e(u),e(w),e(g)),()=>{r(re,e(u).slice((e(w)-1)*e(g),e(w)*e(g)))}),Ur(),Gr();var i=Ft();lt(t=>{st.title="Scale Sets - GARM"});var f=Pe(i),D=l(f);ct(D,{title:"Scale Sets",description:"Manage GitHub runner scale sets",actionLabel:"Add Scale Set",$$events:{action:te}});var le=a(D,2);{let t=nr(()=>e(A)||e(W)),v=nr(()=>!!e(A));mt(le,{get columns(){return z},get data(){return e(re)},get loading(){return e(J)},get error(){return e(t)},get searchTerm(){return e(K)},searchPlaceholder:"Search by entity name...",get currentPage(){return e(w)},get perPage(){return e(g)},get totalPages(){return e(C)},get totalItems(){return e(u),p(()=>e(u).length)},itemName:"scale sets",emptyIconType:"cog",get showRetry(){return e(v)},get mobileCardConfig(){return Ge},$$events:{search:Me,pageChange:be,perPageChange:He,retry:Y,edit:pe,delete:Ne}})}o(f);var me=a(f,2);{var Ue=t=>{Ut(t,{$$events:{close:()=>r(I,!1),submit:v=>ge(v.detail)}})};M(me,t=>{e(I)&&t(Ue)})}var se=a(me,2);{var Te=t=>{bt(t,{get scaleSet(){return e(m)},$$events:{close:()=>{r(H,!1),r(m,null)},submit:v=>ve(v.detail)}})};M(se,t=>{e(H)&&e(m)&&t(Te)})}var de=a(se,2);{var Ee=t=>{{let v=nr(()=>(e(m),qr(Ce),p(()=>`Scale Set ${e(m).name} (${Ce(e(m))})`)));pt(t,{title:"Delete Scale Set",message:"Are you sure you want to delete this scale set? This action cannot be undone and will remove all associated runners.",get itemName(){return e(v)},$$events:{close:()=>{r(N,!1),r(m,null)},confirm:R}})}};M(de,t=>{e(N)&&e(m)&&t(Ee)})}var Re=a(de,2);{var fe=t=>{Fr(t,{$$events:{close:()=>{}},children:(v,Z)=>{var ye=qt(),De=l(ye);yt(De,{message:"Loading scale set details..."}),o(ye),b(v,ye)},$$slots:{default:!0}})};M(Re,t=>{e(X)&&t(fe)})}b(ze,i),jr(),ue()}export{va as component};
