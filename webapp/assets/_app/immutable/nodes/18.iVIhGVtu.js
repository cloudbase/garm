import"../chunks/DsnmJJEf.js";import{i as Ht}from"../chunks/B3Pzt0F_.js";import{p as Jt,o as jt,A as qt,l as zt,a as Pt,f as w,h as Vt,b as F,t as k,c as p,d as Wt,s as l,m as _,u as i,$ as Kt,g as e,j as a,r,k as d,v as o,y as ve,B as Pe,q as I,n as x}from"../chunks/D8EpLgQ1.js";import{i as g,s as Qt,a as Xt}from"../chunks/5WA7h8uK.js";import{c as Ve,g as U,s as Yt}from"../chunks/CiE1LlKV.js";import{p as Zt}from"../chunks/C41YH50Q.js";import{g as We}from"../chunks/CTf6mQoE.js";import{b as me}from"../chunks/CoIRRsD9.js";import{U as ea}from"../chunks/C89fcOde.js";import{D as Ke}from"../chunks/KQ2xQpA3.js";import{D as ta,I as aa}from"../chunks/DDhBTdDt.js";import{w as Qe}from"../chunks/u94nIB4-.js";import{t as B}from"../chunks/BEkVdVE1.js";import{e as S,i as R,j as Xe,b as C,g as Ye}from"../chunks/BGVHQGl-.js";var ra=w('<div class="p-6 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading scale set...</p></div>'),sa=w('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),da=w('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">GitHub Runner Group</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div>'),ia=w('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Extra Specifications</h2> <pre class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md overflow-x-auto text-sm text-gray-900 dark:text-white font-mono"> </pre></div></div>'),na=w('<!> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Basic Information</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Scale Set ID</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Name</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white font-medium"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Provider</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Image</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"><code class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs"> </code></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Flavor</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Status</dt> <dd class="mt-1"><span> </span></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Entity</dt> <dd class="mt-1"><div class="flex items-center space-x-2"><span class="inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"> </span> <a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></div></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Configuration</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Max Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Min Idle Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Bootstrap Timeout</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Prefix</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">OS Type / Architecture</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <!></dl></div></div></div> <!> <!>',1),la=w('<div class="space-y-6"><nav class="flex" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg> Scale Sets</a></li> <li><div class="flex items-center"><svg class="w-3 h-3 text-gray-400 mx-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"> </span></div></li></ol></nav> <!></div> <!> <!> <!>',1);function Sa(Ze,et){Jt(et,!1);const[tt,at]=Qt(),ue=()=>Xt(Zt,"$page",tt),D=_();let t=_(null),G=_(!0),E=_(""),M=_(!1),N=_(!1),$=_(!1),m=_(null),A=null;async function L(){if(!(!e(D)||isNaN(e(D))))try{l(G,!0),l(E,""),l(t,await U.getScaleSet(e(D)))}catch(s){l(E,s instanceof Error?s.message:"Failed to load scale set")}finally{l(G,!1)}}async function rt(s){if(e(t))try{await U.updateScaleSet(e(t).id,s),await L(),B.success("Scale Set Updated",`Scale Set ${e(t).name} has been updated successfully.`),l(M,!1)}catch(n){throw n}}async function st(){if(e(t)){try{await U.deleteScaleSet(e(t).id),We(`${me}/scalesets`)}catch(s){const n=s instanceof Error?s.message:"Failed to delete scale set";B.error("Delete Failed",n)}l(N,!1)}}async function dt(){if(e(m)){try{await U.deleteInstance(e(m).name),B.success("Instance Deleted",`Instance ${e(m).name} has been deleted successfully.`),await L(),l($,!1),l(m,null)}catch(s){const n=s instanceof Error?s.message:"Failed to delete instance";B.error("Delete Failed",n)}l($,!1),l(m,null)}}function it(s){l(m,s),l($,!0)}function nt(s){if(!s)return"{}";try{if(typeof s=="string"){const n=JSON.parse(s);return JSON.stringify(n,null,2)}return JSON.stringify(s,null,2)}catch{return s.toString()}}function lt(s){if(s.operation==="update"){const n=s.payload;e(t)&&n.id===e(t).id&&l(t,n)}else if(s.operation==="delete"){const n=s.payload.id||s.payload;e(t)&&e(t).id===n&&We(`${me}/scalesets`)}}function ot(s){if(!e(t)||!e(t).instances)return;const n=s.payload;if(n.scale_set_id===e(t).id){if(s.operation==="create")ve(t,e(t).instances=[...e(t).instances,n]);else if(s.operation==="update")ve(t,e(t).instances=e(t).instances.map(y=>y.id===n.id?n:y));else if(s.operation==="delete"){const y=n.id||n;ve(t,e(t).instances=e(t).instances.filter(j=>j.id!==y))}l(t,e(t))}}jt(()=>{L();const s=Qe.subscribeToEntity("scaleset",["update","delete"],lt),n=Qe.subscribeToEntity("instance",["create","update","delete"],ot);A=()=>{s(),n()}}),qt(()=>{A&&(A(),A=null)}),zt(()=>ue(),()=>{l(D,parseInt(ue().params.id||"0"))}),Pt(),Ht();var xe=la();Vt(s=>{k(()=>Kt.title=`${e(t),i(()=>e(t)?`${e(t).name} - Scale Set Details`:"Scale Set Details")??""} - GARM`)});var O=F(xe),H=a(O),ge=a(H),J=a(ge),ct=a(J);r(J);var fe=d(J,2),pe=a(fe),_e=d(a(pe),2),vt=a(_e,!0);r(_e),r(pe),r(fe),r(ge),r(H);var mt=d(H,2);{var ut=s=>{var n=ra();p(s,n)},xt=s=>{var n=Pe(),y=F(n);{var j=h=>{var b=sa(),T=a(b),q=a(T,!0);r(T),r(b),k(()=>o(q,e(E))),p(h,b)},yt=h=>{var b=Pe(),T=F(b);{var q=z=>{var be=na(),ke=F(be);{let c=I(()=>(e(t),i(()=>e(t).name||"Scale Set"))),v=I(()=>(x(S),e(t),i(()=>S(e(t))))),u=I(()=>(x(R),e(t),i(()=>R(e(t))))),f=I(()=>(x(Ye),i(()=>Ye("github"))));ta(ke,{get title(){return e(c)},get subtitle(){return`Scale set for ${e(v)??""} (${e(u)??""}) â€¢ GitHub Runner Scale Set`},get forgeIcon(){return e(f)},onEdit:()=>l(M,!0),onDelete:()=>l(N,!0)})}var P=d(ke,2),V=a(P),Se=a(V),we=d(a(Se),2),W=a(we),$e=d(a(W),2),ht=a($e,!0);r($e),r(W);var K=d(W,2),Ie=d(a(K),2),bt=a(Ie,!0);r(Ie),r(K);var Q=d(K,2),De=d(a(Q),2),kt=a(De,!0);r(De),r(Q);var X=d(Q,2),Ee=d(a(X),2),Me=a(Ee),St=a(Me,!0);r(Me),r(Ee),r(X);var Y=d(X,2),Ne=d(a(Y),2),wt=a(Ne,!0);r(Ne),r(Y);var Z=d(Y,2),Ae=d(a(Z),2),ee=a(Ae),$t=a(ee,!0);r(ee),r(Ae),r(Z);var te=d(Z,2),Te=d(a(te),2),Fe=a(Te),ae=a(Fe),It=a(ae,!0);r(ae);var re=d(ae,2),Dt=a(re,!0);r(re),r(Fe),r(Te),r(te);var se=d(te,2),Ue=d(a(se),2),Et=a(Ue,!0);r(Ue),r(se);var Be=d(se,2),Re=d(a(Be),2),Mt=a(Re,!0);r(Re),r(Be),r(we),r(Se),r(V);var Ce=d(V,2),Ge=a(Ce),Le=d(a(Ge),2),de=a(Le),Oe=d(a(de),2),Nt=a(Oe,!0);r(Oe),r(de);var ie=d(de,2),He=d(a(ie),2),At=a(He,!0);r(He),r(ie);var ne=d(ie,2),Je=d(a(ne),2),Tt=a(Je);r(Je),r(ne);var le=d(ne,2),je=d(a(le),2),Ft=a(je,!0);r(je),r(le);var oe=d(le,2),qe=d(a(oe),2),Ut=a(qe);r(qe),r(oe);var Bt=d(oe,2);{var Rt=c=>{var v=da(),u=d(a(v),2),f=a(u,!0);r(u),r(v),k(()=>o(f,(e(t),i(()=>e(t)["github-runner-group"])))),p(c,v)};g(Bt,c=>{e(t),i(()=>e(t)["github-runner-group"])&&c(Rt)})}r(Le),r(Ge),r(Ce),r(P);var ze=d(P,2);{var Ct=c=>{var v=ia(),u=a(v),f=d(a(u),2),ce=a(f,!0);r(f),r(u),r(v),k(Ot=>o(ce,Ot),[()=>(e(t),i(()=>nt(e(t).extra_specs)))]),p(c,v)};g(ze,c=>{e(t),i(()=>e(t).extra_specs)&&c(Ct)})}var Gt=d(ze,2);{var Lt=c=>{aa(c,{get instances(){return e(t),i(()=>e(t).instances)},entityType:"scaleset",onDeleteInstance:it})};g(Gt,c=>{e(t),i(()=>e(t).instances)&&c(Lt)})}k((c,v,u,f,ce)=>{o(ht,(e(t),i(()=>e(t).id))),o(bt,(e(t),i(()=>e(t).name))),o(kt,(e(t),i(()=>e(t).provider_name))),o(St,(e(t),i(()=>e(t).image))),o(wt,(e(t),i(()=>e(t).flavor))),Yt(ee,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${e(t),i(()=>e(t).enabled?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200")??""}`),o($t,(e(t),i(()=>e(t).enabled?"Enabled":"Disabled"))),o(It,c),Ve(re,"href",v),o(Dt,u),o(Et,f),o(Mt,ce),o(Nt,(e(t),i(()=>e(t).max_runners))),o(At,(e(t),i(()=>e(t).min_idle_runners))),o(Tt,`${e(t),i(()=>e(t).runner_bootstrap_timeout)??""} minutes`),o(Ft,(e(t),i(()=>e(t).runner_prefix||"garm"))),o(Ut,`${e(t),i(()=>e(t).os_type)??""} / ${e(t),i(()=>e(t).os_arch)??""}`)},[()=>(x(R),e(t),i(()=>R(e(t)))),()=>(x(Xe),e(t),i(()=>Xe(e(t)))),()=>(x(S),e(t),i(()=>S(e(t)))),()=>(x(C),e(t),i(()=>C(e(t).created_at||""))),()=>(x(C),e(t),i(()=>C(e(t).updated_at||"")))]),p(z,be)};g(T,z=>{e(t)&&z(q)},!0)}p(h,b)};g(y,h=>{e(E)?h(j):h(yt,!1)},!0)}p(s,n)};g(mt,s=>{e(G)?s(ut):s(xt,!1)})}r(O);var ye=d(O,2);{var gt=s=>{ea(s,{get scaleSet(){return e(t)},$$events:{close:()=>l(M,!1),submit:n=>rt(n.detail)}})};g(ye,s=>{e(M)&&e(t)&&s(gt)})}var he=d(ye,2);{var ft=s=>{{let n=I(()=>(e(t),x(S),i(()=>`Scale Set ${e(t).name} (${S(e(t))})`)));Ke(s,{title:"Delete Scale Set",message:"Are you sure you want to delete this scale set? This action cannot be undone and will remove all associated runners.",get itemName(){return e(n)},$$events:{close:()=>l(N,!1),confirm:st}})}};g(he,s=>{e(N)&&e(t)&&s(ft)})}var pt=d(he,2);{var _t=s=>{Ke(s,{title:"Delete Instance",message:"Are you sure you want to delete this instance? This action cannot be undone.",get itemName(){return e(m),i(()=>e(m).name)},$$events:{close:()=>{l($,!1),l(m,null)},confirm:dt}})};g(pt,s=>{e($)&&e(m)&&s(_t)})}k(()=>{Ve(ct,"href",`${me}/scalesets`),o(vt,(e(t),i(()=>e(t)?e(t).name:"Loading...")))}),p(Ze,xe),Wt(),at()}export{Sa as component};
