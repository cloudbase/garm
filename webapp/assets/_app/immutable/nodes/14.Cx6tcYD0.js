import"../chunks/DsnmJJEf.js";import{i as ze}from"../chunks/zNh6Oe5P.js";import{p as He,o as Ve,A as We,l as Ke,a as Qe,f as h,h as Xe,b as F,t as b,c as x,d as Ye,u as i,n as u,v as l,g as t,m as y,j as r,k as s,s as n,$ as Ze,r as a,y as D,B as Kt,q as M}from"../chunks/sWNKMed7.js";import{i as f,s as ta,a as ea}from"../chunks/Ccl3fNd2.js";import{w as Qt,e as aa,i as ra}from"../chunks/BuuPrWMc.js";import{d as R,c as Xt,g as C,s as da}from"../chunks/C1jihKTd.js";import{p as sa}from"../chunks/DQxjqDvj.js";import{g as Yt}from"../chunks/H5nVv3Is.js";import{U as ia}from"../chunks/wtPi3qcm.js";import{D as Zt}from"../chunks/ujTHIzr1.js";import{D as oa,I as na}from"../chunks/C50dSO3X.js";import{t as E}from"../chunks/BZUCTtPY.js";import{e as P,i as L,j as te,b as O,g as ee}from"../chunks/Qi7G5Z5O.js";import{e as G}from"../chunks/BZiHL9L3.js";var la=h('<div class="p-6 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading pool...</p></div>'),va=h('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),ca=h('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">GitHub Runner Group</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div>'),ma=h('<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"> </span>'),xa=h('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Tags</dt> <dd class="mt-1"><div class="flex flex-wrap gap-2"></div></dd></div>'),ua=h('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Extra Specifications</h2> <pre class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md overflow-x-auto text-sm text-gray-900 dark:text-white font-mono"> </pre></div></div>'),ga=h('<!> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Basic Information</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Pool ID</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white font-mono"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Provider</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Image</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"><code class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs"> </code></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Flavor</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Status</dt> <dd class="mt-1"><span> </span></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Entity</dt> <dd class="mt-1"><div class="flex items-center space-x-2"><span class="inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"> </span> <a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></div></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Configuration</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Max Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Min Idle Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Bootstrap Timeout</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Priority</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Prefix</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">OS Type / Architecture</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <!> <!></dl></div></div></div> <!> <!>',1),pa=h('<div class="space-y-6"><nav class="flex" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg> Pools</a></li> <li><div class="flex items-center"><svg class="w-3 h-3 text-gray-400 mx-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"> </span></div></li></ol></nav> <!></div> <!> <!> <!>',1);function Ta(ae,re){He(re,!1);const[de,se]=ta(),gt=()=>ea(sa,"$page",de),J=y();let e=y(null),j=y(!0),A=y(""),T=y(!1),U=y(!1),S=y(!1),g=y(null),B=null;async function ie(){if(t(J))try{n(j,!0),n(A,""),n(e,await C.getPool(t(J))),t(e).instances||D(e,t(e).instances=[])}catch(d){n(A,G(d))}finally{n(j,!1)}}async function oe(d){if(t(e))try{const o=await C.updatePool(t(e).id,d);n(e,o),n(T,!1),E.success("Pool Updated",`Pool ${t(e).id} has been updated successfully.`)}catch(o){const _=G(o);E.error("Update Failed",_)}}async function ne(){if(t(e)){try{await C.deletePool(t(e).id),Yt(R("/pools"))}catch(d){const o=G(d);E.error("Delete Failed",o)}n(U,!1)}}async function le(){if(t(g)){try{await C.deleteInstance(t(g).name),E.success("Instance Deleted",`Instance ${t(g).name} has been deleted successfully.`)}catch(d){const o=G(d);E.error("Delete Failed",o)}n(S,!1),n(g,null)}}function ve(d){n(g,d),n(S,!0)}function ce(d){if(!d)return"{}";try{if(typeof d=="string"){const o=JSON.parse(d);return JSON.stringify(o,null,2)}return JSON.stringify(d,null,2)}catch{return d.toString()}}function me(d){if(d.operation==="update"){const o=d.payload;t(e)&&o.id===t(e).id&&n(e,o)}else if(d.operation==="delete"){const o=d.payload.id||d.payload;t(e)&&t(e).id===o&&Yt(R("/pools"))}}function xe(d){if(!t(e))return;const o=d.payload;if(o.pool_id===t(e).id){if(t(e).instances||D(e,t(e).instances=[]),d.operation==="create")D(e,t(e).instances=[...t(e).instances,o]);else if(d.operation==="update")D(e,t(e).instances=t(e).instances.map(_=>_.id===o.id?o:_));else if(d.operation==="delete"){const _=o.id||o;D(e,t(e).instances=t(e).instances.filter(V=>V.id!==_))}n(e,t(e))}}Ve(()=>{ie();const d=Qt.subscribeToEntity("pool",["update","delete"],me),o=Qt.subscribeToEntity("instance",["create","update","delete"],xe);B=()=>{d(),o()}}),We(()=>{B&&(B(),B=null)}),Ke(()=>gt(),()=>{n(J,gt().params.id)}),Qe(),ze();var pt=pa();Xe(d=>{b(()=>Ze.title=`${t(e),i(()=>t(e)?`Pool ${t(e).id} - Pool Details`:"Pool Details")??""} - GARM`)});var q=F(pt),z=r(q),ft=r(z),H=r(ft),ue=r(H);a(H);var _t=s(H,2),yt=r(_t),ht=s(r(yt),2),ge=r(ht,!0);a(ht),a(yt),a(_t),a(ft),a(z);var pe=s(z,2);{var fe=d=>{var o=la();x(d,o)},_e=d=>{var o=Kt(),_=F(o);{var V=k=>{var w=va(),N=r(w),W=r(N,!0);a(N),a(w),b(()=>l(W,t(A))),x(k,w)},we=k=>{var w=Kt(),N=F(w);{var W=K=>{var wt=ga(),$t=F(wt);{let v=M(()=>(u(P),t(e),i(()=>P(t(e))))),c=M(()=>(u(L),t(e),i(()=>L(t(e))))),m=M(()=>(u(ee),t(e),i(()=>ee(t(e).endpoint?.endpoint_type||"unknown"))));oa($t,{get title(){return t(e),i(()=>t(e).id)},get subtitle(){return`Pool for ${t(v)??""} (${t(c)??""})`},get forgeIcon(){return t(m)},onEdit:()=>n(T,!0),onDelete:()=>n(U,!0)})}var Q=s($t,2),X=r(Q),Pt=r(X),It=s(r(Pt),2),Y=r(It),Dt=s(r(Y),2),$e=r(Dt,!0);a(Dt),a(Y);var Z=s(Y,2),Mt=s(r(Z),2),Pe=r(Mt,!0);a(Mt),a(Z);var tt=s(Z,2),Et=s(r(tt),2),At=r(Et),Ie=r(At,!0);a(At),a(Et),a(tt);var et=s(tt,2),Tt=s(r(et),2),De=r(Tt,!0);a(Tt),a(et);var at=s(et,2),Ut=s(r(at),2),rt=r(Ut),Me=r(rt,!0);a(rt),a(Ut),a(at);var dt=s(at,2),St=s(r(dt),2),Bt=r(St),st=r(Bt),Ee=r(st,!0);a(st);var it=s(st,2),Ae=r(it,!0);a(it),a(Bt),a(St),a(dt);var ot=s(dt,2),Nt=s(r(ot),2),Te=r(Nt,!0);a(Nt),a(ot);var Ft=s(ot,2),Rt=s(r(Ft),2),Ue=r(Rt,!0);a(Rt),a(Ft),a(It),a(Pt),a(X);var Ct=s(X,2),Lt=r(Ct),Ot=s(r(Lt),2),nt=r(Ot),Gt=s(r(nt),2),Se=r(Gt,!0);a(Gt),a(nt);var lt=s(nt,2),Jt=s(r(lt),2),Be=r(Jt,!0);a(Jt),a(lt);var vt=s(lt,2),jt=s(r(vt),2),Ne=r(jt);a(jt),a(vt);var ct=s(vt,2),qt=s(r(ct),2),Fe=r(qt,!0);a(qt),a(ct);var mt=s(ct,2),zt=s(r(mt),2),Re=r(zt,!0);a(zt),a(mt);var xt=s(mt,2),Ht=s(r(xt),2),Ce=r(Ht);a(Ht),a(xt);var Vt=s(xt,2);{var Le=v=>{var c=ca(),m=s(r(c),2),p=r(m,!0);a(m),a(c),b(()=>l(p,(t(e),i(()=>t(e)["github-runner-group"])))),x(v,c)};f(Vt,v=>{t(e),i(()=>t(e)["github-runner-group"])&&v(Le)})}var Oe=s(Vt,2);{var Ge=v=>{var c=xa(),m=s(r(c),2),p=r(m);aa(p,5,()=>(t(e),i(()=>t(e).tags)),ra,(I,$)=>{var ut=ma(),qe=r(ut,!0);a(ut),b(()=>l(qe,(t($),i(()=>typeof t($)=="string"?t($):t($).name)))),x(I,ut)}),a(p),a(m),a(c),x(v,c)};f(Oe,v=>{t(e),i(()=>t(e).tags&&t(e).tags.length>0)&&v(Ge)})}a(Ot),a(Lt),a(Ct),a(Q);var Wt=s(Q,2);{var Je=v=>{var c=ua(),m=r(c),p=s(r(m),2),I=r(p,!0);a(p),a(m),a(c),b($=>l(I,$),[()=>(t(e),i(()=>ce(t(e).extra_specs)))]),x(v,c)};f(Wt,v=>{t(e),i(()=>t(e).extra_specs)&&v(Je)})}var je=s(Wt,2);{let v=M(()=>(t(e),i(()=>t(e).instances||[])));na(je,{get instances(){return t(v)},entityType:"pool",onDeleteInstance:ve})}b((v,c,m,p,I)=>{l($e,(t(e),i(()=>t(e).id))),l(Pe,(t(e),i(()=>t(e).provider_name))),l(Ie,(t(e),i(()=>t(e).image))),l(De,(t(e),i(()=>t(e).flavor))),da(rt,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enabled?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200")??""}`),l(Me,(t(e),i(()=>t(e).enabled?"Enabled":"Disabled"))),l(Ee,v),Xt(it,"href",c),l(Ae,m),l(Te,p),l(Ue,I),l(Se,(t(e),i(()=>t(e).max_runners))),l(Be,(t(e),i(()=>t(e).min_idle_runners))),l(Ne,`${t(e),i(()=>t(e).runner_bootstrap_timeout)??""} minutes`),l(Fe,(t(e),i(()=>t(e).priority))),l(Re,(t(e),i(()=>t(e).runner_prefix||"garm"))),l(Ce,`${t(e),i(()=>t(e).os_type)??""} / ${t(e),i(()=>t(e).os_arch)??""}`)},[()=>(u(L),t(e),i(()=>L(t(e)))),()=>(u(te),t(e),i(()=>te(t(e)))),()=>(u(P),t(e),i(()=>P(t(e)))),()=>(u(O),t(e),i(()=>O(t(e).created_at||""))),()=>(u(O),t(e),i(()=>O(t(e).updated_at||"")))]),x(K,wt)};f(N,K=>{t(e)&&K(W)},!0)}x(k,w)};f(_,k=>{t(A)?k(V):k(we,!1)},!0)}x(d,o)};f(pe,d=>{t(j)?d(fe):d(_e,!1)})}a(q);var bt=s(q,2);{var ye=d=>{ia(d,{get pool(){return t(e)},$$events:{close:()=>n(T,!1),submit:o=>oe(o.detail)}})};f(bt,d=>{t(T)&&t(e)&&d(ye)})}var kt=s(bt,2);{var he=d=>{{let o=M(()=>(t(e),u(P),i(()=>`Pool ${t(e).id} (${P(t(e))})`)));Zt(d,{title:"Delete Pool",message:"Are you sure you want to delete this pool? This action cannot be undone and will remove all associated runners.",get itemName(){return t(o)},$$events:{close:()=>n(U,!1),confirm:ne}})}};f(kt,d=>{t(U)&&t(e)&&d(he)})}var be=s(kt,2);{var ke=d=>{Zt(d,{title:"Delete Instance",message:"Are you sure you want to delete this instance? This action cannot be undone.",get itemName(){return t(g),i(()=>t(g).name)},$$events:{close:()=>{n(S,!1),n(g,null)},confirm:le}})};f(be,d=>{t(S)&&t(g)&&d(ke)})}b(d=>{Xt(ue,"href",d),l(ge,(t(e),i(()=>t(e)?t(e).id:"Loading...")))},[()=>(u(R),i(()=>R("/pools")))]),x(ae,pt),Ye(),se()}export{Ta as component};
