import{f as j,h as re,a as w,c as z,s as R}from"../chunks/ZGz3X54u.js";import{i as se}from"../chunks/CY7Wcm-1.js";import{p as le,o as ne,l as E,b as ie,a as oe,g as e,m as c,$ as me,c as v,i,s as T,t as J,f as K,u as a,d as s,r as _,h as l}from"../chunks/kDtaAWAK.js";import{i as F}from"../chunks/Cun6jNAp.js";import{g as ce}from"../chunks/CYK-UalN.js";import{P as de}from"../chunks/DacI6VAP.js";import{D as ue,G as N}from"../chunks/BKeluGSY.js";import{B as L}from"../chunks/DbE0zTOa.js";import"../chunks/DWgB-t1g.js";import{e as ge}from"../chunks/BZiHL9L3.js";var fe=j('<p class="text-xs text-gray-400 dark:text-gray-500 truncate"> </p>'),pe=j('<div class="flex items-center justify-between"><div class="flex-1 min-w-0"><p class="text-sm font-medium text-gray-900 dark:text-white truncate"> </p> <p class="text-xs text-gray-500 dark:text-gray-400 truncate"> </p> <!></div> <div class="flex items-center space-x-2 ml-4"><!> <!></div></div>'),ve=j('<div class="space-y-6"><!> <!></div>');function Te(O,Q){le(Q,!1);const g=c(),h=c(),q=c();let S=c([]),B=c(!0),U=c(""),A=c(""),o=c(1),f=c(25);function W(r,y){if(!y)return r;const d=y.toLowerCase();return r.filter(t=>t.username?.toLowerCase().includes(d)||t.email?.toLowerCase().includes(d)||t.full_name?.toLowerCase().includes(d))}async function H(){try{s(B,!0),s(U,""),s(S,await ce.listUsers())}catch(r){s(U,ge(r)),console.error("Failed to load users:",r)}finally{s(B,!1)}}ne(()=>{H()});const X=[{key:"username",title:"Username",cellComponent:N,cellProps:{field:"username"}},{key:"email",title:"Email",cellComponent:N,cellProps:{field:"email"}},{key:"full_name",title:"Full Name",cellComponent:N,cellProps:{field:"full_name"}},{key:"is_admin",title:"Role",align:"center"},{key:"enabled",title:"Status",align:"center"}];function Y(r){s(A,r.detail.term),s(o,1)}function Z(r){s(o,r.detail.page)}function ee(r){s(f,r.detail.perPage),s(o,1)}E(()=>(e(S),e(A)),()=>{s(g,W(e(S),e(A)))}),E(()=>(e(g),e(f)),()=>{s(h,Math.ceil(e(g).length/e(f)))}),E(()=>(e(o),e(h)),()=>{e(o)>e(h)&&e(h)>0&&s(o,e(h))}),E(()=>(e(g),e(o),e(f)),()=>{s(q,e(g).slice((e(o)-1)*e(f),e(o)*e(f)))}),ie(),se();var G=ve();re(r=>{me.title="Users - GARM"});var V=v(G);de(V,{title:"Users",description:"View all users in the system"});var te=T(V,2);{let r=i(()=>!!e(U));ue(te,{get columns(){return X},get data(){return e(q)},get loading(){return e(B)},get error(){return e(U)},get searchTerm(){return e(A)},searchPlaceholder:"Search users...",get currentPage(){return e(o)},get perPage(){return e(f)},get totalPages(){return e(h)},get totalItems(){return e(g),a(()=>e(g).length)},itemName:"users",emptyIconType:"users",get showRetry(){return e(r)},$$events:{search:Y,pageChange:Z,perPageChange:ee,retry:H},$$slots:{cell:(y,d)=>{const t=i(()=>d.column),n=i(()=>d.item);var x=z(),$=K(x);{var I=u=>{{let b=i(()=>(l(e(n)),a(()=>e(n).is_admin?"purple":"gray"))),C=i(()=>(l(e(n)),a(()=>e(n).is_admin?"Admin":"User")));L(u,{get variant(){return e(b)},get text(){return e(C)}})}},k=u=>{var b=z(),C=K(b);{var D=P=>{{let M=i(()=>(l(e(n)),a(()=>e(n).enabled?"green":"red"))),m=i(()=>(l(e(n)),a(()=>e(n).enabled?"Enabled":"Disabled")));L(P,{get variant(){return e(M)},get text(){return e(m)}})}};F(C,P=>{l(e(t)),a(()=>e(t).key==="enabled")&&P(D)},!0)}w(u,b)};F($,u=>{l(e(t)),a(()=>e(t).key==="is_admin")?u(I):u(k,!1)})}w(y,x)},"mobile-card":(y,d)=>{const t=i(()=>d.item);var n=pe(),x=v(n),$=v(x),I=v($,!0);_($);var k=T($,2),u=v(k,!0);_(k);var b=T(k,2);{var C=m=>{var p=fe(),ae=v(p,!0);_(p),J(()=>R(ae,(l(e(t)),a(()=>e(t).full_name)))),w(m,p)};F(b,m=>{l(e(t)),a(()=>e(t).full_name)&&m(C)})}_(x);var D=T(x,2),P=v(D);{let m=i(()=>(l(e(t)),a(()=>e(t).is_admin?"purple":"gray"))),p=i(()=>(l(e(t)),a(()=>e(t).is_admin?"Admin":"User")));L(P,{get variant(){return e(m)},get text(){return e(p)}})}var M=T(P,2);{let m=i(()=>(l(e(t)),a(()=>e(t).enabled?"green":"red"))),p=i(()=>(l(e(t)),a(()=>e(t).enabled?"Enabled":"Disabled")));L(M,{get variant(){return e(m)},get text(){return e(p)}})}_(D),_(n),J(()=>{R(I,(l(e(t)),a(()=>e(t).username))),R(u,(l(e(t)),a(()=>e(t).email)))}),w(y,n)}}})}_(G),w(O,G),oe()}export{Te as component};
