import{c as sa,a as k,h as ia,b as f,l as oa,s as l,f as w,d as oe}from"../chunks/CxOx-TIJ.js";import{i as na}from"../chunks/3NxSoY2_.js";import{p as la,o as va,x as ma,l as ca,b as xa,f as H,d as x,t as P,a as ua,s,g as t,m as $,u as i,h as _,F as b,c as r,j as m,$ as ga,r as a,e as S,n as J,k as U,i as p}from"../chunks/DzFKsO_V.js";import{i as y}from"../chunks/B_jyf0qs.js";import{e as pa,i as fa}from"../chunks/CdXRaxkX.js";import{c as F,d as Dt,g as j,s as ne}from"../chunks/BguOOs3x.js";import{p as le}from"../chunks/CH-vk5qo.js";import{g as ve}from"../chunks/BzzAh3Be.js";import{U as _a}from"../chunks/lcoLiK7X.js";import{D as me}from"../chunks/DL1RlOO9.js";import{I as ya}from"../chunks/CzarUgpd.js";import{D as ba}from"../chunks/BLYRAgBX.js";import{w as ce}from"../chunks/DSHGoHxX.js";import{t as N}from"../chunks/li_-Mkq2.js";import{e as A,i as q,j as xe,b as z,g as ue}from"../chunks/JkzpcrZD.js";import{e as V}from"../chunks/BZiHL9L3.js";import{F as ha}from"../chunks/DaHsWCjd.js";n[b]="src/routes/pools/[id]/+page.svelte";var ka=k(w('<div class="p-6 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading pool...</p></div>'),n[b],[[231,2,[[232,3],[233,3]]]]),wa=k(w('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),n[b],[[236,2,[[237,3]]]]),Da=k(w('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Install Template</dt> <dd class="mt-1"><a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></dd></div>'),n[b],[[351,7,[[352,8],[353,8,[[354,9]]]]]]),Ia=k(w('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">GitHub Runner Group</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div>'),n[b],[[361,7,[[362,8],[363,8]]]]),Pa=k(w('<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"> </span>'),n[b],[[372,11]]),$a=k(w('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Tags</dt> <dd class="mt-1"><div class="flex flex-wrap gap-2"></div></dd></div>'),n[b],[[367,7,[[368,8],[369,8,[[370,9]]]]]]),Ma=k(w('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Extra Specifications</h2> <pre class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md overflow-x-auto text-sm text-gray-900 dark:text-white font-mono"> </pre></div></div>'),n[b],[[387,3,[[388,4,[[389,5],[390,5]]]]]]),Ta=k(w('<!> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Basic Information</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Pool ID</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white font-mono"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Provider</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Forge Type</dt> <dd class="mt-1"><!></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Image</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"><code class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs"> </code></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Flavor</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Status</dt> <dd class="mt-1"><span> </span></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Entity</dt> <dd class="mt-1"><div class="flex items-center space-x-2"><span class="inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"> </span> <a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></div></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Configuration</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Max Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Min Idle Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Bootstrap Timeout</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Priority</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Prefix</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">OS Type / Architecture</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Shell Access</dt> <dd class="mt-1"><span> </span></dd></div> <!> <!> <!></dl></div></div></div> <!> <!>',1),n[b],[[250,2,[[252,3,[[253,4,[[254,5],[255,5,[[256,6,[[257,7],[258,7]]],[260,6,[[261,7],[262,7]]],[264,6,[[265,7],[266,7]]],[270,6,[[271,7],[272,7,[[273,8]]]]],[276,6,[[277,7],[278,7]]],[280,6,[[281,7],[282,7,[[283,8]]]]],[288,6,[[289,7],[290,7,[[291,8,[[292,9],[295,9]]]]]]],[301,6,[[302,7],[303,7]]],[305,6,[[306,7],[307,7]]]]]]]]],[314,3,[[315,4,[[316,5],[317,5,[[318,6,[[319,7],[320,7]]],[322,6,[[323,7],[324,7]]],[326,6,[[327,7],[328,7]]],[330,6,[[331,7],[332,7]]],[334,6,[[335,7],[336,7]]],[338,6,[[339,7],[340,7]]],[342,6,[[343,7],[344,7,[[345,8]]]]]]]]]]]]]]),Ea=k(w('<div class="space-y-6"><nav class="flex" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg> Pools</a></li> <li><div class="flex items-center"><svg class="w-3 h-3 text-gray-400 mx-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"> </span></div></li></ol></nav> <!></div> <!> <!> <!>',1),n[b],[[205,0,[[207,1,[[208,2,[[209,3,[[210,4,[[211,5,[[212,6]]]]]]],[217,3,[[218,4,[[219,5,[[220,6]]],[222,5]]]]]]]]]]]]);function n(ge,pe){sa(new.target),la(pe,!1,n);const W=$();let e=$(null),K=$(!0),C=$(""),R=$(!1),B=$(!1),L=$(!1),h=$(null),O=null;async function fe(){if(t(W))try{m(K,!0),m(C,""),m(e,(await J(j.getPool(t(W))))()),t(e).instances||U(e,t(e).instances=[])}catch(d){m(C,V(d))}finally{m(K,!1)}}async function _e(d){if(t(e))try{const o=(await J(j.updatePool(t(e).id,d)))();m(e,o),m(R,!1),N.success("Pool Updated",`Pool ${t(e).id} has been updated successfully.`)}catch(o){const D=V(o);N.error("Update Failed",D)}}async function ye(){if(t(e)){try{(await J(j.deletePool(t(e).id)))(),ve(F("/pools"))}catch(d){const o=V(d);N.error("Delete Failed",o)}m(B,!1)}}async function be(){if(t(h)){try{(await J(j.deleteInstance(t(h).name)))(),N.success("Instance Deleted",`Instance ${t(h).name} has been deleted successfully.`)}catch(d){const o=V(d);N.error("Delete Failed",o)}m(L,!1),m(h,null)}}function he(d){m(h,d),m(L,!0)}function ke(d){if(!d)return"{}";try{if(p(typeof d,"string")){const o=JSON.parse(d);return JSON.stringify(o,null,2)}return JSON.stringify(d,null,2)}catch{return d.toString()}}function we(d){if(p(d.operation,"update")){const o=d.payload;t(e)&&p(o.id,t(e).id)&&m(e,o)}else if(p(d.operation,"delete")){const o=d.payload.id||d.payload;t(e)&&p(t(e).id,o)&&ve(F("/pools"))}}function De(d){if(!t(e))return;const o=d.payload;if(!p(o.pool_id,t(e).id,!1)){if(t(e).instances||U(e,t(e).instances=[]),p(d.operation,"create"))U(e,t(e).instances=[...t(e).instances,o]);else if(p(d.operation,"update"))U(e,t(e).instances=t(e).instances.map(D=>p(D.id,o.id)?o:D));else if(p(d.operation,"delete")){const D=o.id||o;U(e,t(e).instances=t(e).instances.filter(Z=>p(Z.id,D,!1)))}m(e,t(e))}}va(()=>{fe();const d=ce.subscribeToEntity("pool",["update","delete"],we),o=ce.subscribeToEntity("instance",["create","update","delete"],De);O=()=>{d(),o()}}),ma(()=>{O&&(O(),O=null)}),ca(()=>le,()=>{m(W,le.params.id)}),xa(),na();var It=Ea();ia(d=>{P(()=>ga.title=`${t(e),i(()=>t(e)?`Pool ${t(e).id} - Pool Details`:"Pool Details")??""} - GARM`)});var Q=H(It),X=r(Q),Pt=r(X),Y=r(Pt),Ie=r(Y);a(Y);var $t=s(Y,2),Mt=r($t),Tt=s(r(Mt),2),Pe=r(Tt,!0);a(Tt),a(Mt),a($t),a(Pt),a(X);var $e=s(X,2);{var Me=d=>{var o=ka();f(d,o)},Te=d=>{var o=oe(),D=H(o);{var Z=T=>{var E=wa(),G=r(E),tt=r(G,!0);a(G),a(E),P(()=>l(tt,t(C))),f(T,E)},Ue=T=>{var E=oe(),G=H(E);{var tt=et=>{var At=Ta(),St=H(At);{let v=S(()=>(_(A),t(e),i(()=>A(t(e))))),c=S(()=>(_(q),t(e),i(()=>q(t(e))))),u=S(()=>(_(ue),t(e),i(()=>ue(t(e).endpoint?.endpoint_type||"unknown"))));x(()=>ba(St,{get title(){return t(e),i(()=>t(e).id)},get subtitle(){return`Pool for ${t(v)??""} (${t(c)??""})`},get forgeIcon(){return t(u)},onEdit:()=>m(R,!0),onDelete:()=>m(B,!0)}),"component",n,241,2,{componentTag:"DetailHeader"})}var at=s(St,2),rt=r(at),Ut=r(rt),Nt=s(r(Ut),2),dt=r(Nt),Ct=s(r(dt),2),Ne=r(Ct,!0);a(Ct),a(dt);var st=s(dt,2),Rt=s(r(st),2),Ce=r(Rt,!0);a(Rt),a(st);var it=s(st,2),Bt=s(r(it),2),Re=r(Bt);x(()=>ha(Re,{get item(){return t(e)}}),"component",n,267,8,{componentTag:"ForgeTypeCell"}),a(Bt),a(it);var ot=s(it,2),Lt=s(r(ot),2),Ot=r(Lt),Be=r(Ot,!0);a(Ot),a(Lt),a(ot);var nt=s(ot,2),Gt=s(r(nt),2),Le=r(Gt,!0);a(Gt),a(nt);var lt=s(nt,2),Ht=s(r(lt),2),vt=r(Ht),Oe=r(vt,!0);a(vt),a(Ht),a(lt);var mt=s(lt,2),Jt=s(r(mt),2),jt=r(Jt),ct=r(jt),Ge=r(ct,!0);a(ct);var xt=s(ct,2),He=r(xt,!0);a(xt),a(jt),a(Jt),a(mt);var ut=s(mt,2),qt=s(r(ut),2),Je=r(qt,!0);a(qt),a(ut);var zt=s(ut,2),Vt=s(r(zt),2),je=r(Vt,!0);a(Vt),a(zt),a(Nt),a(Ut),a(rt);var Wt=s(rt,2),Kt=r(Wt),Qt=s(r(Kt),2),gt=r(Qt),Xt=s(r(gt),2),qe=r(Xt,!0);a(Xt),a(gt);var pt=s(gt,2),Yt=s(r(pt),2),ze=r(Yt,!0);a(Yt),a(pt);var ft=s(pt,2),Zt=s(r(ft),2),Ve=r(Zt);a(Zt),a(ft);var _t=s(ft,2),te=s(r(_t),2),We=r(te,!0);a(te),a(_t);var yt=s(_t,2),ee=s(r(yt),2),Ke=r(ee,!0);a(ee),a(yt);var bt=s(yt,2),ae=s(r(bt),2),Qe=r(ae);a(ae),a(bt);var ht=s(bt,2),re=s(r(ht),2),kt=r(re),Xe=r(kt,!0);a(kt),a(re),a(ht);var de=s(ht,2);{var Ye=v=>{var c=Da(),u=s(r(c),2),g=r(u),M=r(g,!0);a(g),a(u),a(c),P(I=>{Dt(g,"href",I),l(M,(t(e),i(()=>t(e).template_name)))},[()=>(_(F),t(e),i(()=>F(`/templates/${t(e).template_id}`)))]),f(v,c)};x(()=>y(de,v=>{t(e),i(()=>t(e).template_name)&&v(Ye)}),"if",n,350,6)}var se=s(de,2);{var Ze=v=>{var c=Ia(),u=s(r(c),2),g=r(u,!0);a(u),a(c),P(()=>l(g,(t(e),i(()=>t(e)["github-runner-group"])))),f(v,c)};x(()=>y(se,v=>{t(e),i(()=>t(e)["github-runner-group"])&&v(Ze)}),"if",n,360,6)}var ta=s(se,2);{var ea=v=>{var c=$a(),u=s(r(c),2),g=r(u);x(()=>pa(g,5,()=>(t(e),i(()=>t(e).tags)),fa,(M,I)=>{var wt=Pa(),da=r(wt,!0);a(wt),P(()=>l(da,(t(I),i(()=>p(typeof t(I),"string")?t(I):t(I).name)))),f(M,wt)}),"each",n,371,10),a(g),a(u),a(c),f(v,c)};x(()=>y(ta,v=>{t(e),i(()=>t(e).tags&&t(e).tags.length>0)&&v(ea)}),"if",n,366,6)}a(Qt),a(Kt),a(Wt),a(at);var ie=s(at,2);{var aa=v=>{var c=Ma(),u=r(c),g=s(r(u),2),M=r(g,!0);a(g),a(u),a(c),P(I=>l(M,I),[()=>(t(e),i(()=>ke(t(e).extra_specs)))]),f(v,c)};x(()=>y(ie,v=>{t(e),i(()=>t(e).extra_specs)&&v(aa)}),"if",n,386,2)}var ra=s(ie,2);{let v=S(()=>(t(e),i(()=>t(e).instances||[])));x(()=>ya(ra,{get instances(){return t(v)},entityType:"pool",onDeleteInstance:he}),"component",n,396,2,{componentTag:"InstancesSection"})}P((v,c,u,g,M)=>{l(Ne,(t(e),i(()=>t(e).id))),l(Ce,(t(e),i(()=>t(e).provider_name))),l(Be,(t(e),i(()=>t(e).image))),l(Le,(t(e),i(()=>t(e).flavor))),ne(vt,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enabled?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200")??""}`),l(Oe,(t(e),i(()=>t(e).enabled?"Enabled":"Disabled"))),l(Ge,v),Dt(xt,"href",c),l(He,u),l(Je,g),l(je,M),l(qe,(t(e),i(()=>t(e).max_runners))),l(ze,(t(e),i(()=>t(e).min_idle_runners))),l(Ve,`${t(e),i(()=>t(e).runner_bootstrap_timeout)??""} minutes`),l(We,(t(e),i(()=>t(e).priority))),l(Ke,(t(e),i(()=>t(e).runner_prefix||"garm"))),l(Qe,`${t(e),i(()=>t(e).os_type)??""} / ${t(e),i(()=>t(e).os_arch)??""}`),ne(kt,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enable_shell?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200")??""}`),l(Xe,(t(e),i(()=>t(e).enable_shell?"Enabled":"Disabled")))},[()=>(_(q),t(e),i(()=>q(t(e)))),()=>(_(xe),t(e),i(()=>xe(t(e)))),()=>(_(A),t(e),i(()=>A(t(e)))),()=>(_(z),t(e),i(()=>z(t(e).created_at||""))),()=>(_(z),t(e),i(()=>z(t(e).updated_at||"")))]),f(et,At)};x(()=>y(G,et=>{t(e)&&et(tt)},!0),"if",n,239,1)}f(T,E)};x(()=>y(D,T=>{t(C)?T(Z):T(Ue,!1)},!0),"if",n,235,1)}f(d,o)};x(()=>y($e,d=>{t(K)?d(Me):d(Te,!1)}),"if",n,230,1)}a(Q);var Et=s(Q,2);{var Ee=d=>{x(()=>_a(d,{get pool(){return t(e)},$$events:{close:()=>m(R,!1),submit:o=>_e(o.detail)}}),"component",n,403,1,{componentTag:"UpdatePoolModal"})};x(()=>y(Et,d=>{t(R)&&t(e)&&d(Ee)}),"if",n,402,0)}var Ft=s(Et,2);{var Fe=d=>{{let o=S(()=>(t(e),_(A),i(()=>`Pool ${t(e).id} (${A(t(e))})`)));x(()=>me(d,{title:"Delete Pool",message:"Are you sure you want to delete this pool? This action cannot be undone and will remove all associated runners.",get itemName(){return t(o)},$$events:{close:()=>m(B,!1),confirm:ye}}),"component",n,411,1,{componentTag:"DeleteModal"})}};x(()=>y(Ft,d=>{t(B)&&t(e)&&d(Fe)}),"if",n,410,0)}var Ae=s(Ft,2);{var Se=d=>{x(()=>me(d,{title:"Delete Instance",message:"Are you sure you want to delete this instance? This action cannot be undone.",get itemName(){return t(h),i(()=>t(h).name)},$$events:{close:()=>{m(L,!1),m(h,null)},confirm:be}}),"component",n,421,1,{componentTag:"DeleteModal"})};x(()=>y(Ae,d=>{t(L)&&t(h)&&d(Se)}),"if",n,420,0)}return P(d=>{Dt(Ie,"href",d),l(Pe,(t(e),i(()=>t(e)?t(e).id:"Loading...")))},[()=>(_(F),i(()=>F("/pools")))]),f(ge,It),ua({...oa()})}export{n as component};
