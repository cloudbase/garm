import"../chunks/DsnmJJEf.js";import{i as ea}from"../chunks/De-I_rkH.js";import{p as aa,o as ra,B as da,l as sa,h as ia,f as _,j as la,a as T,t as h,b as u,c as na,u as i,q as g,e as n,g as t,m as b,d as a,s,k as v,$ as oa,r,w as A,A as yt,v as $}from"../chunks/BIqNNOMq.js";import{i as f}from"../chunks/CfI2BFUj.js";import{d as k,c as L,g as O,s as ae}from"../chunks/CQh-7xkh.js";import{p as re}from"../chunks/B-zJt1QP.js";import{g as de}from"../chunks/BSYpqPvJ.js";import{U as va}from"../chunks/If6x_I-9.js";import{D as se}from"../chunks/Db7N5hjl.js";import{I as ca}from"../chunks/DAaZIIvX.js";import{D as ma}from"../chunks/CIekn_9e.js";import{w as ie}from"../chunks/C4VNo_Nu.js";import{t as H}from"../chunks/DgRPqjXE.js";import{e as le}from"../chunks/BZiHL9L3.js";import{e as E,i as J,j as ne,b as P,g as oe}from"../chunks/B7If18kh.js";import{F as xa}from"../chunks/BLWgJqKz.js";var ua=_('<div class="p-6 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading scale set...</p></div>'),ga=_('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),fa=_('<a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a>'),pa=_('<a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a>'),_a=_('<span class="text-sm text-gray-500 dark:text-gray-400">Default system template</span>'),ya=_('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">GitHub Runner Group</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div>'),ha=_('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Extra Specifications</h2> <pre class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md overflow-x-auto text-sm text-gray-900 dark:text-white font-mono"> </pre></div></div>'),ba=_('<!> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Basic Information</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Scale Set ID</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Name</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white font-medium"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Provider</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Forge Type</dt> <dd class="mt-1"><!></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Image</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"><code class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs"> </code></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Flavor</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Status</dt> <dd class="mt-1"><span> </span></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Entity</dt> <dd class="mt-1"><div class="flex items-center space-x-2"><span class="inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"> </span> <a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></div></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Configuration</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Max Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Min Idle Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Bootstrap Timeout</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Prefix</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">OS Type / Architecture</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Shell Access</dt> <dd class="mt-1"><span> </span></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Install Template</dt> <dd class="mt-1"><!></dd></div> <!></dl></div></div></div> <!> <!>',1),ka=_('<div class="space-y-6"><nav class="flex" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg> Scale Sets</a></li> <li><div class="flex items-center"><svg class="w-3 h-3 text-gray-400 mx-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"> </span></div></li></ol></nav> <!></div> <!> <!> <!>',1);function La(ve,ce){aa(ce,!1);const N=b();let e=b(null),j=b(!0),F=b(""),R=b(!1),U=b(!1),B=b(!1),p=b(null),C=null;async function ht(){if(!(!t(N)||isNaN(t(N))))try{v(j,!0),v(F,""),v(e,await O.getScaleSet(t(N))),t(e).instances||A(e,t(e).instances=[])}catch(d){v(F,d instanceof Error?d.message:"Failed to load scale set")}finally{v(j,!1)}}async function me(d){if(t(e))try{await O.updateScaleSet(t(e).id,d),await ht(),H.success("Scale Set Updated",`Scale Set ${t(e).name} has been updated successfully.`),v(R,!1)}catch(l){throw l}}async function xe(){if(t(e)){try{await O.deleteScaleSet(t(e).id),de(k("/scalesets"))}catch(d){const l=le(d);H.error("Delete Failed",l)}v(U,!1)}}async function ue(){if(t(p)){try{await O.deleteInstance(t(p).name),H.success("Instance Deleted",`Instance ${t(p).name} has been deleted successfully.`)}catch(d){const l=le(d);H.error("Delete Failed",l)}v(B,!1),v(p,null)}}function ge(d){v(p,d),v(B,!0)}function fe(d){if(!d)return"{}";try{if(typeof d=="string"){const l=JSON.parse(d);return JSON.stringify(l,null,2)}return JSON.stringify(d,null,2)}catch{return d.toString()}}function pe(d){if(d.operation==="update"){const l=d.payload;t(e)&&l.id===t(e).id&&v(e,l)}else if(d.operation==="delete"){const l=d.payload.id||d.payload;t(e)&&t(e).id===l&&de(k("/scalesets"))}}function _e(d){if(!t(e))return;const l=d.payload;if(l.scale_set_id===t(e).id){if(t(e).instances||A(e,t(e).instances=[]),d.operation==="create")A(e,t(e).instances=[...t(e).instances,l]);else if(d.operation==="update")A(e,t(e).instances=t(e).instances.map(S=>S.id===l.id?l:S));else if(d.operation==="delete"){const S=l.id||l;A(e,t(e).instances=t(e).instances.filter(W=>W.id!==S))}v(e,t(e))}}ra(()=>{ht();const d=ie.subscribeToEntity("scaleset",["update","delete"],pe),l=ie.subscribeToEntity("instance",["create","update","delete"],_e);C=()=>{d(),l()}}),da(()=>{C&&(C(),C=null)}),sa(()=>re,()=>{v(N,parseInt(re.params.id||"0"))}),ia(),ea();var bt=ka();la(d=>{h(()=>oa.title=`${t(e),i(()=>t(e)?`${t(e).name} - Scale Set Details`:"Scale Set Details")??""} - GARM`)});var q=T(bt),z=a(q),kt=a(z),V=a(kt),ye=a(V);r(V);var St=s(V,2),wt=a(St),It=s(a(wt),2),he=a(It,!0);r(It),r(wt),r(St),r(kt),r(z);var be=s(z,2);{var ke=d=>{var l=ua();u(d,l)},Se=d=>{var l=yt(),S=T(l);{var W=w=>{var I=ga(),G=a(I),K=a(G,!0);r(G),r(I),h(()=>n(K,t(F))),u(w,I)},Ee=w=>{var I=yt(),G=T(I);{var K=Q=>{var Et=ba(),Mt=T(Et);{let o=$(()=>(t(e),i(()=>t(e).name||"Scale Set"))),c=$(()=>(g(E),t(e),i(()=>E(t(e))))),m=$(()=>(g(J),t(e),i(()=>J(t(e))))),x=$(()=>(g(oe),i(()=>oe("github"))));ma(Mt,{get title(){return t(o)},get subtitle(){return`Scale set for ${t(c)??""} (${t(m)??""}) â€¢ GitHub Runner Scale Set`},get forgeIcon(){return t(x)},onEdit:()=>v(R,!0),onDelete:()=>v(U,!0)})}var X=s(Mt,2),Y=a(X),Tt=a(Y),At=s(a(Tt),2),Z=a(At),Nt=s(a(Z),2),Me=a(Nt,!0);r(Nt),r(Z);var tt=s(Z,2),Ft=s(a(tt),2),Te=a(Ft,!0);r(Ft),r(tt);var et=s(tt,2),Rt=s(a(et),2),Ae=a(Rt,!0);r(Rt),r(et);var at=s(et,2),Ut=s(a(at),2),Ne=a(Ut);xa(Ne,{get item(){return t(e)}}),r(Ut),r(at);var rt=s(at,2),Bt=s(a(rt),2),Ct=a(Bt),Fe=a(Ct,!0);r(Ct),r(Bt),r(rt);var dt=s(rt,2),Gt=s(a(dt),2),Re=a(Gt,!0);r(Gt),r(dt);var st=s(dt,2),Lt=s(a(st),2),it=a(Lt),Ue=a(it,!0);r(it),r(Lt),r(st);var lt=s(st,2),Ot=s(a(lt),2),Ht=a(Ot),nt=a(Ht),Be=a(nt,!0);r(nt);var ot=s(nt,2),Ce=a(ot,!0);r(ot),r(Ht),r(Ot),r(lt);var vt=s(lt,2),Jt=s(a(vt),2),Ge=a(Jt,!0);r(Jt),r(vt);var Pt=s(vt,2),jt=s(a(Pt),2),Le=a(jt,!0);r(jt),r(Pt),r(At),r(Tt),r(Y);var qt=s(Y,2),zt=a(qt),Vt=s(a(zt),2),ct=a(Vt),Wt=s(a(ct),2),Oe=a(Wt,!0);r(Wt),r(ct);var mt=s(ct,2),Kt=s(a(mt),2),He=a(Kt,!0);r(Kt),r(mt);var xt=s(mt,2),Qt=s(a(xt),2),Je=a(Qt);r(Qt),r(xt);var ut=s(xt,2),Xt=s(a(ut),2),Pe=a(Xt,!0);r(Xt),r(ut);var gt=s(ut,2),Yt=s(a(gt),2),je=a(Yt);r(Yt),r(gt);var ft=s(gt,2),Zt=s(a(ft),2),pt=a(Zt),qe=a(pt,!0);r(pt),r(Zt),r(ft);var _t=s(ft,2),te=s(a(_t),2),ze=a(te);{var Ve=o=>{var c=fa(),m=a(c,!0);r(c),h(x=>{L(c,"href",x),n(m,(t(e),i(()=>t(e).template_name)))},[()=>(g(k),t(e),i(()=>k(`/templates/${t(e).template_id}`)))]),u(o,c)},We=o=>{var c=yt(),m=T(c);{var x=y=>{var D=pa(),Ze=a(D);r(D),h(ta=>{L(D,"href",ta),n(Ze,`Template ID: ${t(e),i(()=>t(e).template_id)??""}`)},[()=>(g(k),t(e),i(()=>k(`/templates/${t(e).template_id}`)))]),u(y,D)},M=y=>{var D=_a();u(y,D)};f(m,y=>{t(e),i(()=>t(e).template_id)?y(x):y(M,!1)},!0)}u(o,c)};f(ze,o=>{t(e),i(()=>t(e).template_name)?o(Ve):o(We,!1)})}r(te),r(_t);var Ke=s(_t,2);{var Qe=o=>{var c=ya(),m=s(a(c),2),x=a(m,!0);r(m),r(c),h(()=>n(x,(t(e),i(()=>t(e)["github-runner-group"])))),u(o,c)};f(Ke,o=>{t(e),i(()=>t(e)["github-runner-group"])&&o(Qe)})}r(Vt),r(zt),r(qt),r(X);var ee=s(X,2);{var Xe=o=>{var c=ha(),m=a(c),x=s(a(m),2),M=a(x,!0);r(x),r(m),r(c),h(y=>n(M,y),[()=>(t(e),i(()=>fe(t(e).extra_specs)))]),u(o,c)};f(ee,o=>{t(e),i(()=>t(e).extra_specs)&&o(Xe)})}var Ye=s(ee,2);{let o=$(()=>(t(e),i(()=>t(e).instances||[])));ca(Ye,{get instances(){return t(o)},entityType:"scaleset",onDeleteInstance:ge})}h((o,c,m,x,M)=>{n(Me,(t(e),i(()=>t(e).id))),n(Te,(t(e),i(()=>t(e).name))),n(Ae,(t(e),i(()=>t(e).provider_name))),n(Fe,(t(e),i(()=>t(e).image))),n(Re,(t(e),i(()=>t(e).flavor))),ae(it,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enabled?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200")??""}`),n(Ue,(t(e),i(()=>t(e).enabled?"Enabled":"Disabled"))),n(Be,o),L(ot,"href",c),n(Ce,m),n(Ge,x),n(Le,M),n(Oe,(t(e),i(()=>t(e).max_runners))),n(He,(t(e),i(()=>t(e).min_idle_runners))),n(Je,`${t(e),i(()=>t(e).runner_bootstrap_timeout)??""} minutes`),n(Pe,(t(e),i(()=>t(e).runner_prefix||"garm"))),n(je,`${t(e),i(()=>t(e).os_type)??""} / ${t(e),i(()=>t(e).os_arch)??""}`),ae(pt,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enable_shell?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200")??""}`),n(qe,(t(e),i(()=>t(e).enable_shell?"Enabled":"Disabled")))},[()=>(g(J),t(e),i(()=>J(t(e)))),()=>(g(ne),t(e),i(()=>ne(t(e)))),()=>(g(E),t(e),i(()=>E(t(e)))),()=>(g(P),t(e),i(()=>P(t(e).created_at||""))),()=>(g(P),t(e),i(()=>P(t(e).updated_at||"")))]),u(Q,Et)};f(G,Q=>{t(e)&&Q(K)},!0)}u(w,I)};f(S,w=>{t(F)?w(W):w(Ee,!1)},!0)}u(d,l)};f(be,d=>{t(j)?d(ke):d(Se,!1)})}r(q);var Dt=s(q,2);{var we=d=>{va(d,{get scaleSet(){return t(e)},$$events:{close:()=>v(R,!1),submit:l=>me(l.detail)}})};f(Dt,d=>{t(R)&&t(e)&&d(we)})}var $t=s(Dt,2);{var Ie=d=>{{let l=$(()=>(t(e),g(E),i(()=>`Scale Set ${t(e).name} (${E(t(e))})`)));se(d,{title:"Delete Scale Set",message:"Are you sure you want to delete this scale set? This action cannot be undone and will remove all associated runners.",get itemName(){return t(l)},$$events:{close:()=>v(U,!1),confirm:xe}})}};f($t,d=>{t(U)&&t(e)&&d(Ie)})}var De=s($t,2);{var $e=d=>{se(d,{title:"Delete Instance",message:"Are you sure you want to delete this instance? This action cannot be undone.",get itemName(){return t(p),i(()=>t(p).name)},$$events:{close:()=>{v(B,!1),v(p,null)},confirm:ue}})};f(De,d=>{t(B)&&t(p)&&d($e)})}h(d=>{L(ye,"href",d),n(he,(t(e),i(()=>t(e)?t(e).name:"Loading...")))},[()=>(g(k),i(()=>k("/scalesets")))]),u(ve,bt),na()}export{La as component};
