import{c as Nt,a as F,e as x,h as Ht,b as I,l as Kt,s as ae,f as j,r as st}from"../chunks/CxOx-TIJ.js";import{i as Vt}from"../chunks/3NxSoY2_.js";import{p as Rt,g as e,o as Yt,l as ee,b as Ot,f as ze,d as m,a as Jt,$ as Qt,c as o,s as r,e as Je,r as i,u as g,h as he,i as l,t as fe,m as y,F as $,j as n,k as w,n as re,q as Wt,v as Xt,w as oe}from"../chunks/DzFKsO_V.js";import{s as Zt,a as ea,i as S,v as ta}from"../chunks/B_jyf0qs.js";import{e as aa,i as ra}from"../chunks/CdXRaxkX.js";import{h as oa,r as R,s as Se,b as ia,a as na,g as ke}from"../chunks/BguOOs3x.js";import{b as Y,a as da}from"../chunks/BVM1034P.js";import{p as lt}from"../chunks/CdEA5IGF.js";import{l as ct}from"../chunks/BAcG6-Ep.js";import{P as sa}from"../chunks/DTko0dwG.js";import{F as la}from"../chunks/DvQW-lMP.js";import{A as ut}from"../chunks/Ct5kWObc.js";import{D as ca,E as ua,G as pa,a as ga,S as fa,A as ya}from"../chunks/C2FKJqnN.js";import{e as pt,a as Qe}from"../chunks/Penjr-j0.js";import{t as $e}from"../chunks/li_-Mkq2.js";import{g as We,c as ba,f as va,p as ma}from"../chunks/JkzpcrZD.js";import{e as Xe}from"../chunks/BZiHL9L3.js";import{B as gt}from"../chunks/1CdJgrM6.js";d[$]="src/routes/credentials/+page.svelte";var xa=F(j('<div class="flex items-center justify-between"><div class="flex-1 min-w-0"><div class="block"><p class="text-sm font-medium text-gray-900 dark:text-white truncate"> </p> <p class="text-sm text-gray-500 dark:text-gray-400 truncate mt-1"> </p> <div class="flex items-center mt-2 space-x-3"><div class="flex items-center"><!> <span class="ml-1 text-xs text-gray-500 dark:text-gray-400"> </span></div></div></div></div> <div class="flex items-center space-x-3 ml-4"><!> <div class="flex space-x-2"><!> <!></div></div></div>'),d[$],[[567,3,[[568,4,[[569,5,[[570,6],[573,6],[576,6,[[577,7,[[579,8]]]]]]]]],[584,4,[[590,5]]]]]]),_a=F(j("<option> </option>"),d[$],[[684,7]]),ha=F(j('<p class="text-xs text-gray-500 dark:text-gray-400 mt-1"> </p>'),d[$],[[690,6]]),ka=F(j('<p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Gitea only supports PAT authentication</p>'),d[$],[[727,6]]),wa=F(j('<div><label for="oauth2_token" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Personal Access Token <span class="text-red-500">*</span></label> <input type="password" id="oauth2_token" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx"/></div>'),d[$],[[733,5,[[734,6,[[735,29]]],[737,6]]]]),Ca=F(j('<div><label for="app_id" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">App ID <span class="text-red-500">*</span></label> <input type="text" id="app_id" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="123456"/></div> <div><label for="installation_id" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">App Installation ID <span class="text-red-500">*</span></label> <input type="text" id="installation_id" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="12345678"/></div> <div><label for="private_key" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Private Key <span class="text-red-500">*</span></label> <div class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center hover:border-blue-400 dark:hover:border-blue-400 transition-colors"><input type="file" id="private_key" accept=".pem,.key" class="hidden"/> <div class="space-y-2"><svg class="mx-auto h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-sm text-gray-600 dark:text-gray-400"><button type="button" class="text-gray-900 dark:text-white hover:text-gray-700 dark:hover:text-gray-300 hover:underline cursor-pointer">Choose a file</button> or drag and drop</p> <p class="text-xs text-gray-500 dark:text-gray-400">PEM, KEY files only</p></div></div></div>',1),d[$],[[751,5,[[752,6,[[753,14]]],[755,6]]],[766,5,[[767,6,[[768,27]]],[770,6]]],[781,5,[[782,6,[[783,19]]],[785,6,[[786,7],[793,7,[[794,8,[[795,9]]],[797,8,[[798,9]]],[803,8]]]]]]]]),Pa=F(j('<div class="fixed inset-0 flex items-center justify-center z-50" role="dialog" aria-modal="true"><button class="fixed inset-0 w-full h-full bg-black/30 dark:bg-black/50 cursor-default" aria-label="Close modal"></button> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 max-h-screen overflow-y-auto relative z-10" role="document"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"><div><h3 class="text-lg font-semibold text-gray-900 dark:text-white">Add Credentials</h3> <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Create new authentication credentials</p></div> <button class="text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100 cursor-pointer" aria-label="Close modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-6 space-y-4"><!> <div><label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Credentials Name <span class="text-red-500">*</span></label> <input type="text" id="name" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="e.g., my-github-credentials"/></div> <div><label for="description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label> <textarea id="description" rows="2" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Brief description of these credentials"></textarea></div> <div><label for="endpoint" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Endpoint <span class="text-red-500">*</span></label> <select id="endpoint" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"><option>Select an endpoint</option><!></select> <!></div> <div role="group" aria-labelledby="auth-type-heading"><div id="auth-type-heading" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Authentication Type <span class="text-red-500">*</span></div> <div class="flex space-x-4"><button type="button">PAT</button> <button type="button">App</button></div> <!></div> <!> <!> <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 cursor-pointer">Cancel</button> <button type="submit">Create Credentials</button></div></form></div></div>'),d[$],[[616,1,[[617,2],[618,2,[[619,3,[[620,4,[[621,5],[624,5]]],[628,4,[[629,5,[[630,6]]]]]]],[635,4,[[642,5,[[643,6,[[644,24]]],[646,6]]],[657,4,[[658,5],[661,5]]],[671,4,[[672,5,[[673,15]]],[675,5,[[682,6]]]]],[697,4,[[698,5,[[699,26]]],[701,5,[[702,6],[713,6]]]]],[809,4,[[810,5],[817,5]]]]]]]]]]),Aa=F(j('<div><label for="edit_oauth2_token" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">New Personal Access Token <span class="text-red-500">*</span></label> <input type="password" id="edit_oauth2_token" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Enter new token"/></div>'),d[$],[[927,6,[[928,7,[[929,34]]],[931,7]]]]),Ta=F(j('<div><label for="edit_app_id" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">App ID <span class="text-red-500">*</span></label> <input type="text" id="edit_app_id" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Enter new App ID"/></div> <div><label for="edit_installation_id" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">App Installation ID <span class="text-red-500">*</span></label> <input type="text" id="edit_installation_id" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Enter new Installation ID"/></div> <div><label for="edit_private_key" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Private Key <span class="text-red-500">*</span></label> <div class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center hover:border-blue-400 dark:hover:border-blue-400 transition-colors"><input type="file" id="edit_private_key" accept=".pem,.key" class="hidden"/> <div class="space-y-2"><svg class="mx-auto h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-sm text-gray-600 dark:text-gray-400"><button type="button" class="text-gray-900 dark:text-white hover:text-gray-700 dark:hover:text-gray-300 hover:underline cursor-pointer">Choose a new file</button> or drag and drop</p> <p class="text-xs text-gray-500 dark:text-gray-400">PEM, KEY files only. Upload new private key.</p></div></div></div>',1),d[$],[[945,6,[[946,7,[[947,15]]],[949,7]]],[960,6,[[961,7,[[962,28]]],[964,7]]],[975,6,[[976,7,[[977,20]]],[979,7,[[980,8],[987,8,[[988,9,[[989,10]]],[991,9,[[992,10]]],[997,9]]]]]]]]),$a=F(j("<!> <!>",1),d[$],[]),Ea=F(j('<div class="fixed inset-0 flex items-center justify-center z-50" role="dialog" aria-modal="true"><button class="fixed inset-0 w-full h-full bg-black/30 dark:bg-black/50 cursor-default" aria-label="Close modal"></button> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto relative z-10" role="document"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"><div><h3 class="text-lg font-semibold text-gray-900 dark:text-white">Edit Credentials</h3> <p class="text-sm text-gray-600 dark:text-gray-400 mt-1"> </p></div> <button class="text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100 cursor-pointer" aria-label="Close modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-6 space-y-4"><div><label for="edit_name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Credentials Name <span class="text-red-500">*</span></label> <input type="text" id="edit_name" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <div><label for="edit_description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label> <textarea id="edit_description" rows="2" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"></textarea></div> <div><label for="edit-endpoint" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Endpoint</label> <input type="text" id="edit-endpoint" disabled class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"/> <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Endpoint cannot be changed after creation</p></div> <div><span class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Authentication Type</span> <div class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-600"><span class="text-sm font-medium text-gray-700 dark:text-gray-300"> </span></div> <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Authentication type cannot be changed after creation</p></div> <div class="border-t border-gray-200 dark:border-gray-700 pt-4"><div class="flex items-center"><input id="change_credentials_checkbox" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="change_credentials_checkbox" class="ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300">I want to change credentials</label></div> <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Check this box to update authentication credentials</p></div> <!> <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 cursor-pointer">Cancel</button> <button type="submit">Update Credentials</button></div></form></div></div>'),d[$],[[833,1,[[834,2],[835,2,[[836,3,[[837,4,[[838,5],[841,5]]],[845,4,[[846,5,[[847,6]]]]]]],[852,3,[[853,4,[[854,5,[[855,23]]],[857,5]]],[867,4,[[868,5],[871,5]]],[880,4,[[881,5],[884,5],[891,5]]],[895,4,[[896,5],[899,5,[[900,6]]],[904,5]]],[908,4,[[909,5,[[910,6],[916,6]]],[920,5]]],[1004,4,[[1005,5],[1012,5]]]]]]]]]]),Da=F(j('<div class="fixed inset-0 flex items-center justify-center z-50" role="dialog" aria-modal="true"><button class="fixed inset-0 w-full h-full bg-black/30 dark:bg-black/50 cursor-default" aria-label="Close modal"></button> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-xl w-full mx-4 relative z-10" role="document"><div class="px-6 py-4"><div class="flex items-center"><div class="flex-shrink-0"><svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div> <div class="ml-3"><h3 class="text-lg font-medium text-gray-900 dark:text-white">Delete Credentials</h3> <p class="mt-2 text-sm text-gray-500 dark:text-gray-300"> </p></div></div></div> <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 cursor-pointer">Cancel</button> <button type="button" class="px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 cursor-pointer">Delete</button></div></div></div>'),d[$],[[1028,1,[[1029,2],[1030,2,[[1031,3,[[1032,4,[[1033,5,[[1034,6,[[1035,7]]]]],[1038,5,[[1039,6],[1040,6]]]]]]],[1046,3,[[1047,4],[1054,4]]]]]]]]),Ma=F(j('<div class="space-y-6"><!> <!></div> <!> <!> <!>',1),d[$],[[534,0]]);function d(ft,yt){Nt(new.target),Rt(yt,!1,d);const[bt,vt]=Zt(),L=()=>(ta(pt,"eagerCache"),ea(pt,"$eagerCache",bt)),Le=y(),ie=y(),Ze=y(),Ne=y(),He=y(),f={PAT:"pat",APP:"app"};let Ee=y(!0),ye=y([]),te=y([]),De=y(""),Me=y(""),O=y(1),be=y(25),ve=y(1),Ie=y(!1),Fe=y(!1),je=y(!1),B=y(f.PAT),b=y(null),G=y(null),t=y({name:"",description:"",endpoint:"",auth_type:f.PAT,oauth2_token:"",app_id:"",installation_id:"",private_key_bytes:""}),Be={...e(t)},ne=y(!1);function mt(a){l(a.key,"Escape")&&(e(Ie)||e(Fe)||e(je))&&E()}Yt(async()=>{try{n(Ee,!0);const[a,s]=(await re(Promise.all([Qe.getCredentials(),Qe.getEndpoints()])))();a&&Array.isArray(a)&&n(ye,a),s&&Array.isArray(s)&&n(te,s)}catch(a){console.error(...ct("error","Failed to load credentials:",a)),n(De,a instanceof Error?a.message:"Failed to load credentials")}finally{n(Ee,!1)}});async function xt(){try{(await re(Qe.retryResource("credentials")))()}catch(a){console.error(...ct("error","Retry failed:",a))}}async function _t(){Re(),n(Ie,!0),n(k,"github"),w(t,e(t).auth_type=f.PAT)}let k=y("");function ht(a){n(k,a.detail),Re()}async function Ke(a){n(b,a),n(t,{name:a.name||"",description:a.description||"",endpoint:a.endpoint?.name||"",auth_type:a["auth-type"]||f.PAT,oauth2_token:"",app_id:"",installation_id:"",private_key_bytes:""}),n(B,a["auth-type"]||f.PAT),Be={...e(t)},n(ne,!1),n(Fe,!0)}function Ve(a){n(G,a),n(je,!0)}function Re(){n(t,{name:"",description:"",endpoint:"",auth_type:f.PAT,oauth2_token:"",app_id:"",installation_id:"",private_key_bytes:""}),Be={...e(t)},n(B,f.PAT),n(ne,!1)}function E(){n(Ie,!1),n(Fe,!1),n(je,!1),n(b,null),n(G,null),n(k,""),Re()}function et(a){n(B,a),w(t,e(t).auth_type=a)}function kt(){const a={};if(l(e(t).name,Be.name,!1)&&l(e(t).name.trim(),"",!1)&&(a.name=e(t).name.trim()),l(e(t).description,Be.description,!1)&&l(e(t).description.trim(),"",!1)&&(a.description=e(t).description.trim()),e(ne)&&e(b))if(l(e(b)["auth-type"],f.PAT))l(e(t).oauth2_token.trim(),"",!1)&&(a.pat={oauth2_token:e(t).oauth2_token.trim()});else{const s={};let v=!1;if(l(e(t).app_id.trim(),"",!1)&&(s.app_id=parseInt(e(t).app_id.trim()),v=!0),l(e(t).installation_id.trim(),"",!1)&&(s.installation_id=parseInt(e(t).installation_id.trim()),v=!0),l(e(t).private_key_bytes,"",!1))try{const _=atob(e(t).private_key_bytes);s.private_key_bytes=Array.from(_,u=>u.charCodeAt(0)),v=!0}catch{}v&&(a.app=s)}return a}async function wt(){try{if(l(e(k),"github")){const a={name:e(t).name.trim(),description:e(t).description.trim(),endpoint:e(t).endpoint.trim(),auth_type:e(t).auth_type};l(e(t).auth_type,f.PAT)?(a.pat={oauth2_token:e(t).oauth2_token.trim()},a.app={}):(a.app={app_id:parseInt(e(t).app_id.trim()),installation_id:parseInt(e(t).installation_id.trim()),private_key_bytes:Array.from(atob(e(t).private_key_bytes),s=>s.charCodeAt(0))},a.pat={}),(await re(ke.createGithubCredentials(a)))()}else if(l(e(k),"gitea")){const a={name:e(t).name.trim(),description:e(t).description.trim(),endpoint:e(t).endpoint.trim(),auth_type:f.PAT,pat:{oauth2_token:e(t).oauth2_token.trim()},app:{}};(await re(ke.createGiteaCredentials(a)))()}else throw new Error("Please select a forge type");$e.success("Credentials Created",`Credentials ${e(t).name} have been created successfully.`),E()}catch(a){n(De,Xe(a))}}async function Ct(){if(!(!e(b)||!e(b).id))try{const a=kt();if(l(Object.keys(a).length,0)){$e.info("No Changes","No fields were modified."),E();return}const s=e(b).forge_type;l(s,"github")?(await re(ke.updateGithubCredentials(e(b).id,a)))():(await re(ke.updateGiteaCredentials(e(b).id,a)))(),$e.success("Credentials Updated",`Credentials ${e(b)?.name||"Unknown"} have been updated successfully.`),E()}catch(a){n(De,Xe(a))}}async function Pt(){if(!(!e(G)||!e(G).id))try{const a=e(G).forge_type;l(a,"github")?(await re(ke.deleteGithubCredentials(e(G).id)))():(await re(ke.deleteGiteaCredentials(e(G).id)))(),$e.success("Credentials Deleted",`Credentials ${e(G)?.name||"Unknown"} have been deleted successfully.`)}catch(a){const s=Xe(a);$e.error("Delete Failed",s)}finally{E()}}function tt(a){const v=a.target.files?.[0];if(!v){w(t,e(t).private_key_bytes="");return}const _=new FileReader;_.onload=u=>{const C=u.target?.result;w(t,e(t).private_key_bytes=btoa(C))},_.readAsText(v)}function at(){return e(t).name.trim()?e(ne)&&e(b)?l(e(b)["auth-type"],f.PAT)?!!e(t).oauth2_token.trim():!!e(t).app_id.trim()&&!!e(t).installation_id.trim()&&!!e(t).private_key_bytes:!0:!1}function At(a){return e(te).find(v=>l(v.name,a))?.endpoint_type||""}function Tt(a){return l(At(a),"gitea")}const $t=[{key:"name",title:"Name",cellComponent:ua,cellProps:{field:"name",entityType:"credentials"}},{key:"description",title:"Description",cellComponent:pa,cellProps:{field:"description",type:"description"}},{key:"endpoint",title:"Endpoint",cellComponent:ga},{key:"auth_type",title:"Auth Type",cellComponent:fa,cellProps:{statusType:"custom",statusField:"auth-type"}},{key:"actions",title:"Actions",align:"right",cellComponent:ya}],Et={entityType:"credential",primaryText:{field:"name",isClickable:!0},secondaryText:{field:"description"},customInfo:[{icon:a=>We(a?.forge_type||"unknown"),text:a=>a?.endpoint?.name||"Unknown"}],badges:[{type:"auth",field:"auth-type"}],actions:[{type:"edit",handler:a=>Ke(a)},{type:"delete",handler:a=>Ve(a)}]};function Dt(a){n(Me,a.detail.term),n(O,1)}function Mt(a){n(O,a.detail.page)}function It(a){const s=ba(a.detail.perPage);n(be,s.newPerPage),n(O,s.newCurrentPage)}function Ft(a){Ke(a.detail.item)}function jt(a){Ve(a.detail.item)}ee(()=>(e(ye),L()),()=>{(!e(ye).length||L().loaded.credentials)&&n(ye,L().credentials)}),ee(()=>L(),()=>{n(Ee,L().loading.credentials)}),ee(()=>L(),()=>{n(Le,L().errorMessages.credentials)}),ee(()=>(e(te),L()),()=>{(!e(te).length||L().loaded.endpoints)&&n(te,L().endpoints)}),ee(()=>(e(ye),e(Me)),()=>{n(ie,va(e(ye),e(Me)))}),ee(()=>(e(ve),e(ie),e(be),e(O)),()=>{n(ve,Math.ceil(e(ie).length/e(be))),e(O)>e(ve)&&e(ve)>0&&n(O,e(ve))}),ee(()=>(e(ie),e(O),e(be)),()=>{n(Ze,ma(e(ie),e(O),e(be)))}),ee(()=>e(t),()=>{n(Ne,!e(t).name||!e(t).endpoint?!1:l(e(t).auth_type,f.PAT)?!!e(t).oauth2_token:!!e(t).app_id&&!!e(t).installation_id&&!!e(t).private_key_bytes)}),ee(()=>(e(k),e(te)),()=>{n(He,e(k)?e(te).filter(a=>l(a.endpoint_type,e(k))):e(te))}),Ot(),Vt();var rt=Ma();x("keydown",Wt,mt),Ht(a=>{Qt.title="Credentials - GARM"});var Ye=ze(rt),ot=o(Ye);m(()=>sa(ot,{title:"Credentials",description:"Manage authentication credentials for your GitHub and Gitea endpoints.",actionLabel:"Add Credentials",$$events:{action:_t}}),"component",d,536,1,{componentTag:"PageHeader"});var Bt=r(ot,2);{let a=Je(()=>e(Le)||e(De)),s=Je(()=>!!e(Le));m(()=>ca(Bt,{get columns(){return $t},get data(){return e(Ze)},get loading(){return e(Ee)},get error(){return e(a)},get searchTerm(){return e(Me)},searchPlaceholder:"Search credentials by name, description, or endpoint...",get currentPage(){return e(O)},get perPage(){return e(be)},get totalPages(){return e(ve)},get totalItems(){return e(ie),g(()=>e(ie).length)},itemName:"credentials",emptyIconType:"key",get showRetry(){return e(s)},get mobileCardConfig(){return Et},$$events:{search:Dt,pageChange:Mt,perPageChange:It,retry:xt,edit:Ft,delete:jt},$$slots:{"mobile-card":(v,_)=>{const u=Je(()=>_.item);var C=xa(),D=o(C),N=o(D),U=o(N),q=o(U,!0);i(U);var P=r(U,2),J=o(P,!0);i(P);var H=r(P,2),K=o(H),V=o(K);oa(V,()=>(he(We),he(e(u)),g(()=>We(e(u).forge_type||"unknown"))));var de=r(V,2),se=o(de,!0);i(de),i(K),i(H),i(N),i(D);var le=r(D,2),Q=o(le);{var ce=z=>{m(()=>gt(z,{variant:"success",text:"PAT"}),"component",d,586,6,{componentTag:"Badge"})},W=z=>{m(()=>gt(z,{variant:"info",text:"App"}),"component",d,588,6,{componentTag:"Badge"})};m(()=>S(Q,z=>{he(e(u)),g(()=>l(e(u)["auth-type"]||"pat","pat"))?z(ce):z(W,!1)}),"if",d,585,5)}var X=r(Q,2),ue=o(X);m(()=>ut(ue,{action:"edit",size:"sm",title:"Edit credentials",ariaLabel:"Edit credentials",$$events:{click:()=>Ke(e(u))}}),"component",d,591,6,{componentTag:"ActionButton"});var me=r(ue,2);m(()=>ut(me,{action:"delete",size:"sm",title:"Delete credentials",ariaLabel:"Delete credentials",$$events:{click:()=>Ve(e(u))}}),"component",d,598,6,{componentTag:"ActionButton"}),i(X),i(le),i(C),fe(()=>{ae(q,(he(e(u)),g(()=>e(u).name))),ae(J,(he(e(u)),g(()=>e(u).description))),ae(se,(he(e(u)),g(()=>e(u).endpoint?.name||"Unknown")))}),I(v,C)}}}),"component",d,543,1,{componentTag:"DataTable"})}i(Ye);var it=r(Ye,2);{var Gt=a=>{var s=Pa(),v=o(s),_=r(v,2),u=o(_),C=r(o(u),2);i(u);var D=r(u,2),N=o(D);m(()=>la(N,{get selectedForgeType(){return e(k)},set selectedForgeType(c){n(k,c)},$$events:{select:ht},$$legacy:!0}),"component",d,637,5,{componentTag:"ForgeTypeSelector"});var U=r(N,2),q=r(o(U),2);R(q),i(U);var P=r(U,2),J=r(o(P),2);st(J),i(P);var H=r(P,2),K=r(o(H),2);fe(()=>{e(t),Xt(()=>{e(He)})});var V=o(K);V.value=V.__value="";var de=r(V);m(()=>aa(de,1,()=>e(He),ra,(c,p)=>{var h=_a(),T=o(h);i(h);var M={};fe(()=>{ae(T,`${e(p),g(()=>e(p).name)??""} (${e(p),g(()=>e(p).endpoint_type)??""})`),M!==(M=(e(p),g(()=>e(p).name)))&&(h.value=(h.__value=(e(p),g(()=>e(p).name)))??"")}),I(c,h)}),"each",d,683,6),i(K);var se=r(K,2);{var le=c=>{var p=ha(),h=o(p);i(p),fe(()=>ae(h,`Showing only ${e(k)??""} endpoints`)),I(c,p)};m(()=>S(se,c=>{e(k)&&c(le)}),"if",d,689,5)}i(H);var Q=r(H,2),ce=r(o(Q),2),W=o(ce),X=r(W,2);i(ce);var ue=r(ce,2);{var me=c=>{var p=ka();I(c,p)};m(()=>S(ue,c=>{l(e(k),"gitea")&&c(me)}),"if",d,726,5)}i(Q);var z=r(Q,2);{var Ge=c=>{var p=wa(),h=r(o(p),2);R(h),i(p),Y(h,()=>e(t).oauth2_token,T=>w(t,e(t).oauth2_token=T)),I(c,p)};m(()=>S(z,c=>{e(B),g(()=>l(e(B),f.PAT))&&c(Ge)}),"if",d,732,4)}var we=r(z,2);{var Ue=c=>{var p=Ca(),h=ze(p),T=r(o(h),2);R(T),i(h);var M=r(h,2),Z=r(o(M),2);R(Z),i(M);var ge=r(M,2),xe=r(o(ge),2),Pe=o(xe),Ae=r(Pe,2),Te=r(o(Ae),2),qe=o(Te);oe(),i(Te),oe(2),i(Ae),i(xe),i(ge),Y(T,()=>e(t).app_id,_e=>w(t,e(t).app_id=_e)),Y(Z,()=>e(t).installation_id,_e=>w(t,e(t).installation_id=_e)),x("change",Pe,tt),x("click",qe,()=>document.getElementById("private_key")?.click()),I(c,p)};m(()=>S(we,c=>{e(B),g(()=>l(e(B),f.APP))&&c(Ue)}),"if",d,750,4)}var A=r(we,2),pe=o(A),Ce=r(pe,2);i(A),i(D),i(_),i(s),fe(c=>{Se(W,1,`flex-1 py-2 px-4 text-sm font-medium rounded-md border focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer
								${e(B),g(()=>l(e(B),f.PAT)?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600")??""}
								${c??""}`),X.disabled=l(e(k),"gitea"),Se(X,1,`flex-1 py-2 px-4 text-sm font-medium rounded-md border focus:outline-none focus:ring-2 focus:ring-blue-500
								${e(B),g(()=>l(e(B),f.APP)?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600")??""}
								${l(e(k),"gitea")?"opacity-50 cursor-not-allowed":"cursor-pointer"}`),Ce.disabled=!e(Ne),Se(Ce,1,`px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors
							${e(Ne)?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500 cursor-pointer":"bg-gray-400 cursor-not-allowed"}`)},[()=>(e(t),g(()=>(e(t).endpoint&&Tt(e(t).endpoint),"")))]),x("click",v,E),x("click",C,E),Y(q,()=>e(t).name,c=>w(t,e(t).name=c)),Y(J,()=>e(t).description,c=>w(t,e(t).description=c)),ia(K,()=>e(t).endpoint,c=>w(t,e(t).endpoint=c)),x("click",W,()=>et(f.PAT)),x("click",X,()=>et(f.APP)),x("click",pe,E),x("submit",D,lt(wt)),I(a,s)};m(()=>S(it,a=>{e(Ie)&&a(Gt)}),"if",d,615,0)}var nt=r(it,2);{var Ut=a=>{var s=Ea(),v=o(s),_=r(v,2),u=o(_),C=o(u),D=r(o(C),2),N=o(D);i(D),i(C);var U=r(C,2);i(u);var q=r(u,2),P=o(q),J=r(o(P),2);R(J),i(P);var H=r(P,2),K=r(o(H),2);st(K),i(H);var V=r(H,2),de=r(o(V),2);R(de),oe(2),i(V);var se=r(V,2),le=r(o(se),2),Q=o(le),ce=o(Q,!0);i(Q),i(le),oe(2),i(se);var W=r(se,2),X=o(W),ue=o(X);R(ue),oe(2),i(X),oe(2),i(W);var me=r(W,2);{var z=A=>{var pe=$a(),Ce=ze(pe);{var c=T=>{var M=Aa(),Z=r(o(M),2);R(Z),i(M),Y(Z,()=>e(t).oauth2_token,ge=>w(t,e(t).oauth2_token=ge)),I(T,M)};m(()=>S(Ce,T=>{e(b),g(()=>l(e(b)["auth-type"],f.PAT))&&T(c)}),"if",d,926,5)}var p=r(Ce,2);{var h=T=>{var M=Ta(),Z=ze(M),ge=r(o(Z),2);R(ge),i(Z);var xe=r(Z,2),Pe=r(o(xe),2);R(Pe),i(xe);var Ae=r(xe,2),Te=r(o(Ae),2),qe=o(Te),_e=r(qe,2),dt=r(o(_e),2),Lt=o(dt);oe(),i(dt),oe(2),i(_e),i(Te),i(Ae),Y(ge,()=>e(t).app_id,Oe=>w(t,e(t).app_id=Oe)),Y(Pe,()=>e(t).installation_id,Oe=>w(t,e(t).installation_id=Oe)),x("change",qe,tt),x("click",Lt,()=>document.getElementById("edit_private_key")?.click()),I(T,M)};m(()=>S(p,T=>{e(b),g(()=>l(e(b)["auth-type"],f.APP))&&T(h)}),"if",d,944,5)}I(A,pe)};m(()=>S(me,A=>{e(ne)&&A(z)}),"if",d,924,4)}var Ge=r(me,2),we=o(Ge),Ue=r(we,2);i(Ge),i(q),i(_),i(s),fe((A,pe)=>{ae(N,`Update credentials for ${e(b),g(()=>e(b)?.name||"Unknown")??""}`),na(de,(e(t),g(()=>e(t).endpoint))),ae(ce,(e(b),g(()=>l(e(b)?.["auth-type"]||f.PAT,f.PAT)?"Personal Access Token (PAT)":"GitHub App"))),Ue.disabled=A,Se(Ue,1,`px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors
							${pe??""}`)},[()=>g(()=>!at()),()=>g(()=>at()?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500 cursor-pointer":"bg-gray-400 cursor-not-allowed")]),x("click",v,E),x("click",U,E),Y(J,()=>e(t).name,A=>w(t,e(t).name=A)),Y(K,()=>e(t).description,A=>w(t,e(t).description=A)),da(ue,()=>e(ne),A=>n(ne,A)),x("click",we,E),x("submit",q,lt(Ct)),I(a,s)};m(()=>S(nt,a=>{e(Fe)&&e(b)&&a(Ut)}),"if",d,832,0)}var qt=r(nt,2);{var zt=a=>{var s=Da(),v=o(s),_=r(v,2),u=o(_),C=o(u),D=r(o(C),2),N=r(o(D),2),U=o(N);i(N),i(D),i(C),i(u);var q=r(u,2),P=o(q),J=r(P,2);i(q),i(_),i(s),fe(()=>ae(U,`Are you sure you want to delete the credentials "${e(G),g(()=>e(G)?.name||"Unknown")??""}"? This action cannot be undone.`)),x("click",v,E),x("click",P,E),x("click",J,Pt),I(a,s)};m(()=>S(qt,a=>{e(je)&&e(G)&&a(zt)}),"if",d,1027,0)}I(ft,rt);var St=Jt({...Kt()});return vt(),St}export{d as component};
