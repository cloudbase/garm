import"../chunks/DsnmJJEf.js";import{i as Ve}from"../chunks/C7KraPli.js";import{p as We,o as Ke,A as Qe,l as Xe,h as Ye,f as _,j as Ze,a as T,t as h,b as u,c as ta,u as i,q as g,e as n,g as t,m as b,d as a,s,k as v,$ as ea,r,w as A,B as ft,v as $}from"../chunks/cPTQ2Ibn.js";import{i as f}from"../chunks/DqFqoVWr.js";import{d as k,c as L,g as O,s as aa}from"../chunks/DAIx0GOW.js";import{p as Xt}from"../chunks/cm2N_5sv.js";import{g as Yt}from"../chunks/BWm3MK7c.js";import{U as ra}from"../chunks/DviUCx_L.js";import{D as Zt}from"../chunks/D07NkWIN.js";import{I as da}from"../chunks/Dlm8eiHX.js";import{D as sa}from"../chunks/STato8Jr.js";import{w as te}from"../chunks/BV_mDmfH.js";import{t as H}from"../chunks/Bgbd8SZ5.js";import{e as ee}from"../chunks/BZiHL9L3.js";import{e as E,i as J,j as ae,b as P,g as re}from"../chunks/BW-Jb4Ad.js";var ia=_('<div class="p-6 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading scale set...</p></div>'),la=_('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),na=_('<a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a>'),oa=_('<a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a>'),va=_('<span class="text-sm text-gray-500 dark:text-gray-400">Default system template</span>'),ca=_('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">GitHub Runner Group</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div>'),ma=_('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Extra Specifications</h2> <pre class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md overflow-x-auto text-sm text-gray-900 dark:text-white font-mono"> </pre></div></div>'),xa=_('<!> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Basic Information</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Scale Set ID</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Name</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white font-medium"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Provider</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Image</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"><code class="bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs"> </code></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Flavor</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Status</dt> <dd class="mt-1"><span> </span></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Entity</dt> <dd class="mt-1"><div class="flex items-center space-x-2"><span class="inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"> </span> <a class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300"> </a></div></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><h2 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Configuration</h2> <dl class="space-y-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Max Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Min Idle Runners</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Bootstrap Timeout</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Prefix</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">OS Type / Architecture</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Runner Install Template</dt> <dd class="mt-1"><!></dd></div> <!></dl></div></div></div> <!> <!>',1),ua=_('<div class="space-y-6"><nav class="flex" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg> Scale Sets</a></li> <li><div class="flex items-center"><svg class="w-3 h-3 text-gray-400 mx-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"> </span></div></li></ol></nav> <!></div> <!> <!> <!>',1);function Ta(de,se){We(se,!1);const N=b();let e=b(null),j=b(!0),R=b(""),U=b(!1),B=b(!1),F=b(!1),p=b(null),C=null;async function pt(){if(!(!t(N)||isNaN(t(N))))try{v(j,!0),v(R,""),v(e,await O.getScaleSet(t(N))),t(e).instances||A(e,t(e).instances=[])}catch(d){v(R,d instanceof Error?d.message:"Failed to load scale set")}finally{v(j,!1)}}async function ie(d){if(t(e))try{await O.updateScaleSet(t(e).id,d),await pt(),H.success("Scale Set Updated",`Scale Set ${t(e).name} has been updated successfully.`),v(U,!1)}catch(l){throw l}}async function le(){if(t(e)){try{await O.deleteScaleSet(t(e).id),Yt(k("/scalesets"))}catch(d){const l=ee(d);H.error("Delete Failed",l)}v(B,!1)}}async function ne(){if(t(p)){try{await O.deleteInstance(t(p).name),H.success("Instance Deleted",`Instance ${t(p).name} has been deleted successfully.`)}catch(d){const l=ee(d);H.error("Delete Failed",l)}v(F,!1),v(p,null)}}function oe(d){v(p,d),v(F,!0)}function ve(d){if(!d)return"{}";try{if(typeof d=="string"){const l=JSON.parse(d);return JSON.stringify(l,null,2)}return JSON.stringify(d,null,2)}catch{return d.toString()}}function ce(d){if(d.operation==="update"){const l=d.payload;t(e)&&l.id===t(e).id&&v(e,l)}else if(d.operation==="delete"){const l=d.payload.id||d.payload;t(e)&&t(e).id===l&&Yt(k("/scalesets"))}}function me(d){if(!t(e))return;const l=d.payload;if(l.scale_set_id===t(e).id){if(t(e).instances||A(e,t(e).instances=[]),d.operation==="create")A(e,t(e).instances=[...t(e).instances,l]);else if(d.operation==="update")A(e,t(e).instances=t(e).instances.map(S=>S.id===l.id?l:S));else if(d.operation==="delete"){const S=l.id||l;A(e,t(e).instances=t(e).instances.filter(W=>W.id!==S))}v(e,t(e))}}Ke(()=>{pt();const d=te.subscribeToEntity("scaleset",["update","delete"],ce),l=te.subscribeToEntity("instance",["create","update","delete"],me);C=()=>{d(),l()}}),Qe(()=>{C&&(C(),C=null)}),Xe(()=>Xt,()=>{v(N,parseInt(Xt.params.id||"0"))}),Ye(),Ve();var _t=ua();Ze(d=>{h(()=>ea.title=`${t(e),i(()=>t(e)?`${t(e).name} - Scale Set Details`:"Scale Set Details")??""} - GARM`)});var q=T(_t),z=a(q),yt=a(z),V=a(yt),xe=a(V);r(V);var ht=s(V,2),bt=a(ht),kt=s(a(bt),2),ue=a(kt,!0);r(kt),r(bt),r(ht),r(yt),r(z);var ge=s(z,2);{var fe=d=>{var l=ia();u(d,l)},pe=d=>{var l=ft(),S=T(l);{var W=w=>{var I=la(),G=a(I),K=a(G,!0);r(G),r(I),h(()=>n(K,t(R))),u(w,I)},ke=w=>{var I=ft(),G=T(I);{var K=Q=>{var It=xa(),Dt=T(It);{let o=$(()=>(t(e),i(()=>t(e).name||"Scale Set"))),c=$(()=>(g(E),t(e),i(()=>E(t(e))))),m=$(()=>(g(J),t(e),i(()=>J(t(e))))),x=$(()=>(g(re),i(()=>re("github"))));sa(Dt,{get title(){return t(o)},get subtitle(){return`Scale set for ${t(c)??""} (${t(m)??""}) â€¢ GitHub Runner Scale Set`},get forgeIcon(){return t(x)},onEdit:()=>v(U,!0),onDelete:()=>v(B,!0)})}var X=s(Dt,2),Y=a(X),$t=a(Y),Et=s(a($t),2),Z=a(Et),Mt=s(a(Z),2),Se=a(Mt,!0);r(Mt),r(Z);var tt=s(Z,2),Tt=s(a(tt),2),we=a(Tt,!0);r(Tt),r(tt);var et=s(tt,2),At=s(a(et),2),Ie=a(At,!0);r(At),r(et);var at=s(et,2),Nt=s(a(at),2),Rt=a(Nt),De=a(Rt,!0);r(Rt),r(Nt),r(at);var rt=s(at,2),Ut=s(a(rt),2),$e=a(Ut,!0);r(Ut),r(rt);var dt=s(rt,2),Bt=s(a(dt),2),st=a(Bt),Ee=a(st,!0);r(st),r(Bt),r(dt);var it=s(dt,2),Ft=s(a(it),2),Ct=a(Ft),lt=a(Ct),Me=a(lt,!0);r(lt);var nt=s(lt,2),Te=a(nt,!0);r(nt),r(Ct),r(Ft),r(it);var ot=s(it,2),Gt=s(a(ot),2),Ae=a(Gt,!0);r(Gt),r(ot);var Lt=s(ot,2),Ot=s(a(Lt),2),Ne=a(Ot,!0);r(Ot),r(Lt),r(Et),r($t),r(Y);var Ht=s(Y,2),Jt=a(Ht),Pt=s(a(Jt),2),vt=a(Pt),jt=s(a(vt),2),Re=a(jt,!0);r(jt),r(vt);var ct=s(vt,2),qt=s(a(ct),2),Ue=a(qt,!0);r(qt),r(ct);var mt=s(ct,2),zt=s(a(mt),2),Be=a(zt);r(zt),r(mt);var xt=s(mt,2),Vt=s(a(xt),2),Fe=a(Vt,!0);r(Vt),r(xt);var ut=s(xt,2),Wt=s(a(ut),2),Ce=a(Wt);r(Wt),r(ut);var gt=s(ut,2),Kt=s(a(gt),2),Ge=a(Kt);{var Le=o=>{var c=na(),m=a(c,!0);r(c),h(x=>{L(c,"href",x),n(m,(t(e),i(()=>t(e).template_name)))},[()=>(g(k),t(e),i(()=>k(`/templates/${t(e).template_id}`)))]),u(o,c)},Oe=o=>{var c=ft(),m=T(c);{var x=y=>{var D=oa(),qe=a(D);r(D),h(ze=>{L(D,"href",ze),n(qe,`Template ID: ${t(e),i(()=>t(e).template_id)??""}`)},[()=>(g(k),t(e),i(()=>k(`/templates/${t(e).template_id}`)))]),u(y,D)},M=y=>{var D=va();u(y,D)};f(m,y=>{t(e),i(()=>t(e).template_id)?y(x):y(M,!1)},!0)}u(o,c)};f(Ge,o=>{t(e),i(()=>t(e).template_name)?o(Le):o(Oe,!1)})}r(Kt),r(gt);var He=s(gt,2);{var Je=o=>{var c=ca(),m=s(a(c),2),x=a(m,!0);r(m),r(c),h(()=>n(x,(t(e),i(()=>t(e)["github-runner-group"])))),u(o,c)};f(He,o=>{t(e),i(()=>t(e)["github-runner-group"])&&o(Je)})}r(Pt),r(Jt),r(Ht),r(X);var Qt=s(X,2);{var Pe=o=>{var c=ma(),m=a(c),x=s(a(m),2),M=a(x,!0);r(x),r(m),r(c),h(y=>n(M,y),[()=>(t(e),i(()=>ve(t(e).extra_specs)))]),u(o,c)};f(Qt,o=>{t(e),i(()=>t(e).extra_specs)&&o(Pe)})}var je=s(Qt,2);{let o=$(()=>(t(e),i(()=>t(e).instances||[])));da(je,{get instances(){return t(o)},entityType:"scaleset",onDeleteInstance:oe})}h((o,c,m,x,M)=>{n(Se,(t(e),i(()=>t(e).id))),n(we,(t(e),i(()=>t(e).name))),n(Ie,(t(e),i(()=>t(e).provider_name))),n(De,(t(e),i(()=>t(e).image))),n($e,(t(e),i(()=>t(e).flavor))),aa(st,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${t(e),i(()=>t(e).enabled?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200")??""}`),n(Ee,(t(e),i(()=>t(e).enabled?"Enabled":"Disabled"))),n(Me,o),L(nt,"href",c),n(Te,m),n(Ae,x),n(Ne,M),n(Re,(t(e),i(()=>t(e).max_runners))),n(Ue,(t(e),i(()=>t(e).min_idle_runners))),n(Be,`${t(e),i(()=>t(e).runner_bootstrap_timeout)??""} minutes`),n(Fe,(t(e),i(()=>t(e).runner_prefix||"garm"))),n(Ce,`${t(e),i(()=>t(e).os_type)??""} / ${t(e),i(()=>t(e).os_arch)??""}`)},[()=>(g(J),t(e),i(()=>J(t(e)))),()=>(g(ae),t(e),i(()=>ae(t(e)))),()=>(g(E),t(e),i(()=>E(t(e)))),()=>(g(P),t(e),i(()=>P(t(e).created_at||""))),()=>(g(P),t(e),i(()=>P(t(e).updated_at||"")))]),u(Q,It)};f(G,Q=>{t(e)&&Q(K)},!0)}u(w,I)};f(S,w=>{t(R)?w(W):w(ke,!1)},!0)}u(d,l)};f(ge,d=>{t(j)?d(fe):d(pe,!1)})}r(q);var St=s(q,2);{var _e=d=>{ra(d,{get scaleSet(){return t(e)},$$events:{close:()=>v(U,!1),submit:l=>ie(l.detail)}})};f(St,d=>{t(U)&&t(e)&&d(_e)})}var wt=s(St,2);{var ye=d=>{{let l=$(()=>(t(e),g(E),i(()=>`Scale Set ${t(e).name} (${E(t(e))})`)));Zt(d,{title:"Delete Scale Set",message:"Are you sure you want to delete this scale set? This action cannot be undone and will remove all associated runners.",get itemName(){return t(l)},$$events:{close:()=>v(B,!1),confirm:le}})}};f(wt,d=>{t(B)&&t(e)&&d(ye)})}var he=s(wt,2);{var be=d=>{Zt(d,{title:"Delete Instance",message:"Are you sure you want to delete this instance? This action cannot be undone.",get itemName(){return t(p),i(()=>t(p).name)},$$events:{close:()=>{v(F,!1),v(p,null)},confirm:ne}})};f(he,d=>{t(F)&&t(p)&&d(be)})}h(d=>{L(xe,"href",d),n(ue,(t(e),i(()=>t(e)?t(e).name:"Loading...")))},[()=>(g(k),i(()=>k("/scalesets")))]),u(de,_t),ta()}export{Ta as component};
