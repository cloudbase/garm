import{f as u,h as qe,a as x,s as l,c as re,e as He}from"../chunks/o8CdT7B0.js";import{i as Je}from"../chunks/ChJfoPF0.js";import{p as Ke,o as Qe,q as Xe,l as C,b as Ze,f as Y,t as k,a as ta,g as t,m as p,u as s,h as z,c as a,d as g,$ as ea,r,s as d,i as B}from"../chunks/DUMcBckj.js";import{i as _,s as aa,a as ra}from"../chunks/i7pKks78.js";import{c as E,d as de,g as tt,h as da}from"../chunks/_9uqtkkk.js";import{p as ia}from"../chunks/K7MmO9Q9.js";import{g as ie}from"../chunks/BcoJ4GZv.js";import{D as sa}from"../chunks/mBfsYUjq.js";import{g as se}from"../chunks/DQsxKNC2.js";import{e as oe}from"../chunks/BZiHL9L3.js";import{w as ne}from"../chunks/DTRhxHIE.js";import{t as oa}from"../chunks/Bbk4dQfI.js";import{G as $,D as bt}from"../chunks/DG4LDt2Z.js";import{E as kt}from"../chunks/llowLxE6.js";var na=u('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div></div>'),la=u('<div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4"><div class="flex"><svg class="h-5 w-5 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div class="ml-3"><h3 class="text-sm font-medium text-red-800 dark:text-red-200">Error loading credential</h3> <p class="mt-1 text-sm text-red-700 dark:text-red-300"> </p></div></div></div>'),va=u('<span class="text-gray-400 dark:text-gray-500 mx-2">â€¢</span> <span> </span>',1),ga=u('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Upload Base URL</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white break-all"> </dd></div>'),ma=u('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Tools Metadata URL</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white break-all"> </dd></div>'),ca=u('<div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Use Internal Tools Metadata</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div>'),xa=u('<div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6"><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Endpoint Information</h3> <dl class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Name</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"><a class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300"> </a></dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Description</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Type</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white capitalize"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Base URL</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white break-all"> </dd></div> <!> <!></dl></div>'),pa=u('<div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6"><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">GitHub Rate Limit</h3> <dl class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Limit</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Used</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Remaining</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Reset</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div>'),_a=u('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700"><h3 class="text-lg font-medium text-gray-900 dark:text-white">Repositories</h3> <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Repositories using this credential</p></div> <div class="p-6"><!></div></div>'),ua=u('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700"><h3 class="text-lg font-medium text-gray-900 dark:text-white">Organizations</h3> <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Organizations using this credential</p></div> <div class="p-6"><!></div></div>'),ya=u('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700"><h3 class="text-lg font-medium text-gray-900 dark:text-white">Enterprises</h3> <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Enterprises using this credential</p></div> <div class="p-6"><!></div></div>'),fa=u('<div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6"><div class="flex items-start justify-between"><div class="flex items-center space-x-4"><div class="flex-shrink-0"><!></div> <div><h1 class="text-2xl font-bold text-gray-900 dark:text-white"> </h1> <p class="mt-1 text-sm text-gray-500 dark:text-gray-400"><span class="capitalize"> </span> Credential <!></p></div></div> <div><button class="px-4 py-2 bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-lg font-medium text-sm cursor-pointer">Delete</button></div></div></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6"><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Credential Information</h3> <dl class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">ID</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Name</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Description</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Auth Type</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white uppercase"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Forge Type</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white capitalize"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Base URL</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white break-all"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">API Base URL</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white break-all"> </dd></div> <!> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated</dt> <dd class="mt-1 text-sm text-gray-900 dark:text-white"> </dd></div></dl></div> <!> <!> <!> <!> <!>',1),ha=u('<div class="space-y-6"><nav class="flex" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-3 h-3 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg> Credentials</a></li> <li aria-current="page"><div class="flex items-center"><svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"> </span></div></li></ol></nav> <!></div> <!>',1);function Pa(le,ve){Ke(ve,!1);const[ge,me]=aa(),wt=()=>ra(ia,"$page",ge),et=p(),f=p(),j=p(),Ct=p(),$t=p(),Nt=p(),Mt=p(),zt=p(),At=p();let e=p(null),O=p(!0),P=p(""),V=p(!1),W=null;async function ce(){if(t(et))try{g(O,!0),g(P,"");const i=parseInt(t(et),10);if(isNaN(i)){g(P,"Invalid credential ID"),g(O,!1);return}let m=null;try{g(e,await tt.getGithubCredentials(i))}catch(y){if(m=y,y?.response?.status===404||y?.status===404)try{g(e,await tt.getGiteaCredentials(i))}catch(h){throw h?.response?.status===404||h?.status===404?new Error(`Credential with ID ${i} not found`):h}else throw y}}catch(i){g(P,oe(i))}finally{g(O,!1)}}async function xe(){if(t(e)){try{t(f)?await tt.deleteGithubCredentials(t(e).id):await tt.deleteGiteaCredentials(t(e).id),ie(E("/credentials"))}catch(i){const m=oe(i);oa.error("Delete Failed",m)}g(V,!1)}}function Tt(i){if(i.operation==="delete"){const m=i.payload.id||i.payload;t(e)&&t(e).id===m&&ie(E("/credentials"))}}Qe(()=>{ce();const i=ne.subscribeToEntity("github_credentials",["delete"],Tt),m=ne.subscribeToEntity("gitea_credentials",["delete"],Tt);W=()=>{i(),m()}}),Xe(()=>{W&&(W(),W=null)}),C(()=>wt(),()=>{g(et,wt().params.id)}),C(()=>t(e),()=>{g(f,t(e)?.forge_type==="github")}),C(()=>t(e),()=>{g(j,t(e)?.forge_type==="gitea")}),C(()=>$,()=>{g(Ct,[{key:"name",title:"Repository",cellComponent:kt,cellProps:{entityType:"repository",showOwner:!0}},{key:"pool_balancing_type",title:"Balancing",cellComponent:$,cellProps:{field:"pool_balancing_type"}},{key:"agent_mode",title:"Agent Mode",cellComponent:$,cellProps:{getValue:i=>i.agent_mode?"Yes":"No"}}])}),C(()=>$,()=>{g($t,[{key:"name",title:"Organization",cellComponent:kt,cellProps:{entityType:"organization"}},{key:"pool_balancing_type",title:"Balancing",cellComponent:$,cellProps:{field:"pool_balancing_type"}},{key:"agent_mode",title:"Agent Mode",cellComponent:$,cellProps:{getValue:i=>i.agent_mode?"Yes":"No"}}])}),C(()=>$,()=>{g(Nt,[{key:"name",title:"Enterprise",cellComponent:kt,cellProps:{entityType:"enterprise"}},{key:"pool_balancing_type",title:"Balancing",cellComponent:$,cellProps:{field:"pool_balancing_type"}},{key:"agent_mode",title:"Agent Mode",cellComponent:$,cellProps:{getValue:i=>i.agent_mode?"Yes":"No"}}])}),C(()=>{},()=>{g(Mt,{entityType:"repository",primaryText:{field:"name",format:i=>`${i.owner}/${i.name}`,isClickable:!0,href:"/repositories/{id}"},customInfo:[{text:i=>`Balancing: ${i.pool_balancing_type||"N/A"}`},{text:i=>`Agent Mode: ${i.agent_mode?"Yes":"No"}`}]})}),C(()=>{},()=>{g(zt,{entityType:"organization",primaryText:{field:"name",isClickable:!0,href:"/organizations/{id}"},customInfo:[{text:i=>`Balancing: ${i.pool_balancing_type||"N/A"}`},{text:i=>`Agent Mode: ${i.agent_mode?"Yes":"No"}`}]})}),C(()=>{},()=>{g(At,{entityType:"enterprise",primaryText:{field:"name",isClickable:!0,href:"/enterprises/{id}"},customInfo:[{text:i=>`Balancing: ${i.pool_balancing_type||"N/A"}`},{text:i=>`Agent Mode: ${i.agent_mode?"Yes":"No"}`}]})}),Ze(),Je();var Dt=ha();qe(i=>{k(()=>ea.title=`${t(e),s(()=>t(e)?`${t(e).name} - Credential Details`:"Credential Details")??""} - GARM`)});var at=Y(Dt),rt=a(at),It=a(rt),dt=a(It),pe=a(dt);r(dt);var Bt=d(dt,2),Et=a(Bt),Pt=d(a(Et),2),_e=a(Pt,!0);r(Pt),r(Et),r(Bt),r(It),r(rt);var ue=d(rt,2);{var ye=i=>{var m=na();x(i,m)},fe=i=>{var m=re(),y=Y(m);{var h=b=>{var N=la(),q=a(N),H=d(a(q),2),A=d(a(H),2),J=a(A,!0);r(A),r(H),r(q),r(N),k(()=>l(J,t(P))),x(b,N)},F=b=>{var N=re(),q=Y(N);{var H=A=>{var J=fa(),it=Y(J),Lt=a(it),st=a(Lt),ot=a(st),ke=a(ot);da(ke,()=>(z(se),t(e),s(()=>se(t(e).forge_type||"","w-12 h-12")))),r(ot);var Gt=d(ot,2),nt=a(Gt),we=a(nt,!0);r(nt);var Rt=d(nt,2),lt=a(Rt),Ce=a(lt,!0);r(lt);var $e=d(lt,2);{var Ne=o=>{var n=va(),v=d(Y(n),2),c=a(v,!0);r(v),k(()=>l(c,(t(e),s(()=>t(e).description)))),x(o,n)};_($e,o=>{t(e),s(()=>t(e).description)&&o(Ne)})}r(Rt),r(Gt),r(st);var Ut=d(st,2),Me=a(Ut);r(Ut),r(Lt),r(it);var vt=d(it,2),St=d(a(vt),2),gt=a(St),Yt=d(a(gt),2),ze=a(Yt,!0);r(Yt),r(gt);var mt=d(gt,2),jt=d(a(mt),2),Ae=a(jt,!0);r(jt),r(mt);var ct=d(mt,2),Ot=d(a(ct),2),Te=a(Ot,!0);r(Ot),r(ct);var xt=d(ct,2),Vt=d(a(xt),2),De=a(Vt,!0);r(Vt),r(xt);var pt=d(xt,2),Wt=d(a(pt),2),Ie=a(Wt,!0);r(Wt),r(pt);var _t=d(pt,2),Ft=d(a(_t),2),Be=a(Ft,!0);r(Ft),r(_t);var ut=d(_t,2),qt=d(a(ut),2),Ee=a(qt,!0);r(qt),r(ut);var Ht=d(ut,2);{var Pe=o=>{var n=ga(),v=d(a(n),2),c=a(v,!0);r(v),r(n),k(()=>l(c,(t(e),s(()=>t(e).upload_base_url)))),x(o,n)};_(Ht,o=>{t(f),t(e),s(()=>t(f)&&t(e).upload_base_url)&&o(Pe)})}var yt=d(Ht,2),Jt=d(a(yt),2),Le=a(Jt,!0);r(Jt),r(yt);var Kt=d(yt,2),Qt=d(a(Kt),2),Ge=a(Qt,!0);r(Qt),r(Kt),r(St),r(vt);var Xt=d(vt,2);{var Re=o=>{var n=xa(),v=d(a(n),2),c=a(v),L=d(a(c),2),G=a(L),R=a(G,!0);r(G),r(L),r(c);var T=d(c,2),K=d(a(T),2),U=a(K,!0);r(K),r(T);var D=d(T,2),Q=d(a(D),2),X=a(Q,!0);r(Q),r(D);var I=d(D,2),Z=d(a(I),2),ft=a(Z,!0);r(Z),r(I);var ae=d(I,2);{var Ve=w=>{var M=ma(),S=d(a(M),2),ht=a(S,!0);r(S),r(M),k(()=>l(ht,(t(e),s(()=>t(e).endpoint.tools_metadata_url)))),x(w,M)};_(ae,w=>{t(j),t(e),s(()=>t(j)&&t(e).endpoint.tools_metadata_url)&&w(Ve)})}var We=d(ae,2);{var Fe=w=>{var M=ca(),S=d(a(M),2),ht=a(S,!0);r(S),r(M),k(()=>l(ht,(t(e),s(()=>t(e).endpoint.use_internal_tools_metadata?"Yes":"No")))),x(w,M)};_(We,w=>{t(j)&&w(Fe)})}r(v),r(n),k(w=>{de(G,"href",w),l(R,(t(e),s(()=>t(e).endpoint.name))),l(U,(t(e),s(()=>t(e).endpoint.description||"N/A"))),l(X,(t(e),s(()=>t(e).endpoint.endpoint_type))),l(ft,(t(e),s(()=>t(e).endpoint.base_url)))},[()=>(z(E),s(()=>E("/endpoints")))]),x(o,n)};_(Xt,o=>{t(e),s(()=>t(e).endpoint)&&o(Re)})}var Zt=d(Xt,2);{var Ue=o=>{var n=pa(),v=d(a(n),2),c=a(v),L=d(a(c),2),G=a(L,!0);r(L),r(c);var R=d(c,2),T=d(a(R),2),K=a(T,!0);r(T),r(R);var U=d(R,2),D=d(a(U),2),Q=a(D,!0);r(D),r(U);var X=d(U,2),I=d(a(X),2),Z=a(I,!0);r(I),r(X),r(v),r(n),k(ft=>{l(G,(t(e),s(()=>t(e).rate_limit.limit))),l(K,(t(e),s(()=>t(e).rate_limit.used))),l(Q,(t(e),s(()=>t(e).rate_limit.remaining))),l(Z,ft)},[()=>(t(e),s(()=>new Date((t(e).rate_limit.reset||0)*1e3).toLocaleString()))]),x(o,n)};_(Zt,o=>{t(f),t(e),s(()=>t(f)&&t(e).rate_limit)&&o(Ue)})}var te=d(Zt,2);{var Se=o=>{var n=_a(),v=d(a(n),2),c=a(v);bt(c,{get columns(){return t(Ct)},get data(){return t(e),s(()=>t(e).repositories)},loading:!1,searchPlaceholder:"Search repositories...",itemName:"repositories",emptyMessage:"No repositories using this credential",get mobileCardConfig(){return t(Mt)}}),r(v),r(n),x(o,n)};_(te,o=>{t(e),s(()=>t(e).repositories&&t(e).repositories.length>0)&&o(Se)})}var ee=d(te,2);{var Ye=o=>{var n=ua(),v=d(a(n),2),c=a(v);bt(c,{get columns(){return t($t)},get data(){return t(e),s(()=>t(e).organizations)},loading:!1,searchPlaceholder:"Search organizations...",itemName:"organizations",emptyMessage:"No organizations using this credential",get mobileCardConfig(){return t(zt)}}),r(v),r(n),x(o,n)};_(ee,o=>{t(e),s(()=>t(e).organizations&&t(e).organizations.length>0)&&o(Ye)})}var je=d(ee,2);{var Oe=o=>{var n=ya(),v=d(a(n),2),c=a(v);bt(c,{get columns(){return t(Nt)},get data(){return t(e),s(()=>t(e).enterprises)},loading:!1,searchPlaceholder:"Search enterprises...",itemName:"enterprises",emptyMessage:"No enterprises using this credential",get mobileCardConfig(){return t(At)}}),r(v),r(n),x(o,n)};_(je,o=>{t(f),t(e),s(()=>t(f)&&t(e).enterprises&&t(e).enterprises.length>0)&&o(Oe)})}k((o,n)=>{l(we,(t(e),s(()=>t(e).name||"Unnamed Credential"))),l(Ce,(t(e),s(()=>t(e).forge_type))),l(ze,(t(e),s(()=>t(e).id))),l(Ae,(t(e),s(()=>t(e).name))),l(Te,(t(e),s(()=>t(e).description||"N/A"))),l(De,(t(e),s(()=>t(e)["auth-type"]||"N/A"))),l(Ie,(t(e),s(()=>t(e).forge_type||"N/A"))),l(Be,(t(e),s(()=>t(e).base_url||"N/A"))),l(Ee,(t(e),s(()=>t(e).api_base_url||"N/A"))),l(Le,o),l(Ge,n)},[()=>(t(e),s(()=>new Date(t(e).created_at||"").toLocaleString())),()=>(t(e),s(()=>new Date(t(e).updated_at||"").toLocaleString()))]),He("click",Me,()=>g(V,!0)),x(A,J)};_(q,A=>{t(e)&&A(H)},!0)}x(b,N)};_(y,b=>{t(P)?b(h):b(F,!1)},!0)}x(i,m)};_(ue,i=>{t(O)?i(ye):i(fe,!1)})}r(at);var he=d(at,2);{var be=i=>{const m=B(()=>(t(e),s(()=>t(e).repositories?.length||0))),y=B(()=>(t(e),s(()=>t(e).organizations?.length||0))),h=B(()=>(t(f),t(e),s(()=>t(f)&&t(e).enterprises?.length||0))),F=B(()=>(z(t(m)),z(t(y)),z(t(h)),s(()=>[t(m)>0?`Warning: This credential is currently used by ${t(m)} ${t(m)===1?"repository":"repositories"}.`:"",t(y)>0?`Warning: This credential is currently used by ${t(y)} ${t(y)===1?"organization":"organizations"}.`:"",t(h)>0?`Warning: This credential is currently used by ${t(h)} ${t(h)===1?"enterprise":"enterprises"}.`:""].filter(b=>b).join(" "))));{let b=B(()=>(t(e),z(t(F)),s(()=>`Are you sure you want to delete the credential '${t(e).name}'? This action cannot be undone. ${t(F)}`))),N=B(()=>(t(e),s(()=>t(e).name||"credential")));sa(i,{title:"Delete Credential",get message(){return t(b)},get itemName(){return t(N)},$$events:{confirm:xe,cancel:()=>g(V,!1)}})}};_(he,i=>{t(V)&&t(e)&&i(be)})}k(i=>{de(pe,"href",i),l(_e,(t(e),s(()=>t(e)?.name||"Loading...")))},[()=>(z(E),s(()=>E("/credentials")))]),x(le,Dt),ta(),me()}export{Pa as component};
