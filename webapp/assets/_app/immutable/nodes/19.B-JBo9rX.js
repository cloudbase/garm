import"../chunks/DsnmJJEf.js";import{i as he}from"../chunks/C7KraPli.js";import{p as xe,o as we,l as O,h as be,f as le,j as Ce,a as D,b as v,c as Te,g as e,m as n,$ as ke,k as a,B as R,u as s,s as b,q as d,v as M,d as C,r as T,z as Pe,D as Z,t as ee,e as te}from"../chunks/cPTQ2Ibn.js";import{i as k}from"../chunks/DqFqoVWr.js";import{g as B}from"../chunks/BBTpo6Bp.js";import{d as E,g as ae}from"../chunks/DB8UsQ0-.js";import{P as Le}from"../chunks/CTRGQ19u.js";import{A as $e}from"../chunks/DCFSsZl6.js";import{D as Ae,G as I,A as De}from"../chunks/B9gOem8M.js";import{t as S}from"../chunks/Bgbd8SZ5.js";import{e as re}from"../chunks/BZiHL9L3.js";import{B as oe}from"../chunks/B4-9yhwO.js";import{D as Me}from"../chunks/4lgVITXW.js";import{E as Be}from"../chunks/BesSJg-T.js";import{i as Ee}from"../chunks/C98nByjP.js";var Ie=le('<div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4 mb-6"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><h3 class="text-sm font-medium text-red-800 dark:text-red-200">Error loading templates</h3> <div class="mt-2 text-sm text-red-700 dark:text-red-300"> </div> <div class="mt-4"><!></div></div></div></div>'),Se=le("<!> <!> <!> <!>",1);function Xe(se,ne){xe(ne,!1);const g=n(),q=n();let P=n(!0),L=n([]),_=n(""),m=n(""),i=n(1),f=n(25),h=n(1),$=n(!1),c=n(null);async function G(){try{a(P,!0),a(_,""),a(L,await ae.listTemplates())}catch(t){a(_,re(t)),S.add({type:"error",title:"Failed to load templates",message:e(_)})}finally{a(P,!1)}}async function ie(){if(e(c)?.id)try{await ae.deleteTemplate(e(c).id),S.add({type:"success",title:"Template deleted",message:`Template "${e(c).name}" has been deleted successfully.`}),a($,!1),a(c,null),await G()}catch(t){const r=re(t);S.add({type:"error",title:"Failed to delete template",message:r})}}function de(){B(E("/templates/create"))}async function H(t){if(!t.id){S.add({type:"error",title:"Error",message:"Template ID is missing"});return}B(E(`/templates/create?clone=${t.id}`))}function j(t){a(c,t),a($,!0)}function W(t){switch(t){case"github":return{color:"blue",text:"GitHub"};case"gitea":return{color:"green",text:"Gitea"};default:return{color:"gray",text:t||"Unknown"}}}function J(t){switch(t){case"linux":return{color:"blue",text:"Linux"};case"windows":return{color:"info",text:"Windows"};default:return{color:"gray",text:t||"Unknown"}}}const ce=[{key:"name",title:"Name",cellComponent:Be,cellProps:{entityType:"template"}},{key:"description",title:"Description",cellComponent:I,cellProps:{field:"description",type:"description"}},{key:"forge_type",title:"Forge Type",cellComponent:I,cellProps:{field:"forge_type"}},{key:"os_type",title:"OS Type",cellComponent:I,cellProps:{field:"os_type"}},{key:"owner_id",title:"Owner",cellComponent:I,cellProps:{field:"owner_id"}},{key:"actions",title:"Actions",align:"right",cellComponent:De,cellProps:t=>{const r=Ee(),l=t.owner_id==="system",o=[];return o.push({type:"copy",title:"Clone",ariaLabel:"Clone template",action:"clone"}),(r||!l)&&o.push({type:"edit",title:"Edit",ariaLabel:"Edit template",action:"edit"}),(r||!l)&&o.push({type:"delete",title:"Delete",ariaLabel:"Delete template",action:"delete"}),{actions:o}}}],me={entityType:"template",primaryText:{field:"name",isClickable:!0,href:"/templates/{id}"},secondaryText:{field:"description"},badges:[{type:"custom",value:t=>{const r=W(t.forge_type);return{variant:r.color,text:r.text}}},{type:"custom",value:t=>{const r=J(t.os_type);return{variant:r.color,text:r.text}}}],actions:[{type:"clone",handler:t=>H(t)},{type:"edit",handler:t=>B(E(`/templates/${t.id}?edit=true`))},{type:"delete",handler:t=>j(t)}]};we(()=>{G()}),O(()=>(e(m),e(L)),()=>{a(g,e(m)?e(L).filter(t=>t.name?.toLowerCase().includes(e(m).toLowerCase())||t.description?.toLowerCase().includes(e(m).toLowerCase())||t.forge_type?.toLowerCase().includes(e(m).toLowerCase())||t.os_type?.toLowerCase().includes(e(m).toLowerCase())):e(L))}),O(()=>(e(h),e(g),e(f),e(i)),()=>{a(h,Math.ceil(e(g).length/e(f))),e(i)>e(h)&&e(h)>0&&a(i,e(h))}),O(()=>(e(g),e(i),e(f)),()=>{a(q,e(g).slice((e(i)-1)*e(f),e(i)*e(f)))}),be(),he();var K=Se();Ce(t=>{ke.title="Runner Install Templates - GARM"});var Q=D(K);Le(Q,{title:"Runner Install Templates",description:"Manage templates for configuring runner software installation. These templates can be set on pools or scale sets.",actionLabel:"Create Template",showAction:!0,$$events:{action:de}});var V=b(Q,2);{var pe=t=>{var r=Ie(),l=C(r),o=b(C(l),2),x=b(C(o),2),z=C(x,!0);T(x);var A=b(x,2),F=C(A);$e(F,{variant:"secondary",size:"sm",$$events:{click:G},children:(p,u)=>{Pe();var U=Z("Try Again");v(p,U)},$$slots:{default:!0}}),T(A),T(o),T(l),T(r),ee(()=>te(z,e(_))),v(t,r)};k(V,t=>{e(_)&&!e(P)&&t(pe)})}var X=b(V,2);Ae(X,{get columns(){return ce},get data(){return e(q)},get loading(){return e(P)},get error(){return e(_)},get searchTerm(){return e(m)},searchPlaceholder:"Search templates by name, description, type...",get currentPage(){return e(i)},get perPage(){return e(f)},get totalPages(){return e(h)},get totalItems(){return e(g),s(()=>e(g).length)},get mobileCardConfig(){return me},emptyMessage:"No templates found",$$events:{search:t=>{a(m,t.detail.term),a(i,1)},pageChange:t=>a(i,t.detail.page),perPageChange:t=>{a(f,t.detail.perPage),a(i,1)},clone:t=>H(t.detail.item),edit:t=>B(E(`/templates/${t.detail.item.id}?edit=true`)),delete:t=>j(t.detail.item)},$$slots:{cell:(t,r)=>{const l=M(()=>r.item),o=M(()=>r.column);var x=R(),z=D(x);{var A=p=>{const u=M(()=>(d(e(l)),s(()=>W(e(l).forge_type))));oe(p,{get variant(){return d(e(u)),s(()=>e(u).color)},get text(){return d(e(u)),s(()=>e(u).text)}})},F=p=>{var u=R(),U=D(u);{var fe=w=>{const y=M(()=>(d(e(l)),s(()=>J(e(l).os_type))));oe(w,{get variant(){return d(e(y)),s(()=>e(y).color)},get text(){return d(e(y)),s(()=>e(y).text)}})},ye=w=>{var y=R(),ve=D(y);{var _e=N=>{var Y=Z();ee(()=>te(Y,(d(e(l)),s(()=>e(l).owner_id==="system"?"System":e(l).owner_id||"Unknown")))),v(N,Y)};k(ve,N=>{d(e(o)),s(()=>e(o).key==="owner_id")&&N(_e)},!0)}v(w,y)};k(U,w=>{d(e(o)),s(()=>e(o).key==="os_type")?w(fe):w(ye,!1)},!0)}v(p,u)};k(z,p=>{d(e(o)),s(()=>e(o).key==="forge_type")?p(A):p(F,!1)})}v(t,x)}}});var ue=b(X,2);{var ge=t=>{Me(t,{title:"Delete Template",message:"Are you sure you want to delete this template? This action cannot be undone.",get itemName(){return e(c),s(()=>e(c).name)},$$events:{close:()=>{a($,!1),a(c,null)},confirm:ie}})};k(ue,t=>{e($)&&e(c)&&t(ge)})}v(se,K),Te()}export{Xe as component};
