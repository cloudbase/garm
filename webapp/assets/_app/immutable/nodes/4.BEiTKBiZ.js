import{f as T,e as _,h as Ut,a as P,s as V,r as Qe}from"../chunks/ZGz3X54u.js";import{i as Lt}from"../chunks/CY7Wcm-1.js";import{p as Mt,g as e,o as Pt,l as ae,b as Tt,f as xe,a as $t,m,e as At,$ as Bt,c as o,i as Fe,s as r,t as Q,u as y,d as s,j as b,r as l,h as he,n as re}from"../chunks/kDtaAWAK.js";import{i as oe,s as It,a as Dt}from"../chunks/Cun6jNAp.js";import{h as Gt,r as E,c as Xe,s as z,g as ce}from"../chunks/CYK-UalN.js";import{b as R,a as Ye}from"../chunks/CYnNqrHp.js";import{p as Ze}from"../chunks/CdEA5IGF.js";import{P as jt}from"../chunks/DacI6VAP.js";import{F as Ft}from"../chunks/CovvT05J.js";import{A as et}from"../chunks/DUWZCTMr.js";import{e as zt,a as tt}from"../chunks/Vo3Mv3dp.js";import{t as ke}from"../chunks/BVGCMSWJ.js";import{g as ze,c as qt,a as Nt,p as Ht}from"../chunks/ZelbukuJ.js";import{e as qe}from"../chunks/BZiHL9L3.js";import{D as St,G as Ne}from"../chunks/BKeluGSY.js";import"../chunks/DWgB-t1g.js";import{E as Vt}from"../chunks/oWoYyEl8.js";import{A as Ot}from"../chunks/rb89c4PS.js";import{T as $e}from"../chunks/ONKDshdz.js";var Wt=T('<div class="flex items-center justify-between"><div class="flex-1 min-w-0"><div class="block"><p class="text-sm font-medium text-gray-900 dark:text-white truncate"> </p> <p class="text-sm text-gray-500 dark:text-gray-400 truncate mt-1"> </p> <div class="flex items-center mt-2"><!> <span class="ml-2 text-xs text-gray-500 dark:text-gray-400 capitalize"> </span></div></div></div> <div class="flex space-x-2 ml-4"><!> <!></div></div>'),Kt=T('<div><label for="api_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">API Base URL <span class="text-red-500">*</span></label> <input type="url" id="api_base_url" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="https://api.github.com or https://github.example.com/api/v3"/></div> <div><label for="upload_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Upload Base URL</label> <input type="url" id="upload_base_url" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="https://uploads.github.com"/></div>',1),Jt=T('<div><label for="api_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">API Base URL <span class="text-xs text-gray-500">(optional)</span></label> <input type="url" id="api_base_url" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="https://gitea.example.com/api/v1 (leave empty to use Base URL)"/> <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">If empty, Base URL will be used as API Base URL</p></div> <div><div class="flex items-center mb-1"><label for="tools_metadata_url">Tools Metadata URL <span class="text-xs text-gray-500">(optional)</span></label> <div class="ml-2"><!></div></div> <input type="url" id="tools_metadata_url" autocomplete="off" placeholder="https://gitea.com/api/v1/repos/gitea/act_runner/releases"/> <p> </p></div> <div class="flex items-center"><input id="use_internal_tools_metadata" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="use_internal_tools_metadata" class="ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Use Internal Tools Metadata</label> <div class="ml-2"><!></div></div>',1),Qt=T('<div class="space-y-2"><svg class="mx-auto h-8 w-8 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="text-sm font-medium text-green-700 dark:text-green-300"> </p> <div class="flex justify-center space-x-2"><button type="button" class="text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline cursor-pointer">Replace</button> <span class="text-xs text-gray-400">•</span> <button type="button" class="text-xs text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 hover:underline cursor-pointer">Remove</button></div></div>'),Xt=T('<div class="space-y-2"><svg class="mx-auto h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-sm text-gray-600 dark:text-gray-400"><button type="button" class="text-gray-900 dark:text-white hover:text-gray-700 dark:hover:text-gray-300 hover:underline cursor-pointer">Choose a file</button> or drag and drop</p> <p class="text-xs text-gray-500 dark:text-gray-400">PEM, CRT, CER, CERT files only</p></div>'),Yt=T('<div class="fixed inset-0 flex items-center justify-center z-50" role="dialog" aria-modal="true"><button class="fixed inset-0 w-full h-full bg-black/30 dark:bg-black/50 cursor-default" aria-label="Close modal"></button> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto relative z-10" role="document"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"><div><h3 class="text-lg font-semibold text-gray-900 dark:text-white">Add Endpoint</h3> <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Connect to GitHub or Gitea for runner management</p></div> <button class="text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100 cursor-pointer" aria-label="Close modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-6 space-y-4"><!> <div><label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Endpoint Name <span class="text-red-500">*</span></label> <input type="text" id="name" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <div><label for="description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label> <textarea id="description" rows="2" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Brief description of this endpoint"></textarea></div> <div><label for="base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Base URL <span class="text-red-500">*</span></label> <input type="url" id="base_url" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <!> <div class="space-y-3 border-t border-gray-200 dark:border-gray-700 pt-4"><label for="ca_cert_file" class="block text-sm font-medium text-gray-700 dark:text-gray-300">CA Certificate Bundle (Optional)</label> <div><input type="file" id="ca_cert_file" accept=".pem,.crt,.cer,.cert" class="hidden"/> <!></div></div> <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 cursor-pointer">Cancel</button> <button type="submit">Create Endpoint</button></div></form></div></div>'),Zt=T('<div><label for="edit_api_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">API Base URL <span class="text-red-500">*</span></label> <input type="url" id="edit_api_base_url" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <div><label for="edit_upload_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Upload Base URL</label> <input type="url" id="edit_upload_base_url" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div>',1),ea=T('<div><label for="edit_api_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">API Base URL <span class="text-xs text-gray-500">(optional)</span></label> <input type="url" id="edit_api_base_url" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/> <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">If empty, Base URL will be used as API Base URL</p></div> <div><div class="flex items-center mb-1"><label for="edit_tools_metadata_url">Tools Metadata URL <span class="text-xs text-gray-500">(optional)</span></label> <div class="ml-2"><!></div></div> <input type="url" id="edit_tools_metadata_url" autocomplete="off" placeholder="https://gitea.com/api/v1/repos/gitea/act_runner/releases"/> <p> </p></div> <div class="flex items-center"><input id="edit_use_internal_tools_metadata" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="edit_use_internal_tools_metadata" class="ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Use Internal Tools Metadata</label> <div class="ml-2"><!></div></div>',1),ta=T('<div class="space-y-2"><svg class="mx-auto h-8 w-8 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="text-sm font-medium text-green-700 dark:text-green-300"> </p> <div class="flex justify-center space-x-2"><button type="button" class="text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline cursor-pointer">Replace</button> <span class="text-xs text-gray-400">•</span> <button type="button" class="text-xs text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 hover:underline cursor-pointer">Remove</button></div></div>'),aa=T('<div class="space-y-2"><svg class="mx-auto h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-sm text-gray-600 dark:text-gray-400"><button type="button" class="text-gray-900 dark:text-white hover:text-gray-700 dark:hover:text-gray-300 hover:underline cursor-pointer">Choose a file</button> or drag and drop</p> <p class="text-xs text-gray-500 dark:text-gray-400">PEM, CRT, CER, CERT files only</p></div>'),ra=T('<div class="fixed inset-0 flex items-center justify-center z-50" role="dialog" aria-modal="true"><button class="fixed inset-0 w-full h-full bg-black/30 dark:bg-black/50 cursor-default" aria-label="Close modal"></button> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto relative z-10" role="document"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"><div><h3 class="text-lg font-semibold text-gray-900 dark:text-white"> </h3> <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Update endpoint configuration</p></div> <button class="text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100 cursor-pointer" aria-label="Close modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-6 space-y-4"><div><label for="edit_name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Endpoint Name <span class="text-red-500">*</span></label> <input type="text" id="edit_name" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <div><label for="edit_description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label> <textarea id="edit_description" rows="2" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"></textarea></div> <div><label for="edit_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Base URL <span class="text-red-500">*</span></label> <input type="url" id="edit_base_url" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <!> <div class="space-y-3 border-t border-gray-200 dark:border-gray-700 pt-4"><label for="edit_ca_cert_file" class="block text-sm font-medium text-gray-700 dark:text-gray-300">CA Certificate Bundle (Optional)</label> <div><input type="file" id="edit_ca_cert_file" accept=".pem,.crt,.cer,.cert" class="hidden"/> <!></div></div> <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 cursor-pointer">Cancel</button> <button type="submit">Update Endpoint</button></div></form></div></div>'),oa=T('<div class="fixed inset-0 flex items-center justify-center z-50" role="dialog" aria-modal="true"><button class="fixed inset-0 w-full h-full bg-black/30 dark:bg-black/50 cursor-default" aria-label="Close modal"></button> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-xl w-full mx-4 relative z-10" role="document"><div class="px-6 py-4"><div class="flex items-center"><div class="flex-shrink-0"><svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div> <div class="ml-3"><h3 class="text-lg font-medium text-gray-900 dark:text-white">Delete Endpoint</h3> <p class="mt-2 text-sm text-gray-500 dark:text-gray-300"> </p></div></div></div> <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 cursor-pointer">Cancel</button> <button type="button" class="px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 cursor-pointer">Delete</button></div></div></div>'),la=T('<div class="space-y-6"><!> <!></div> <!> <!> <!>',1);function Ea(at,rt){Mt(rt,!1);const[ot,lt]=It(),X=()=>Dt(zt,"$eagerCache",ot),Ae=m(),Y=m(),He=m(),pe=m();let we=m(!0),le=m([]),Ce=m(""),Ee=m(""),q=m(1),se=m(25),ie=m(1),Re=m(!1),Ue=m(!1),Le=m(!1),O=m("github"),h=m(null),D=m(null),t=m({name:"",description:"",endpoint_type:"",base_url:"",api_base_url:"",upload_base_url:"",ca_cert_bundle:"",tools_metadata_url:"",use_internal_tools_metadata:!1}),B=m(""),k={...e(t)};Pt(async()=>{try{s(we,!0);const a=await tt.getEndpoints();a&&Array.isArray(a)&&s(le,a)}catch(a){console.error("Failed to load endpoints:",a),s(Ce,a instanceof Error?a.message:"Failed to load endpoints")}finally{s(we,!1)}});async function st(){try{await tt.retryResource("endpoints")}catch(a){console.error("Retry failed:",a)}}const it=[{key:"name",title:"Name",cellComponent:Ne,cellProps:{field:"name"}},{key:"description",title:"Description",cellComponent:Ne,cellProps:{field:"description"}},{key:"api_url",title:"API URL",cellComponent:Ne,cellProps:{field:"api_base_url",fallbackField:"base_url"}},{key:"forge_type",title:"Forge Type",cellComponent:Vt},{key:"actions",title:"Actions",align:"right",cellComponent:Ot}],nt={entityType:"endpoint",primaryText:{field:"name",isClickable:!1},secondaryText:{field:"description"},customInfo:[{icon:a=>ze(a?.endpoint_type||"unknown"),text:a=>a?.api_base_url||"Unknown"}],actions:[{type:"edit",handler:a=>Be(a)},{type:"delete",handler:a=>Ie(a)}]};function dt(a){s(Ee,a.detail.term),s(q,1)}function ut(a){s(q,a.detail.page)}function ct(a){const n=qt(a.detail.perPage);s(se,n.newPerPage),s(q,n.newCurrentPage)}function pt(a){Be(a.detail.item)}function bt(a){Ie(a.detail.item)}function _t(){s(O,"github"),De(),b(t,e(t).endpoint_type="github"),s(Re,!0)}function gt(a){s(O,a.detail),De(),b(t,e(t).endpoint_type=a.detail)}function Be(a){s(h,a),s(t,{name:a.name||"",description:a.description||"",endpoint_type:a.endpoint_type||"",base_url:a.base_url||"",api_base_url:a.api_base_url||"",upload_base_url:a.upload_base_url||"",ca_cert_bundle:typeof a.ca_cert_bundle=="string"?a.ca_cert_bundle:"",tools_metadata_url:a.tools_metadata_url||"",use_internal_tools_metadata:a.use_internal_tools_metadata||!1}),k={...e(t)},s(B,e(t).ca_cert_bundle?"certificate.pem":""),s(Ue,!0)}function Ie(a){s(D,a),s(Le,!0)}function De(){s(t,{name:"",description:"",endpoint_type:"",base_url:"",api_base_url:"",upload_base_url:"",ca_cert_bundle:"",tools_metadata_url:"",use_internal_tools_metadata:!1}),k={...e(t)},s(B,"")}function mt(a){a.key==="Escape"&&(e(Re)||e(Ue)||e(Le))&&U()}function U(){s(Re,!1),s(Ue,!1),s(Le,!1),s(O,"github"),s(h,null),s(D,null),De()}function ft(){const a={};if(e(t).description!==k.description&&(e(t).description.trim()!==""||k.description!=="")&&(a.description=e(t).description.trim()),e(t).base_url!==k.base_url&&e(t).base_url.trim()!==""&&(a.base_url=e(t).base_url.trim()),e(t).api_base_url!==k.api_base_url&&(e(t).api_base_url.trim()!==""||k.api_base_url!=="")&&(a.api_base_url=e(t).api_base_url.trim()),e(h)?.endpoint_type==="github"&&e(t).upload_base_url!==k.upload_base_url&&(e(t).upload_base_url.trim()!==""||k.upload_base_url!=="")&&(a.upload_base_url=e(t).upload_base_url.trim()),e(t).ca_cert_bundle!==k.ca_cert_bundle)if(e(t).ca_cert_bundle!=="")try{const n=atob(e(t).ca_cert_bundle);a.ca_cert_bundle=Array.from(n,f=>f.charCodeAt(0))}catch{k.ca_cert_bundle!==""&&(a.ca_cert_bundle=[])}else k.ca_cert_bundle!==""&&(a.ca_cert_bundle=[]);return e(h)?.endpoint_type==="gitea"&&(e(t).tools_metadata_url!==k.tools_metadata_url&&(a.tools_metadata_url=e(t).tools_metadata_url.trim()),e(t).use_internal_tools_metadata!==k.use_internal_tools_metadata&&(a.use_internal_tools_metadata=e(t).use_internal_tools_metadata)),a}async function vt(){try{const a={name:e(t).name,description:e(t).description,endpoint_type:e(t).endpoint_type,base_url:e(t).base_url,api_base_url:e(t).api_base_url,upload_base_url:e(t).upload_base_url};if(e(t).endpoint_type==="gitea"&&(e(t).tools_metadata_url.trim()!==""&&(a.tools_metadata_url=e(t).tools_metadata_url.trim()),a.use_internal_tools_metadata=e(t).use_internal_tools_metadata),e(t).ca_cert_bundle&&e(t).ca_cert_bundle.trim()!=="")try{const n=atob(e(t).ca_cert_bundle);a.ca_cert_bundle=Array.from(n,f=>f.charCodeAt(0))}catch{}e(t).endpoint_type==="github"?await ce.createGithubEndpoint(a):await ce.createGiteaEndpoint(a),ke.success("Endpoint Created",`Endpoint ${e(t).name} has been created successfully.`),U()}catch(a){s(Ce,qe(a))}}async function yt(){if(e(h))try{const a=ft();if(Object.keys(a).length===0){ke.info("No Changes","No fields were modified."),U();return}e(h).endpoint_type==="github"?await ce.updateGithubEndpoint(e(h).name,a):await ce.updateGiteaEndpoint(e(h).name,a),ke.success("Endpoint Updated",`Endpoint ${e(h).name} has been updated successfully.`),U()}catch(a){s(Ce,qe(a))}}async function xt(){if(e(D)){try{e(D).endpoint_type==="github"?await ce.deleteGithubEndpoint(e(D).name):await ce.deleteGiteaEndpoint(e(D).name),ke.success("Endpoint Deleted",`Endpoint ${e(D).name} has been deleted successfully.`)}catch(a){const n=qe(a);ke.error("Delete Failed",n)}U()}}function Se(a){const f=a.target.files?.[0];if(!f){b(t,e(t).ca_cert_bundle=""),s(B,"");return}s(B,f.name);const L=new FileReader;L.onload=d=>{const w=d.target?.result;b(t,e(t).ca_cert_bundle=btoa(w))},L.readAsText(f)}function Ve(){b(t,e(t).ca_cert_bundle=""),s(B,"");const a=document.getElementById("ca_cert_file");a&&(a.value="");const n=document.getElementById("edit_ca_cert_file");n&&(n.value="")}ae(()=>(e(le),X()),()=>{(!e(le).length||X().loaded.endpoints)&&s(le,X().endpoints)}),ae(()=>X(),()=>{s(we,X().loading.endpoints)}),ae(()=>X(),()=>{s(Ae,X().errorMessages.endpoints)}),ae(()=>(e(le),e(Ee)),()=>{s(Y,Nt(e(le),e(Ee)))}),ae(()=>(e(ie),e(Y),e(se),e(q)),()=>{s(ie,Math.ceil(e(Y).length/e(se))),e(q)>e(ie)&&e(ie)>0&&s(q,e(ie))}),ae(()=>(e(Y),e(q),e(se)),()=>{s(He,Ht(e(Y),e(q),e(se)))}),ae(()=>e(t),()=>{s(pe,!(!e(t).name||!e(t).base_url||e(t).endpoint_type==="github"&&!e(t).api_base_url))}),Tt(),Lt();var Oe=la();_("keydown",At,mt),Ut(a=>{Bt.title="Endpoints - GARM"});var Ge=xe(Oe),We=o(Ge);jt(We,{title:"Endpoints",description:"Manage your GitHub and Gitea endpoints for runner management.",actionLabel:"Add Endpoint",$$events:{action:_t}});var ht=r(We,2);{let a=Fe(()=>e(Ae)||e(Ce)),n=Fe(()=>!!e(Ae));St(ht,{get columns(){return it},get data(){return e(He)},get loading(){return e(we)},get error(){return e(a)},get searchTerm(){return e(Ee)},searchPlaceholder:"Search endpoints by name, description, or URL...",get currentPage(){return e(q)},get perPage(){return e(se)},get totalPages(){return e(ie)},get totalItems(){return e(Y),y(()=>e(Y).length)},itemName:"endpoints",emptyIconType:"settings",get showRetry(){return e(n)},get mobileCardConfig(){return nt},$$events:{search:dt,pageChange:ut,perPageChange:ct,retry:st,edit:pt,delete:bt},$$slots:{"mobile-card":(f,L)=>{const d=Fe(()=>L.item);var w=Wt(),M=o(w),G=o(M),I=o(G),$=o(I,!0);l(I);var C=r(I,2),N=o(C,!0);l(C);var j=r(C,2),H=o(j);Gt(H,()=>(he(ze),he(e(d)),y(()=>ze(e(d).endpoint_type||"","w-5 h-5"))));var S=r(H,2),ne=o(S,!0);l(S),l(j),l(G),l(M);var Z=r(M,2),W=o(Z);et(W,{action:"edit",size:"sm",title:"Edit endpoint",ariaLabel:"Edit endpoint",$$events:{click:()=>Be(e(d))}});var ee=r(W,2);et(ee,{action:"delete",size:"sm",title:"Delete endpoint",ariaLabel:"Delete endpoint",$$events:{click:()=>Ie(e(d))}}),l(Z),l(w),Q(()=>{V($,(he(e(d)),y(()=>e(d).name))),V(N,(he(e(d)),y(()=>e(d).description))),V(ne,(he(e(d)),y(()=>e(d).endpoint_type)))}),P(f,w)}}})}l(Ge);var Ke=r(Ge,2);{var kt=a=>{var n=Yt(),f=o(n),L=r(f,2),d=o(L),w=r(o(d),2);l(d);var M=r(d,2),G=o(M);Ft(G,{get selectedForgeType(){return e(O)},set selectedForgeType(u){s(O,u)},$$events:{select:gt},$$legacy:!0});var I=r(G,2),$=r(o(I),2);E($),l(I);var C=r(I,2),N=r(o(C),2);Qe(N),l(C);var j=r(C,2),H=r(o(j),2);E(H),l(j);var S=r(j,2);{var ne=u=>{var x=Kt(),i=xe(x),p=r(o(i),2);E(p),l(i);var c=r(i,2),g=r(o(c),2);E(g),l(c),R(p,()=>e(t).api_base_url,v=>b(t,e(t).api_base_url=v)),R(g,()=>e(t).upload_base_url,v=>b(t,e(t).upload_base_url=v)),P(u,x)},Z=u=>{var x=Jt(),i=xe(x),p=r(o(i),2);E(p),re(2),l(i);var c=r(i,2),g=o(c),v=o(g),A=r(v,2),F=o(A);$e(F,{title:"Tools Metadata URL",content:"URL where GARM checks for act_runner binary downloads and release information. Defaults to https://gitea.com/api/v1/repos/gitea/act_runner/releases if not specified. Use a custom URL to point to your own tools repository or mirror.",position:"top",width:"w-80"}),l(A),l(g);var K=r(g,2);E(K);var ge=r(K,2),te=o(ge,!0);l(ge),l(c);var ue=r(c,2),me=o(ue);E(me);var fe=r(me,4),ve=o(fe);$e(ve,{title:"Internal Tools Metadata",content:"When enabled, GARM uses built-in URLs for nightly act_runner binaries instead of calling the external tools metadata URL. This is useful in air-gapped environments where runner images already include the binaries and don't need to download them.",position:"top",width:"w-80"}),l(fe),l(ue),Q(()=>{z(v,1,`block text-sm font-medium ${e(t),y(()=>e(t).use_internal_tools_metadata?"text-gray-400 dark:text-gray-500":"text-gray-700 dark:text-gray-300")??""}`),K.disabled=(e(t),y(()=>e(t).use_internal_tools_metadata)),z(K,1,`w-full px-3 py-2 border rounded-md focus:outline-none transition-colors ${e(t),y(()=>e(t).use_internal_tools_metadata?"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-400 dark:text-gray-500 cursor-not-allowed":"border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white")??""}`),z(ge,1,`text-xs ${e(t),y(()=>e(t).use_internal_tools_metadata?"text-gray-400 dark:text-gray-500":"text-gray-500 dark:text-gray-400")??""} mt-1`),V(te,(e(t),y(()=>e(t).use_internal_tools_metadata?"Disabled when using internal tools metadata":"Leave empty to use default Gitea releases URL")))}),R(p,()=>e(t).api_base_url,J=>b(t,e(t).api_base_url=J)),R(K,()=>e(t).tools_metadata_url,J=>b(t,e(t).tools_metadata_url=J)),Ye(me,()=>e(t).use_internal_tools_metadata,J=>b(t,e(t).use_internal_tools_metadata=J)),P(u,x)};oe(S,u=>{e(O)==="github"?u(ne):u(Z,!1)})}var W=r(S,2),ee=r(o(W),2),de=o(ee),be=r(de,2);{var Me=u=>{var x=Qt(),i=r(o(x),2),p=o(i,!0);l(i);var c=r(i,2),g=o(c),v=r(g,4);l(c),l(x),Q(()=>V(p,e(B))),_("click",g,()=>document.getElementById("ca_cert_file")?.click()),_("click",v,Ve),P(u,x)},je=u=>{var x=Xt(),i=r(o(x),2),p=o(i);re(),l(i),re(2),l(x),_("click",p,()=>document.getElementById("ca_cert_file")?.click()),P(u,x)};oe(be,u=>{e(B)?u(Me):u(je,!1)})}l(ee),l(W);var Pe=r(W,2),Te=o(Pe),_e=r(Te,2);l(Pe),l(M),l(L),l(n),Q(()=>{Xe($,"placeholder",e(O)==="github"?"e.g., github-enterprise or github-com":"e.g., gitea-main or my-gitea"),Xe(H,"placeholder",e(O)==="github"?"https://github.com or https://github.example.com":"https://gitea.example.com"),z(ee,1,`border-2 border-dashed rounded-lg p-4 text-center transition-colors ${e(B)?"border-green-500 dark:border-green-400 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-400"}`),_e.disabled=!e(pe),z(_e,1,`px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors
							${e(pe)?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500 cursor-pointer":"bg-gray-400 cursor-not-allowed"}`)}),_("click",f,U),_("click",w,U),R($,()=>e(t).name,u=>b(t,e(t).name=u)),R(N,()=>e(t).description,u=>b(t,e(t).description=u)),R(H,()=>e(t).base_url,u=>b(t,e(t).base_url=u)),_("change",de,Se),_("click",Te,U),_("submit",M,Ze(vt)),P(a,n)};oe(Ke,a=>{e(Re)&&a(kt)})}var Je=r(Ke,2);{var wt=a=>{var n=ra(),f=o(n),L=r(f,2),d=o(L),w=o(d),M=o(w),G=o(M);l(M),re(2),l(w);var I=r(w,2);l(d);var $=r(d,2),C=o($),N=r(o(C),2);E(N),l(C);var j=r(C,2),H=r(o(j),2);Qe(H),l(j);var S=r(j,2),ne=r(o(S),2);E(ne),l(S);var Z=r(S,2);{var W=i=>{var p=Zt(),c=xe(p),g=r(o(c),2);E(g),l(c);var v=r(c,2),A=r(o(v),2);E(A),l(v),R(g,()=>e(t).api_base_url,F=>b(t,e(t).api_base_url=F)),R(A,()=>e(t).upload_base_url,F=>b(t,e(t).upload_base_url=F)),P(i,p)},ee=i=>{var p=ea(),c=xe(p),g=r(o(c),2);E(g),re(2),l(c);var v=r(c,2),A=o(v),F=o(A),K=r(F,2),ge=o(K);$e(ge,{title:"Tools Metadata URL",content:"URL where GARM checks for act_runner binary downloads and release information. Defaults to https://gitea.com/api/v1/repos/gitea/act_runner/releases if not specified. Use a custom URL to point to your own tools repository or mirror.",position:"top",width:"w-80"}),l(K),l(A);var te=r(A,2);E(te);var ue=r(te,2),me=o(ue,!0);l(ue),l(v);var fe=r(v,2),ve=o(fe);E(ve);var J=r(ve,4),Rt=o(J);$e(Rt,{title:"Internal Tools Metadata",content:"When enabled, GARM uses built-in URLs for nightly act_runner binaries instead of calling the external tools metadata URL. This is useful in air-gapped environments where runner images already include the binaries and don't need to download them.",position:"top",width:"w-80"}),l(J),l(fe),Q(()=>{z(F,1,`block text-sm font-medium ${e(t),y(()=>e(t).use_internal_tools_metadata?"text-gray-400 dark:text-gray-500":"text-gray-700 dark:text-gray-300")??""}`),te.disabled=(e(t),y(()=>e(t).use_internal_tools_metadata)),z(te,1,`w-full px-3 py-2 border rounded-md focus:outline-none transition-colors ${e(t),y(()=>e(t).use_internal_tools_metadata?"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-400 dark:text-gray-500 cursor-not-allowed":"border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white")??""}`),z(ue,1,`text-xs ${e(t),y(()=>e(t).use_internal_tools_metadata?"text-gray-400 dark:text-gray-500":"text-gray-500 dark:text-gray-400")??""} mt-1`),V(me,(e(t),y(()=>e(t).use_internal_tools_metadata?"Disabled when using internal tools metadata":"Leave empty to use default Gitea releases URL")))}),R(g,()=>e(t).api_base_url,ye=>b(t,e(t).api_base_url=ye)),R(te,()=>e(t).tools_metadata_url,ye=>b(t,e(t).tools_metadata_url=ye)),Ye(ve,()=>e(t).use_internal_tools_metadata,ye=>b(t,e(t).use_internal_tools_metadata=ye)),P(i,p)};oe(Z,i=>{e(h),y(()=>e(h).endpoint_type==="github")?i(W):i(ee,!1)})}var de=r(Z,2),be=r(o(de),2),Me=o(be),je=r(Me,2);{var Pe=i=>{var p=ta(),c=r(o(p),2),g=o(c,!0);l(c);var v=r(c,2),A=o(v),F=r(A,4);l(v),l(p),Q(()=>V(g,e(B))),_("click",A,()=>document.getElementById("edit_ca_cert_file")?.click()),_("click",F,Ve),P(i,p)},Te=i=>{var p=aa(),c=r(o(p),2),g=o(c);re(),l(c),re(2),l(p),_("click",g,()=>document.getElementById("edit_ca_cert_file")?.click()),P(i,p)};oe(je,i=>{e(B)?i(Pe):i(Te,!1)})}l(be),l(de);var _e=r(de,2),u=o(_e),x=r(u,2);l(_e),l($),l(L),l(n),Q(()=>{V(G,`Edit ${e(h),y(()=>e(h).endpoint_type==="github"?"GitHub":"Gitea")??""} Endpoint`),z(be,1,`border-2 border-dashed rounded-lg p-4 text-center transition-colors ${e(B)?"border-green-500 dark:border-green-400 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-400"}`),x.disabled=!e(pe),z(x,1,`px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors
							${e(pe)?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500 cursor-pointer":"bg-gray-400 cursor-not-allowed"}`)}),_("click",f,U),_("click",I,U),R(N,()=>e(t).name,i=>b(t,e(t).name=i)),R(H,()=>e(t).description,i=>b(t,e(t).description=i)),R(ne,()=>e(t).base_url,i=>b(t,e(t).base_url=i)),_("change",Me,Se),_("click",u,U),_("submit",$,Ze(yt)),P(a,n)};oe(Je,a=>{e(Ue)&&e(h)&&a(wt)})}var Ct=r(Je,2);{var Et=a=>{var n=oa(),f=o(n),L=r(f,2),d=o(L),w=o(d),M=r(o(w),2),G=r(o(M),2),I=o(G);l(G),l(M),l(w),l(d);var $=r(d,2),C=o($),N=r(C,2);l($),l(L),l(n),Q(()=>V(I,`Are you sure you want to delete the endpoint "${e(D),y(()=>e(D).name)??""}"? This action cannot be undone.`)),_("click",f,U),_("click",C,U),_("click",N,xt),P(a,n)};oe(Ct,a=>{e(Le)&&e(D)&&a(Et)})}P(at,Oe),$t(),lt()}export{Ea as component};
