import{c as fr,a as M,s as W,b as f,t as Je,d as Te,e as Pe,l as br,f as C,h as Fr}from"../chunks/CxOx-TIJ.js";import{i as mr}from"../chunks/3NxSoY2_.js";import{p as yr,B as qr,o as hr,g as e,m as d,i as g,j as t,x as Br,l as N,b as xr,f as Z,d as u,s as a,c as s,r as o,t as T,w as dt,v as Ve,u as h,h as _r,a as kr,n as A,y as Jr,e as ut,F as S,$ as Vr}from"../chunks/DzFKsO_V.js";import{i as w,s as wr,a as Sr,v as $r}from"../chunks/B_jyf0qs.js";import{w as Mr}from"../chunks/DoJxysSt.js";import{l as ur}from"../chunks/BAcG6-Ep.js";import{r as Y,b as We,d as Wr,c as gr,s as ct,g as G}from"../chunks/BguOOs3x.js";import{P as Kr}from"../chunks/DTko0dwG.js";import{e as Nt,i as Ft}from"../chunks/CdXRaxkX.js";import{b as pe,a as pr}from"../chunks/BVM1034P.js";import{p as Qr}from"../chunks/CdEA5IGF.js";import{M as Cr}from"../chunks/Pgjt70l7.js";import{J as Xr,U as Yr,a as Zr,b as ea}from"../chunks/BMieCrfV.js";import{e as oe}from"../chunks/BZiHL9L3.js";import{w as qt}from"../chunks/DSHGoHxX.js";import{e as gt,a as vr}from"../chunks/Penjr-j0.js";import{U as ta}from"../chunks/CZK5Ma2H.js";import{D as ra}from"../chunks/DL1RlOO9.js";import{D as aa,E as oa,G as Bt,P as sa,a as la,S as ia,A as na,L as da}from"../chunks/C2FKJqnN.js";import{t as Re}from"../chunks/li_-Mkq2.js";import{e as Ke,h as ca}from"../chunks/JkzpcrZD.js";i[S]="src/lib/components/CreateScaleSetModal.svelte";var ua=M(C('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),i[S],[[359,4,[[360,5]]]]),ga=M(C('<div class="animate-pulse bg-gray-200 dark:bg-gray-700 h-10 rounded"></div>'),i[S],[[433,8]]),pa=M(C("<option><!></option>"),i[S],[[443,10]]),va=M(C('<select id="entity" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option> </option><!></select>'),i[S],[[435,8,[[441,9]]]]),fa=M(C('<div class="animate-pulse bg-gray-200 dark:bg-gray-700 h-10 rounded"></div>'),i[S],[[459,8]]),ba=M(C("<option> </option>"),i[S],[[469,10]]),ma=M(C('<select id="provider" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>Select a provider</option><!></select>'),i[S],[[461,8,[[467,9]]]]),ya=M(C('<div class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 flex items-center"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"></div> <span class="text-sm text-gray-600 dark:text-gray-400">Loading templates...</span></div>'),i[S],[[543,7,[[544,8],[545,8]]]]),ha=M(C("<option> <!></option>"),i[S],[[554,9]]),xa=M(C('<select id="template" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"></select> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Templates define how the runner software is installed and configured. <!></p>',1),i[S],[[548,7],[560,7]]),_a=M(C('<div class="w-full px-3 py-2 border border-yellow-300 dark:border-yellow-600 rounded-md bg-yellow-50 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-200"><p class="text-sm"> </p> <p class="text-xs mt-1"><a class="text-yellow-700 dark:text-yellow-300 hover:underline">Create a template first</a> or proceed without a template to use default behavior.</p></div>'),i[S],[[567,7,[[568,8],[569,8,[[570,9]]]]]]),ka=M(C('<div class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-500 dark:text-gray-400"><p class="text-sm">Select an entity first to see available templates</p></div>'),i[S],[[576,7,[[577,8]]]]),wa=M(C('<button type="button" class="underline hover:text-yellow-800 dark:hover:text-yellow-300 cursor-pointer">Enable agent mode</button>'),i[S],[[719,10]]),Sa=M(C('<div class="ml-6 flex items-start space-x-2 text-xs text-yellow-700 dark:text-yellow-400"><svg class="w-4 h-4 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <span> <!></span></div>'),i[S],[[712,7,[[713,8,[[714,9]]],[716,8]]]]),$a=M(C('<div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Entity & Provider Configuration</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="entity" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"> <span class="text-red-500">*</span></label> <!></div> <div><label for="provider" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Provider <span class="text-red-500">*</span></label> <!></div></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Image & OS Configuration</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="image" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Image <span class="text-red-500">*</span></label> <input id="image" type="text" required placeholder="e.g., ubuntu:22.04" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="flavor" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Flavor <span class="text-red-500">*</span></label> <input id="flavor" type="text" required placeholder="e.g., default" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="osType" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">OS Type</label> <select id="osType" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>Linux</option><option>Windows</option></select></div> <div><label for="osArch" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Architecture</label> <select id="osArch" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>AMD64</option><option>ARM64</option></select></div></div> <div><label for="template" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Runner Install Template</label> <!></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Runner Limits & Timing</h3> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label for="minIdleRunners" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Min Idle Runners</label> <input id="minIdleRunners" type="number" min="0" placeholder="0" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="maxRunners" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Max Runners</label> <input id="maxRunners" type="number" min="1" placeholder="10" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="bootstrapTimeout" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Bootstrap Timeout (min)</label> <input id="bootstrapTimeout" type="number" min="1" placeholder="20" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Advanced Settings</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="runnerPrefix" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Runner Prefix</label> <input id="runnerPrefix" type="text" placeholder="garm" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="githubRunnerGroup" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">GitHub Runner Group (optional)</label> <input id="githubRunnerGroup" type="text" placeholder="Default group" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div></div> <div><div class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Extra Specs (JSON)</div> <!></div> <div class="flex items-center"><input id="enabled" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="enabled" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">Enable scale set immediately</label></div> <div class="space-y-2"><div class="flex items-center"><input id="enableShell" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded disabled:opacity-50 disabled:cursor-not-allowed"/> <label for="enableShell">Enable Shell</label> <div class="ml-2 relative group"><svg class="w-4 h-4 text-gray-400 cursor-help" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div class="absolute left-full top-1/2 transform -translate-y-1/2 ml-2 w-80 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">This enables remote shell in the GARM agent, allowing users to connect via garm-cli or web UI using websockets. <div class="absolute right-full top-1/2 transform -translate-y-1/2 border-4 border-transparent border-r-gray-900"></div></div></div></div> <!></div></div>',1),i[S],[[423,4,[[424,5],[427,5,[[428,6,[[429,7,[[430,69]]]]],[454,6,[[455,7,[[456,17]]]]]]]]],[478,4,[[479,5],[482,5,[[483,6,[[484,7,[[485,14]]],[487,7]]],[496,6,[[497,7,[[498,15]]],[500,7]]],[509,6,[[510,7],[513,7,[[518,8],[519,8]]]]],[522,6,[[523,7],[526,7,[[531,8],[532,8]]]]]]],[538,5,[[539,6]]]]],[584,4,[[585,5],[588,5,[[589,6,[[590,7],[593,7]]],[602,6,[[603,7],[606,7]]],[615,6,[[616,7],[619,7]]]]]]],[632,4,[[633,5],[636,5,[[637,6,[[638,7],[641,7]]],[649,6,[[650,7],[653,7]]]]],[664,5,[[665,6]]],[676,5,[[677,6],[683,6]]],[689,5,[[690,6,[[691,7],[698,7],[701,7,[[702,8,[[703,9]]],[705,8,[[707,9]]]]]]]]]]]]),Ma=M(C('<div class="flex items-center"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div> Creating...</div>'),i[S],[[749,6,[[750,7]]]]),Ca=M(C('<div class="max-w-6xl w-full max-h-[90vh] overflow-y-auto"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700"><h2 class="text-xl font-semibold text-gray-900 dark:text-white">Create New Scale Set</h2> <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Scale sets are only available for GitHub endpoints</p></div> <form class="p-6 space-y-6"><!> <div><label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Name <span class="text-red-500">*</span></label> <input id="name" type="text" required placeholder="e.g., my-scale-set" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><fieldset><legend class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Entity Level <span class="text-red-500">*</span></legend> <div class="grid grid-cols-3 gap-4"><button type="button"><svg class="w-8 h-8 mb-2 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"></path></svg> <span class="text-sm font-medium text-gray-900 dark:text-white">Repository</span></button> <button type="button"><svg class="w-8 h-8 mb-2 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <span class="text-sm font-medium text-gray-900 dark:text-white">Organization</span></button> <button type="button"><svg class="w-8 h-8 mb-2 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg> <span class="text-sm font-medium text-gray-900 dark:text-white">Enterprise</span></button></div></fieldset></div> <!> <div class="flex justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer">Cancel</button> <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer"><!></button></div></form></div>'),i[S],[[351,1,[[352,2,[[353,3],[354,3]]],[357,2,[[365,3,[[366,4,[[367,10]]],[369,4]]],[380,3,[[381,4,[[382,5,[[383,19]]],[385,5,[[386,5,[[391,6,[[392,7],[393,7]]],[395,6]]],[397,5,[[402,6,[[403,7]]],[405,6]]],[407,5,[[412,6,[[413,7]]],[415,6]]]]]]]]],[735,3,[[736,4],[743,4]]]]]]]]),Ea=M(C("<!> <!>",1),i[S],[]);function i(pt,vt){fr(new.target),yr(vt,!1,i);const[ft,bt]=wr(),B=()=>($r(gt,"eagerCache"),Sr(gt,"$eagerCache",ft)),ve=d(),P=d(),K=qr();let se=d(!1),L=d(""),c=d(""),R=d([]),le=d([]),$=d([]),J=d(!1),ie=d(!1),ne=d(!1),V=d(!1),m=d(null),ee=d(""),p=d(""),de=d(""),fe=d(""),be=d(""),xe=d(void 0),_e=d(void 0),ze=d(void 0),Ae=d("garm"),H=d("linux"),ke=d("amd64"),De=d(""),Ue=d(!0),we=d(!1),me=d("{}"),F=d(void 0);async function Ie(){try{t(ie,!0),t(le,(await A(G.listProviders()))())}catch(n){t(L,oe(n))}finally{t(ie,!1)}}async function Le(){try{t(ne,!0);const n=je();if(!n){t($,[]);return}if(t($,(await A(G.listTemplates(e(H),void 0,n)))()),!e(F)||!e($).find(v=>g(v.id,e(F)))){const v=e($).find(_=>g(_.owner_id,"system"));v?t(F,v.id):e($).length>0&&t(F,e($)[0].id)}}catch(n){t(L,oe(n))}finally{t(ne,!1)}}function je(){if(!e(p)||!e(R))return null;const n=e(R).find(v=>g(v.id,e(p)));if(!n)return null;if("forge_type"in n)return n.forge_type;if("endpoint"in n){const v=n.endpoint;if(v&&"endpoint_type"in v)return v.endpoint_type||null}return"github"}function ye(){if(!e(p)||!e(R))return!1;const n=e(R).find(v=>g(v.id,e(p)));return n&&"agent_mode"in n?n.agent_mode??!1:!1}async function Qe(){if(e(c))try{switch(t(J,!0),t(R,[]),e(c)){case"repository":t(R,(await A(G.listRepositories()))());break;case"organization":t(R,(await A(G.listOrganizations()))());break;case"enterprise":t(R,(await A(G.listEnterprises()))());break}}catch(n){t(L,oe(n))}finally{t(J,!1)}}function Se(n){g(e(c),n)||(t(c,n),t(p,""),t(F,void 0),Qe())}function Xe(n){if(g(n.operation,"update",!1))return;const v=n.payload;if(g(e(c),"repository")&&g(v.id,e(p))){const _=B().repositories.find(q=>g(q.id,e(p)));_&&(Object.assign(_,v),t(P,ye()))}else if(g(e(c),"organization")&&g(v.id,e(p))){const _=B().organizations.find(q=>g(q.id,e(p)));_&&(Object.assign(_,v),t(P,ye()))}else if(g(e(c),"enterprise")&&g(v.id,e(p))){const _=B().enterprises.find(q=>g(q.id,e(p)));_&&(Object.assign(_,v),t(P,ye()))}}async function $e(n){if(!(!e(p)||!e(c)))try{switch(e(c)){case"repository":(await A(G.updateRepository(e(p),n)))();break;case"organization":(await A(G.updateOrganization(e(p),n)))();break;case"enterprise":(await A(G.updateEnterprise(e(p),n)))();break}(await A(Qe()))(),t(V,!1)}catch(v){throw v}}function mt(){return!e(p)||!e(R)?null:e(R).find(n=>g(n.id,e(p)))||null}async function yt(){if(!e(ve)){t(L,"Please fill in all required fields");return}try{t(se,!0),t(L,"");let n={};if(e(me).trim())try{n=JSON.parse(e(me))}catch{throw new Error("Invalid JSON in extra specs")}const v={name:e(ee),provider_name:e(de),image:e(fe),flavor:e(be),max_runners:e(xe)||10,min_idle_runners:e(_e)||0,runner_bootstrap_timeout:e(ze)||20,runner_prefix:e(Ae),os_type:e(H),os_arch:e(ke),"github-runner-group":e(De)||void 0,enabled:e(Ue),enable_shell:e(we),extra_specs:e(me).trim()?n:void 0,template_id:e(F)};let _;switch(e(c)){case"repository":_=(await A(G.createRepositoryScaleSet(e(p),v)))();break;case"organization":_=(await A(G.createOrganizationScaleSet(e(p),v)))();break;case"enterprise":_=(await A(G.createEnterpriseScaleSet(e(p),v)))();break;default:throw new Error("Invalid entity level selected")}K("submit",_)}catch(n){t(L,oe(n))}finally{t(se,!1)}}hr(()=>{Ie(),e(c)&&(g(e(c),"repository")||g(e(c),"organization")||g(e(c),"enterprise"))&&t(m,qt.subscribeToEntity(e(c),["update"],Xe))}),Br(()=>{e(m)&&(e(m)(),t(m,null))}),N(()=>(e(se),e(ee),e(c),e(p),e(de),e(fe),e(be)),()=>{t(ve,!e(se)&&g(e(ee).trim(),"",!1)&&g(e(c),"",!1)&&g(e(p),"",!1)&&g(e(de),"",!1)&&g(e(fe).trim(),"",!1)&&g(e(be).trim(),"",!1))}),N(()=>{},()=>{t(P,ye())}),N(()=>e(P),()=>{e(P)||t(we,!1)}),N(()=>(e(p),e(H)),()=>{e(p)&&e(H)&&Le()}),N(()=>(e(H),e(p)),()=>{e(H)&&e(p)&&Le()}),N(()=>(e(c),e(m),qt),()=>{e(c)&&(g(e(c),"repository")||g(e(c),"organization")||g(e(c),"enterprise"))&&(e(m)&&e(m)(),t(m,qt.subscribeToEntity(e(c),["update"],Xe)))}),xr(),mr();var Ye=Ea(),Ze=Z(Ye);u(()=>Cr(Ze,{$$events:{close:()=>K("close")},children:Mr(i,(n,v)=>{var _=Ca(),q=a(s(_),2),et=s(q);{var Oe=D=>{var Q=ua(),Ee=s(Q),lt=s(Ee,!0);o(Ee),o(Q),T(()=>W(lt,e(L))),f(D,Q)};u(()=>w(et,D=>{e(L)&&D(Oe)}),"if",i,358,3)}var Ce=a(et,2),tt=a(s(Ce),2);Y(tt),o(Ce);var Ge=a(Ce,2),rt=s(Ge),te=a(s(rt),2),ce=s(te),He=a(ce,2),at=a(He,2);o(te),o(rt),o(Ge);var ot=a(Ge,2);{var ue=D=>{var Q=$a(),Ee=Z(Q),lt=a(s(Ee),2),xt=s(lt),_t=s(xt),Tr=s(_t);dt(),o(_t);var Pr=a(_t,2);{var Rr=l=>{var k=ga();f(l,k)},zr=l=>{var k=va();T(()=>{e(p),Ve(()=>{e(c),e(R)})});var O=s(k),ge=s(O);o(O),O.value=O.__value="";var re=a(O);u(()=>Nt(re,1,()=>e(R),Ft,(E,b)=>{var z=pa(),ae=s(z);{var qe=y=>{var j=Je();T(()=>W(j,`${e(b),h(()=>e(b).owner)??""}/${e(b),h(()=>e(b).name)??""} (${e(b),h(()=>e(b).endpoint?.name||"Unknown endpoint")??""})`)),f(y,j)},X=y=>{var j=Je();T(()=>W(j,`${e(b),h(()=>e(b).name)??""} (${e(b),h(()=>e(b).endpoint?.name||"Unknown endpoint")??""})`)),f(y,j)};u(()=>w(ae,y=>{g(e(c),"repository")?y(qe):y(X,!1)}),"if",i,444,11)}o(z);var U={};T(()=>{U!==(U=(e(b),h(()=>e(b).id)))&&(z.value=(z.__value=(e(b),h(()=>e(b).id)))??"")}),f(E,z)}),"each",i,442,9),o(k),T(()=>W(ge,`Select a ${e(c)??""}`)),We(k,()=>e(p),E=>t(p,E)),f(l,k)};u(()=>w(Pr,l=>{e(J)?l(Rr):l(zr,!1)}),"if",i,432,7)}o(xt);var Jt=a(xt,2),Ar=a(s(Jt),2);{var Dr=l=>{var k=fa();f(l,k)},Ur=l=>{var k=ma();T(()=>{e(de),Ve(()=>{e(le)})});var O=s(k);O.value=O.__value="";var ge=a(O);u(()=>Nt(ge,1,()=>e(le),Ft,(re,E)=>{var b=ba(),z=s(b,!0);o(b);var ae={};T(()=>{W(z,(e(E),h(()=>e(E).name))),ae!==(ae=(e(E),h(()=>e(E).name)))&&(b.value=(b.__value=(e(E),h(()=>e(E).name)))??"")}),f(re,b)}),"each",i,468,9),o(k),We(k,()=>e(de),re=>t(de,re)),f(l,k)};u(()=>w(Ar,l=>{e(ie)?l(Dr):l(Ur,!1)}),"if",i,458,7)}o(Jt),o(lt),o(Ee);var kt=a(Ee,2),wt=a(s(kt),2),St=s(wt),Vt=a(s(St),2);Y(Vt),o(St);var $t=a(St,2),Wt=a(s($t),2);Y(Wt),o($t);var Mt=a($t,2),Ct=a(s(Mt),2);T(()=>{e(H),Ve(()=>{})});var Et=s(Ct);Et.value=Et.__value="linux";var Kt=a(Et);Kt.value=Kt.__value="windows",o(Ct),o(Mt);var Qt=a(Mt,2),Tt=a(s(Qt),2);T(()=>{e(ke),Ve(()=>{})});var Pt=s(Tt);Pt.value=Pt.__value="amd64";var Xt=a(Pt);Xt.value=Xt.__value="arm64",o(Tt),o(Qt),o(wt);var Yt=a(wt,2),Ir=a(s(Yt),2);{var Lr=l=>{var k=ya();f(l,k)},jr=l=>{var k=Te(),O=Z(k);{var ge=E=>{var b=xa(),z=Z(b);T(()=>{e(F),Ve(()=>{e($)})}),u(()=>Nt(z,5,()=>e($),Ft,(U,y)=>{var j=ha(),Be=s(j),Ot=a(Be);{var Gt=Ht=>{var cr=Je();T(()=>W(cr,`- ${e(y),h(()=>e(y).description)??""}`)),f(Ht,cr)};u(()=>w(Ot,Ht=>{e(y),h(()=>e(y).description)&&Ht(Gt)}),"if",i,556,10)}o(j);var nt={};T(()=>{W(Be,`${e(y),h(()=>e(y).name)??""} ${e(y),h(()=>g(e(y).owner_id,"system")?"(System)":"")??""} `),nt!==(nt=(e(y),h(()=>e(y).id)))&&(j.value=(j.__value=(e(y),h(()=>e(y).id)))??"")}),f(U,j)}),"each",i,553,8),o(z);var ae=a(z,2),qe=a(s(ae));{var X=U=>{var y=Je();T(j=>W(y,`Showing templates for ${j??""} ${e(H)??""}.`),[()=>h(je)]),f(U,y)};u(()=>w(qe,U=>{e(p)&&U(X)}),"if",i,562,8)}o(ae),We(z,()=>e(F),U=>t(F,U)),f(E,b)},re=E=>{var b=Te(),z=Z(b);{var ae=X=>{var U=_a(),y=s(U),j=s(y);o(y);var Be=a(y,2),Ot=s(Be);dt(),o(Be),o(U),T((Gt,nt)=>{W(j,`No templates found for ${Gt??""} ${e(H)??""}.`),Wr(Ot,"href",nt)},[()=>h(je),()=>(_r(gr),h(()=>gr("/templates")))]),f(X,U)},qe=X=>{var U=ka();f(X,U)};u(()=>w(z,X=>{e(p)?X(ae):X(qe,!1)},!0),"if",i,566,6)}f(E,b)};u(()=>w(O,E=>{e($),h(()=>e($).length>0)?E(ge):E(re,!1)},!0),"if",i,547,6)}f(l,k)};u(()=>w(Ir,l=>{e(ne)?l(Lr):l(jr,!1)}),"if",i,542,6)}o(Yt),o(kt);var Rt=a(kt,2),Zt=a(s(Rt),2),zt=s(Zt),er=a(s(zt),2);Y(er),o(zt);var At=a(zt,2),tr=a(s(At),2);Y(tr),o(At);var rr=a(At,2),ar=a(s(rr),2);Y(ar),o(rr),o(Zt),o(Rt);var or=a(Rt,2),Dt=a(s(or),2),Ut=s(Dt),sr=a(s(Ut),2);Y(sr),o(Ut);var lr=a(Ut,2),ir=a(s(lr),2);Y(ir),o(lr),o(Dt);var It=a(Dt,2),Or=a(s(It),2);u(()=>Xr(Or,{rows:4,placeholder:"{}",get value(){return e(me)},set value(l){t(me,l)},$$legacy:!0}),"component",i,668,6,{componentTag:"JsonEditor"}),o(It);var Lt=a(It,2),nr=s(Lt);Y(nr),dt(2),o(Lt);var dr=a(Lt,2),jt=s(dr),it=s(jt);Y(it);var Gr=a(it,2);dt(2),o(jt);var Hr=a(jt,2);{var Nr=l=>{var k=Sa(),O=a(s(k),2),ge=s(O),re=a(ge);{var E=b=>{var z=wa();Pe("click",z,()=>t(V,!0)),f(b,z)};u(()=>w(re,b=>{e(p)&&b(E)}),"if",i,718,9)}o(O),o(k),T(()=>W(ge,`Shell access requires agent mode to be enabled on the ${e(c)??""}. `)),f(l,k)};u(()=>w(Hr,l=>{e(P)||l(Nr)}),"if",i,711,6)}o(dr),o(or),T(l=>{W(Tr,`${l??""} `),it.disabled=!e(P),ct(Gr,1,`ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300 ${e(P)?"":"opacity-50"}`)},[()=>(e(c),h(()=>e(c).charAt(0).toUpperCase()+e(c).slice(1)))]),pe(Vt,()=>e(fe),l=>t(fe,l)),pe(Wt,()=>e(be),l=>t(be,l)),We(Ct,()=>e(H),l=>t(H,l)),We(Tt,()=>e(ke),l=>t(ke,l)),pe(er,()=>e(_e),l=>t(_e,l)),pe(tr,()=>e(xe),l=>t(xe,l)),pe(ar,()=>e(ze),l=>t(ze,l)),pe(sr,()=>e(Ae),l=>t(Ae,l)),pe(ir,()=>e(De),l=>t(De,l)),pr(nr,()=>e(Ue),l=>t(Ue,l)),pr(it,()=>e(we),l=>t(we,l)),f(D,Q)};u(()=>w(ot,D=>{e(c)&&D(ue)}),"if",i,421,3)}var he=a(ot,2),st=s(he),Ne=a(st,2),Fe=s(Ne);{var ht=D=>{var Q=Ma();f(D,Q)},Er=D=>{var Q=Je("Create Scale Set");f(D,Q)};u(()=>w(Fe,D=>{e(se)?D(ht):D(Er,!1)}),"if",i,748,5)}o(Ne),o(he),o(q),o(_),T(()=>{ct(ce,1,`flex flex-col items-center justify-center p-4 border-2 rounded-lg transition-colors cursor-pointer ${g(e(c),"repository")?"border-blue-500 bg-blue-50 dark:bg-blue-900":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`),ct(He,1,`flex flex-col items-center justify-center p-4 border-2 rounded-lg transition-colors cursor-pointer ${g(e(c),"organization")?"border-blue-500 bg-blue-50 dark:bg-blue-900":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`),ct(at,1,`flex flex-col items-center justify-center p-4 border-2 rounded-lg transition-colors cursor-pointer ${g(e(c),"enterprise")?"border-blue-500 bg-blue-50 dark:bg-blue-900":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`),Ne.disabled=!e(ve)}),pe(tt,()=>e(ee),D=>t(ee,D)),Pe("click",ce,()=>Se("repository")),Pe("click",He,()=>Se("organization")),Pe("click",at,()=>Se("enterprise")),Pe("click",st,()=>K("close")),Pe("submit",q,Qr(yt)),f(n,_)}),$$slots:{default:!0}}),"component",i,350,0,{componentTag:"Modal"});var r=a(Ze,2);{var x=n=>{const v=Jr(ut(()=>h(mt)),"selectedEntity");e(v);var _=Te(),q=Z(_);{var et=Oe=>{var Ce=Te(),tt=Z(Ce);{var Ge=te=>{u(()=>Yr(te,{get repository(){return e(v)},$$events:{close:()=>t(V,!1),submit:ce=>$e(ce.detail)}}),"component",i,767,3,{componentTag:"UpdateRepositoryModal"})},rt=te=>{var ce=Te(),He=Z(ce);{var at=ue=>{u(()=>Zr(ue,{get organization(){return e(v)},$$events:{close:()=>t(V,!1),submit:he=>$e(he.detail)}}),"component",i,773,3,{componentTag:"UpdateOrganizationModal"})},ot=ue=>{var he=Te(),st=Z(he);{var Ne=Fe=>{u(()=>ea(Fe,{get enterprise(){return e(v)},$$events:{close:()=>t(V,!1),submit:ht=>$e(ht.detail)}}),"component",i,779,3,{componentTag:"UpdateEnterpriseModal"})};u(()=>w(st,Fe=>{g(e(c),"enterprise")&&Fe(Ne)},!0),"if",i,778,2)}f(ue,he)};u(()=>w(He,ue=>{g(e(c),"organization")?ue(at):ue(ot,!1)},!0),"if",i,772,2)}f(te,ce)};u(()=>w(tt,te=>{g(e(c),"repository")?te(Ge):te(rt,!1)}),"if",i,766,2)}f(Oe,Ce)};u(()=>w(q,Oe=>{e(v)&&Oe(et)}),"if",i,765,1)}f(n,_)};u(()=>w(r,n=>{e(V)&&e(p)&&n(x)}),"if",i,763,0)}f(pt,Ye);var Me=kr({...br()});return bt(),Me}const Ta={};I[S]="src/routes/scalesets/+page.svelte";var Pa=M(C('<div class="p-6"><!></div>'),I[S],[[345,2]]),Ra=M(C('<div class="space-y-6"><!> <!></div> <!> <!> <!> <!>',1),I[S],[[283,0]]);function I(pt,vt){fr(new.target),yr(vt,!1,I);const[ft,bt]=wr(),B=()=>($r(gt,"eagerCache"),Sr(gt,"$eagerCache",ft)),ve=d(),P=d(),K=d(),se=d();let L=d([]),c=d(!0),R=d(""),le=d(""),$=d(1),J=d(25),ie=d(!1),ne=d(!1),V=d(!1),m=d(null),ee=d(!1);async function p(r){try{t(R,""),t(ie,!1),Re.success("Scale Set Created","Scale set has been created successfully.")}catch(x){throw t(R,oe(x)),x}}async function de(r){if(e(m))try{(await A(G.updateScaleSet(e(m).id,r)))(),Re.success("Scale Set Updated",`Scale set ${e(m).name} has been updated successfully.`),t(ne,!1),t(m,null)}catch(x){const Me=oe(x);throw Re.error("Update Failed",Me),x}}async function fe(){if(e(m))try{(await A(G.deleteScaleSet(e(m).id)))(),Re.success("Scale Set Deleted",`Scale set ${e(m).name} has been deleted successfully.`)}catch(r){const x=oe(r);Re.error("Delete Failed",x)}finally{t(V,!1),t(m,null)}}function be(){t(ie,!0)}async function xe(r){try{t(ee,!0);const x=(await A(G.getScaleSet(r.id)))();t(m,x),t(ne,!0)}catch(x){const Me=oe(x);Re.error("Failed to Load Scale Set Details",Me)}finally{t(ee,!1)}}function _e(r){t(m,r),t(V,!0)}hr(async()=>{try{t(c,!0);const r=(await A(vr.getScaleSets()))();r&&Array.isArray(r)&&t(L,r)}catch(r){Ta?.VITEST||console.error(...ur("error","Failed to load scale sets:",r)),t(R,oe(r))}finally{t(c,!1)}});async function ze(){try{(await A(vr.retryResource("scalesets")))()}catch(r){console.error(...ur("error","Retry failed:",r))}}const Ae=[{key:"name",title:"Name",cellComponent:oa,cellProps:{entityType:"scaleset"}},{key:"image",title:"Image",cellComponent:Bt,cellProps:{field:"image",type:"code",showTitle:!0}},{key:"provider",title:"Provider",cellComponent:Bt,cellProps:{field:"provider_name"}},{key:"flavor",title:"Flavor",cellComponent:Bt,cellProps:{field:"flavor"}},{key:"entity",title:"Entity",cellComponent:sa},{key:"endpoint",title:"Endpoint",cellComponent:la},{key:"status",title:"Status",cellComponent:ia,cellProps:{statusType:"enabled"}},{key:"actions",title:"Actions",align:"right",cellComponent:na}],H={entityType:"scaleset",primaryText:{field:"name",isClickable:!0,href:"/scalesets/{id}"},secondaryText:{field:"entity_name",computedValue:r=>Ke(r)},badges:[{type:"custom",value:r=>({variant:r.enabled?"success":"error",text:r.enabled?"Enabled":"Disabled"})}],actions:[{type:"edit",handler:r=>xe(r)},{type:"delete",handler:r=>_e(r)}]};function ke(r){t(le,r.detail.term),t($,1)}function De(r){t($,r.detail.page)}function Ue(r){t(J,r.detail.perPage),t($,1)}function we(r){xe(r.detail.item)}function me(r){_e(r.detail.item)}N(()=>(e(L),B()),()=>{(!e(L).length||B().loaded.scalesets)&&t(L,B().scalesets)}),N(()=>B(),()=>{t(c,B().loading.scalesets)}),N(()=>B(),()=>{t(ve,B().errorMessages.scalesets)}),N(()=>(e(L),e(le),Ke),()=>{t(P,ca(e(L),e(le),r=>Ke(r)))}),N(()=>(e(P),e(J)),()=>{t(K,Math.ceil(e(P).length/e(J)))}),N(()=>(e($),e(K)),()=>{e($)>e(K)&&e(K)>0&&t($,e(K))}),N(()=>(e(P),e($),e(J)),()=>{t(se,e(P).slice((e($)-1)*e(J),e($)*e(J)))}),xr(),mr();var F=Ra();Fr(r=>{Vr.title="Scale Sets - GARM"});var Ie=Z(F),Le=s(Ie);u(()=>Kr(Le,{title:"Scale Sets",description:"Manage GitHub runner scale sets",actionLabel:"Add Scale Set",$$events:{action:be}}),"component",I,285,1,{componentTag:"PageHeader"});var je=a(Le,2);{let r=ut(()=>e(ve)||e(R)),x=ut(()=>!!e(ve));u(()=>aa(je,{get columns(){return Ae},get data(){return e(se)},get loading(){return e(c)},get error(){return e(r)},get searchTerm(){return e(le)},searchPlaceholder:"Search by entity name...",get currentPage(){return e($)},get perPage(){return e(J)},get totalPages(){return e(K)},get totalItems(){return e(P),h(()=>e(P).length)},itemName:"scale sets",emptyIconType:"cog",get showRetry(){return e(x)},get mobileCardConfig(){return H},$$events:{search:ke,pageChange:De,perPageChange:Ue,retry:ze,edit:we,delete:me}}),"component",I,292,1,{componentTag:"DataTable"})}o(Ie);var ye=a(Ie,2);{var Qe=r=>{u(()=>i(r,{$$events:{close:()=>t(ie,!1),submit:x=>p(x.detail)}}),"component",I,318,1,{componentTag:"CreateScaleSetModal"})};u(()=>w(ye,r=>{e(ie)&&r(Qe)}),"if",I,317,0)}var Se=a(ye,2);{var Xe=r=>{u(()=>ta(r,{get scaleSet(){return e(m)},$$events:{close:()=>{t(ne,!1),t(m,null)},submit:x=>de(x.detail)}}),"component",I,325,1,{componentTag:"UpdateScaleSetModal"})};u(()=>w(Se,r=>{e(ne)&&e(m)&&r(Xe)}),"if",I,324,0)}var $e=a(Se,2);{var mt=r=>{{let x=ut(()=>(e(m),_r(Ke),h(()=>`Scale Set ${e(m).name} (${Ke(e(m))})`)));u(()=>ra(r,{title:"Delete Scale Set",message:"Are you sure you want to delete this scale set? This action cannot be undone and will remove all associated runners.",get itemName(){return e(x)},$$events:{close:()=>{t(V,!1),t(m,null)},confirm:fe}}),"component",I,333,1,{componentTag:"DeleteModal"})}};u(()=>w($e,r=>{e(V)&&e(m)&&r(mt)}),"if",I,332,0)}var yt=a($e,2);{var Ye=r=>{u(()=>Cr(r,{$$events:{close:()=>{}},children:Mr(I,(x,Me)=>{var n=Pa(),v=s(n);u(()=>da(v,{message:"Loading scale set details..."}),"component",I,346,3,{componentTag:"LoadingState"}),o(n),f(x,n)}),$$slots:{default:!0}}),"component",I,344,1,{componentTag:"Modal"})};u(()=>w(yt,r=>{e(ee)&&r(Ye)}),"if",I,343,0)}f(pt,F);var Ze=kr({...br()});return bt(),Ze}export{I as component};
