import{c as Dt,a as I,e as m,h as Ft,b as B,l as Gt,s as Q,f as D,r as at}from"../chunks/CxOx-TIJ.js";import{i as jt}from"../chunks/3NxSoY2_.js";import{p as zt,g as e,o as qt,l as ie,b as Nt,f as Te,d as w,a as Ht,m as v,q as St,$ as Vt,c as o,s as r,e as Ve,r as s,u as h,h as Re,t as te,F as M,j as n,k as g,i,n as ae,w as de}from"../chunks/DzFKsO_V.js";import{s as Ot,a as Wt,i as ue,v as Kt}from"../chunks/B_jyf0qs.js";import{h as Jt,r as U,d as rt,s as V,g as fe}from"../chunks/BguOOs3x.js";import{b as L,a as ot}from"../chunks/BVM1034P.js";import{p as st}from"../chunks/CdEA5IGF.js";import{l as nt}from"../chunks/BAcG6-Ep.js";import{P as Qt}from"../chunks/DTko0dwG.js";import{F as Xt}from"../chunks/DvQW-lMP.js";import{A as lt}from"../chunks/Ct5kWObc.js";import{e as it,a as dt}from"../chunks/Penjr-j0.js";import{t as Ue}from"../chunks/li_-Mkq2.js";import{g as Oe,c as Yt,a as Zt,p as ea}from"../chunks/JkzpcrZD.js";import{e as We}from"../chunks/BZiHL9L3.js";import{D as ta,G as Ke,a as aa,A as ra}from"../chunks/C2FKJqnN.js";import{T as Ge}from"../chunks/Cy4PP0DI.js";d[M]="src/routes/endpoints/+page.svelte";var oa=I(D('<div class="flex items-center justify-between"><div class="flex-1 min-w-0"><div class="block"><p class="text-sm font-medium text-gray-900 dark:text-white truncate"> </p> <p class="text-sm text-gray-500 dark:text-gray-400 truncate mt-1"> </p> <div class="flex items-center mt-2"><!> <span class="ml-2 text-xs text-gray-500 dark:text-gray-400 capitalize"> </span></div></div></div> <div class="flex space-x-2 ml-4"><!> <!></div></div>'),d[M],[[497,3,[[498,4,[[499,5,[[500,6],[503,6],[506,6,[[508,7]]]]]]],[512,4]]]]),sa=I(D('<div><label for="api_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">API Base URL <span class="text-red-500">*</span></label> <input type="url" id="api_base_url" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="https://api.github.com or https://github.example.com/api/v3"/></div> <div><label for="upload_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Upload Base URL</label> <input type="url" id="upload_base_url" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="https://uploads.github.com"/></div>',1),d[M],[[606,5,[[607,6,[[608,20]]],[610,6]]],[621,5,[[622,6],[625,6]]]]),na=I(D('<div><label for="api_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">API Base URL <span class="text-xs text-gray-500">(optional)</span></label> <input type="url" id="api_base_url" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="https://gitea.example.com/api/v1 (leave empty to use Base URL)"/> <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">If empty, Base URL will be used as API Base URL</p></div> <div><div class="flex items-center mb-1"><label for="tools_metadata_url">Tools Metadata URL <span class="text-xs text-gray-500">(optional)</span></label> <div class="ml-2"><!></div></div> <input type="url" id="tools_metadata_url" autocomplete="off" placeholder="https://gitea.com/api/v1/repos/gitea/act_runner/releases"/> <p> </p></div> <div class="flex items-center"><input id="use_internal_tools_metadata" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="use_internal_tools_metadata" class="ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Use Internal Tools Metadata</label> <div class="ml-2"><!></div></div>',1),d[M],[[635,5,[[636,6,[[637,20]]],[639,6],[647,6]]],[651,5,[[652,6,[[653,7,[[654,27]]],[656,7]]],[665,6],[674,6]]],[677,5,[[678,6],[684,6],[687,6]]]]),la=I(D('<div class="space-y-2"><svg class="mx-auto h-8 w-8 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="text-sm font-medium text-green-700 dark:text-green-300"> </p> <div class="flex justify-center space-x-2"><button type="button" class="text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline cursor-pointer">Replace</button> <span class="text-xs text-gray-400">•</span> <button type="button" class="text-xs text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 hover:underline cursor-pointer">Remove</button></div></div>'),d[M],[[710,7,[[711,8,[[712,9]]],[714,8],[717,8,[[718,9],[721,9],[722,9]]]]]]),ia=I(D('<div class="space-y-2"><svg class="mx-auto h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-sm text-gray-600 dark:text-gray-400"><button type="button" class="text-gray-900 dark:text-white hover:text-gray-700 dark:hover:text-gray-300 hover:underline cursor-pointer">Choose a file</button> or drag and drop</p> <p class="text-xs text-gray-500 dark:text-gray-400">PEM, CRT, CER, CERT files only</p></div>'),d[M],[[728,7,[[729,8,[[730,9]]],[732,8,[[733,9]]],[738,8]]]]),da=I(D('<div class="fixed inset-0 flex items-center justify-center z-50" role="dialog" aria-modal="true"><button class="fixed inset-0 w-full h-full bg-black/30 dark:bg-black/50 cursor-default" aria-label="Close modal"></button> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto relative z-10" role="document"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"><div><h3 class="text-lg font-semibold text-gray-900 dark:text-white">Add Endpoint</h3> <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Connect to GitHub or Gitea for runner management</p></div> <button class="text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100 cursor-pointer" aria-label="Close modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-6 space-y-4"><!> <div><label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Endpoint Name <span class="text-red-500">*</span></label> <input type="text" id="name" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <div><label for="description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label> <textarea id="description" rows="2" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Brief description of this endpoint"></textarea></div> <div><label for="base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Base URL <span class="text-red-500">*</span></label> <input type="url" id="base_url" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <!> <div class="space-y-3 border-t border-gray-200 dark:border-gray-700 pt-4"><label for="ca_cert_file" class="block text-sm font-medium text-gray-700 dark:text-gray-300">CA Certificate Bundle (Optional)</label> <div><input type="file" id="ca_cert_file" accept=".pem,.crt,.cer,.cert" class="hidden"/> <!></div></div> <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 cursor-pointer">Cancel</button> <button type="submit">Create Endpoint</button></div></form></div></div>'),d[M],[[536,1,[[537,2],[538,2,[[539,3,[[540,4,[[541,5],[544,5]]],[548,4,[[549,5,[[550,6]]]]]]],[555,3,[[561,4,[[562,5,[[563,20]]],[565,5]]],[576,4,[[577,5],[580,5]]],[590,4,[[591,5,[[592,15]]],[594,5]]],[699,4,[[700,5],[701,5,[[702,6]]]]],[744,4,[[745,5],[752,5]]]]]]]]]]),ua=I(D('<div><label for="edit_api_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">API Base URL <span class="text-red-500">*</span></label> <input type="url" id="edit_api_base_url" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <div><label for="edit_upload_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Upload Base URL</label> <input type="url" id="edit_upload_base_url" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div>',1),d[M],[[830,5,[[831,6,[[832,20]]],[834,6]]],[844,5,[[845,6],[848,6]]]]),ca=I(D('<div><label for="edit_api_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">API Base URL <span class="text-xs text-gray-500">(optional)</span></label> <input type="url" id="edit_api_base_url" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/> <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">If empty, Base URL will be used as API Base URL</p></div> <div><div class="flex items-center mb-1"><label for="edit_tools_metadata_url">Tools Metadata URL <span class="text-xs text-gray-500">(optional)</span></label> <div class="ml-2"><!></div></div> <input type="url" id="edit_tools_metadata_url" autocomplete="off" placeholder="https://gitea.com/api/v1/repos/gitea/act_runner/releases"/> <p> </p></div> <div class="flex items-center"><input id="edit_use_internal_tools_metadata" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="edit_use_internal_tools_metadata" class="ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Use Internal Tools Metadata</label> <div class="ml-2"><!></div></div>',1),d[M],[[857,5,[[858,6,[[859,20]]],[861,6],[868,6]]],[872,5,[[873,6,[[874,7,[[875,27]]],[877,7]]],[886,6],[895,6]]],[898,5,[[899,6],[905,6],[908,6]]]]),pa=I(D('<div class="space-y-2"><svg class="mx-auto h-8 w-8 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="text-sm font-medium text-green-700 dark:text-green-300"> </p> <div class="flex justify-center space-x-2"><button type="button" class="text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline cursor-pointer">Replace</button> <span class="text-xs text-gray-400">•</span> <button type="button" class="text-xs text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 hover:underline cursor-pointer">Remove</button></div></div>'),d[M],[[931,7,[[932,8,[[933,9]]],[935,8],[938,8,[[939,9],[942,9],[943,9]]]]]]),ba=I(D('<div class="space-y-2"><svg class="mx-auto h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-sm text-gray-600 dark:text-gray-400"><button type="button" class="text-gray-900 dark:text-white hover:text-gray-700 dark:hover:text-gray-300 hover:underline cursor-pointer">Choose a file</button> or drag and drop</p> <p class="text-xs text-gray-500 dark:text-gray-400">PEM, CRT, CER, CERT files only</p></div>'),d[M],[[949,7,[[950,8,[[951,9]]],[953,8,[[954,9]]],[959,8]]]]),_a=I(D('<div class="fixed inset-0 flex items-center justify-center z-50" role="dialog" aria-modal="true"><button class="fixed inset-0 w-full h-full bg-black/30 dark:bg-black/50 cursor-default" aria-label="Close modal"></button> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto relative z-10" role="document"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"><div><h3 class="text-lg font-semibold text-gray-900 dark:text-white"> </h3> <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Update endpoint configuration</p></div> <button class="text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100 cursor-pointer" aria-label="Close modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-6 space-y-4"><div><label for="edit_name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Endpoint Name <span class="text-red-500">*</span></label> <input type="text" id="edit_name" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <div><label for="edit_description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label> <textarea id="edit_description" rows="2" autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"></textarea></div> <div><label for="edit_base_url" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Base URL <span class="text-red-500">*</span></label> <input type="url" id="edit_base_url" required autocomplete="off" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"/></div> <!> <div class="space-y-3 border-t border-gray-200 dark:border-gray-700 pt-4"><label for="edit_ca_cert_file" class="block text-sm font-medium text-gray-700 dark:text-gray-300">CA Certificate Bundle (Optional)</label> <div><input type="file" id="edit_ca_cert_file" accept=".pem,.crt,.cer,.cert" class="hidden"/> <!></div></div> <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 cursor-pointer">Cancel</button> <button type="submit">Update Endpoint</button></div></form></div></div>'),d[M],[[768,1,[[769,2],[770,2,[[771,3,[[772,4,[[773,5],[776,5]]],[780,4,[[781,5,[[782,6]]]]]]],[787,3,[[788,4,[[789,5,[[790,20]]],[792,5]]],[802,4,[[803,5],[806,5]]],[815,4,[[816,5,[[817,15]]],[819,5]]],[920,4,[[921,5],[922,5,[[923,6]]]]],[965,4,[[966,5],[973,5]]]]]]]]]]),ga=I(D('<div class="fixed inset-0 flex items-center justify-center z-50" role="dialog" aria-modal="true"><button class="fixed inset-0 w-full h-full bg-black/30 dark:bg-black/50 cursor-default" aria-label="Close modal"></button> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-xl w-full mx-4 relative z-10" role="document"><div class="px-6 py-4"><div class="flex items-center"><div class="flex-shrink-0"><svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div> <div class="ml-3"><h3 class="text-lg font-medium text-gray-900 dark:text-white">Delete Endpoint</h3> <p class="mt-2 text-sm text-gray-500 dark:text-gray-300"> </p></div></div></div> <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 hover:bg-gray-200 dark:hover:bg-gray-500 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 cursor-pointer">Cancel</button> <button type="button" class="px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 cursor-pointer">Delete</button></div></div></div>'),d[M],[[989,1,[[990,2],[991,2,[[992,3,[[993,4,[[994,5,[[995,6,[[996,7]]]]],[999,5,[[1e3,6],[1001,6]]]]]]],[1007,3,[[1008,4],[1015,4]]]]]]]]),ma=I(D('<div class="space-y-6"><!> <!></div> <!> <!> <!>',1),d[M],[[464,0]]);function d(ut,ct){Dt(new.target),zt(ct,!1,d);const[pt,bt]=Ot(),re=()=>(Kt(it,"eagerCache"),Wt(it,"$eagerCache",pt)),je=v(),oe=v(),Je=v(),ve=v();let Le=v(!0),ce=v([]),Me=v(""),Pe=v(""),O=v(1),pe=v(25),be=v(1),$e=v(!1),Ae=v(!1),Be=v(!1),X=v("github"),C=v(null),q=v(null),t=v({name:"",description:"",endpoint_type:"",base_url:"",api_base_url:"",upload_base_url:"",ca_cert_bundle:"",tools_metadata_url:"",use_internal_tools_metadata:!1}),j=v(""),E={...e(t)};qt(async()=>{try{n(Le,!0);const a=(await ae(dt.getEndpoints()))();a&&Array.isArray(a)&&n(ce,a)}catch(a){console.error(...nt("error","Failed to load endpoints:",a)),n(Me,a instanceof Error?a.message:"Failed to load endpoints")}finally{n(Le,!1)}});async function _t(){try{(await ae(dt.retryResource("endpoints")))()}catch(a){console.error(...nt("error","Retry failed:",a))}}const gt=[{key:"name",title:"Name",cellComponent:Ke,cellProps:{field:"name"}},{key:"description",title:"Description",cellComponent:Ke,cellProps:{field:"description"}},{key:"api_url",title:"API URL",cellComponent:Ke,cellProps:{field:"api_base_url",fallbackField:"base_url"}},{key:"forge_type",title:"Forge Type",cellComponent:aa},{key:"actions",title:"Actions",align:"right",cellComponent:ra}],mt={entityType:"endpoint",primaryText:{field:"name",isClickable:!1},secondaryText:{field:"description"},customInfo:[{icon:a=>Oe(a?.endpoint_type||"unknown"),text:a=>a?.api_base_url||"Unknown"}],actions:[{type:"edit",handler:a=>ze(a)},{type:"delete",handler:a=>qe(a)}]};function ft(a){n(Pe,a.detail.term),n(O,1)}function vt(a){n(O,a.detail.page)}function yt(a){const u=Yt(a.detail.perPage);n(pe,u.newPerPage),n(O,u.newCurrentPage)}function xt(a){ze(a.detail.item)}function ht(a){qe(a.detail.item)}function kt(){n(X,"github"),Ne(),g(t,e(t).endpoint_type="github"),n($e,!0)}function wt(a){n(X,a.detail),Ne(),g(t,e(t).endpoint_type=a.detail)}function ze(a){n(C,a),n(t,{name:a.name||"",description:a.description||"",endpoint_type:a.endpoint_type||"",base_url:a.base_url||"",api_base_url:a.api_base_url||"",upload_base_url:a.upload_base_url||"",ca_cert_bundle:i(typeof a.ca_cert_bundle,"string")?a.ca_cert_bundle:"",tools_metadata_url:a.tools_metadata_url||"",use_internal_tools_metadata:a.use_internal_tools_metadata||!1}),E={...e(t)},n(j,e(t).ca_cert_bundle?"certificate.pem":""),n(Ae,!0)}function qe(a){n(q,a),n(Be,!0)}function Ne(){n(t,{name:"",description:"",endpoint_type:"",base_url:"",api_base_url:"",upload_base_url:"",ca_cert_bundle:"",tools_metadata_url:"",use_internal_tools_metadata:!1}),E={...e(t)},n(j,"")}function Ct(a){i(a.key,"Escape")&&(e($e)||e(Ae)||e(Be))&&P()}function P(){n($e,!1),n(Ae,!1),n(Be,!1),n(X,"github"),n(C,null),n(q,null),Ne()}function Et(){const a={};if(i(e(t).description,E.description,!1)&&(i(e(t).description.trim(),"",!1)||i(E.description,"",!1))&&(a.description=e(t).description.trim()),i(e(t).base_url,E.base_url,!1)&&i(e(t).base_url.trim(),"",!1)&&(a.base_url=e(t).base_url.trim()),i(e(t).api_base_url,E.api_base_url,!1)&&(i(e(t).api_base_url.trim(),"",!1)||i(E.api_base_url,"",!1))&&(a.api_base_url=e(t).api_base_url.trim()),i(e(C)?.endpoint_type,"github")&&i(e(t).upload_base_url,E.upload_base_url,!1)&&(i(e(t).upload_base_url.trim(),"",!1)||i(E.upload_base_url,"",!1))&&(a.upload_base_url=e(t).upload_base_url.trim()),i(e(t).ca_cert_bundle,E.ca_cert_bundle,!1))if(i(e(t).ca_cert_bundle,"",!1))try{const u=atob(e(t).ca_cert_bundle);a.ca_cert_bundle=Array.from(u,y=>y.charCodeAt(0))}catch{i(E.ca_cert_bundle,"",!1)&&(a.ca_cert_bundle=[])}else i(E.ca_cert_bundle,"",!1)&&(a.ca_cert_bundle=[]);return i(e(C)?.endpoint_type,"gitea")&&(i(e(t).tools_metadata_url,E.tools_metadata_url,!1)&&(a.tools_metadata_url=e(t).tools_metadata_url.trim()),i(e(t).use_internal_tools_metadata,E.use_internal_tools_metadata,!1)&&(a.use_internal_tools_metadata=e(t).use_internal_tools_metadata)),a}async function Tt(){try{const a={name:e(t).name,description:e(t).description,endpoint_type:e(t).endpoint_type,base_url:e(t).base_url,api_base_url:e(t).api_base_url,upload_base_url:e(t).upload_base_url};if(i(e(t).endpoint_type,"gitea")&&(i(e(t).tools_metadata_url.trim(),"",!1)&&(a.tools_metadata_url=e(t).tools_metadata_url.trim()),a.use_internal_tools_metadata=e(t).use_internal_tools_metadata),e(t).ca_cert_bundle&&i(e(t).ca_cert_bundle.trim(),"",!1))try{const u=atob(e(t).ca_cert_bundle);a.ca_cert_bundle=Array.from(u,y=>y.charCodeAt(0))}catch{}i(e(t).endpoint_type,"github")?(await ae(fe.createGithubEndpoint(a)))():(await ae(fe.createGiteaEndpoint(a)))(),Ue.success("Endpoint Created",`Endpoint ${e(t).name} has been created successfully.`),P()}catch(a){n(Me,We(a))}}async function Rt(){if(e(C))try{const a=Et();if(i(Object.keys(a).length,0)){Ue.info("No Changes","No fields were modified."),P();return}i(e(C).endpoint_type,"github")?(await ae(fe.updateGithubEndpoint(e(C).name,a)))():(await ae(fe.updateGiteaEndpoint(e(C).name,a)))(),Ue.success("Endpoint Updated",`Endpoint ${e(C).name} has been updated successfully.`),P()}catch(a){n(Me,We(a))}}async function Ut(){if(e(q)){try{i(e(q).endpoint_type,"github")?(await ae(fe.deleteGithubEndpoint(e(q).name)))():(await ae(fe.deleteGiteaEndpoint(e(q).name)))(),Ue.success("Endpoint Deleted",`Endpoint ${e(q).name} has been deleted successfully.`)}catch(a){const u=We(a);Ue.error("Delete Failed",u)}P()}}function Qe(a){const y=a.target.files?.[0];if(!y){g(t,e(t).ca_cert_bundle=""),n(j,"");return}n(j,y.name);const $=new FileReader;$.onload=c=>{const T=c.target?.result;g(t,e(t).ca_cert_bundle=btoa(T))},$.readAsText(y)}function Xe(){g(t,e(t).ca_cert_bundle=""),n(j,"");const a=document.getElementById("ca_cert_file");a&&(a.value="");const u=document.getElementById("edit_ca_cert_file");u&&(u.value="")}ie(()=>(e(ce),re()),()=>{(!e(ce).length||re().loaded.endpoints)&&n(ce,re().endpoints)}),ie(()=>re(),()=>{n(Le,re().loading.endpoints)}),ie(()=>re(),()=>{n(je,re().errorMessages.endpoints)}),ie(()=>(e(ce),e(Pe)),()=>{n(oe,Zt(e(ce),e(Pe)))}),ie(()=>(e(be),e(oe),e(pe),e(O)),()=>{n(be,Math.ceil(e(oe).length/e(pe))),e(O)>e(be)&&e(be)>0&&n(O,e(be))}),ie(()=>(e(oe),e(O),e(pe)),()=>{n(Je,ea(e(oe),e(O),e(pe)))}),ie(()=>e(t),()=>{n(ve,!(!e(t).name||!e(t).base_url||i(e(t).endpoint_type,"github")&&!e(t).api_base_url))}),Nt(),jt();var Ye=ma();m("keydown",St,Ct),Ft(a=>{Vt.title="Endpoints - GARM"});var He=Te(Ye),Ze=o(He);w(()=>Qt(Ze,{title:"Endpoints",description:"Manage your GitHub and Gitea endpoints for runner management.",actionLabel:"Add Endpoint",$$events:{action:kt}}),"component",d,466,1,{componentTag:"PageHeader"});var Lt=r(Ze,2);{let a=Ve(()=>e(je)||e(Me)),u=Ve(()=>!!e(je));w(()=>ta(Lt,{get columns(){return gt},get data(){return e(Je)},get loading(){return e(Le)},get error(){return e(a)},get searchTerm(){return e(Pe)},searchPlaceholder:"Search endpoints by name, description, or URL...",get currentPage(){return e(O)},get perPage(){return e(pe)},get totalPages(){return e(be)},get totalItems(){return e(oe),h(()=>e(oe).length)},itemName:"endpoints",emptyIconType:"settings",get showRetry(){return e(u)},get mobileCardConfig(){return mt},$$events:{search:ft,pageChange:vt,perPageChange:yt,retry:_t,edit:xt,delete:ht},$$slots:{"mobile-card":(y,$)=>{const c=Ve(()=>$.item);var T=oa(),A=o(T),N=o(A),z=o(N),F=o(z,!0);s(z);var R=r(z,2),W=o(R,!0);s(R);var H=r(R,2),K=o(H);Jt(K,()=>(Re(Oe),Re(e(c)),h(()=>Oe(e(c).endpoint_type||"","w-5 h-5"))));var J=r(K,2),_e=o(J,!0);s(J),s(H),s(N),s(A);var se=r(A,2),Y=o(se);w(()=>lt(Y,{action:"edit",size:"sm",title:"Edit endpoint",ariaLabel:"Edit endpoint",$$events:{click:()=>ze(e(c))}}),"component",d,513,5,{componentTag:"ActionButton"});var ne=r(Y,2);w(()=>lt(ne,{action:"delete",size:"sm",title:"Delete endpoint",ariaLabel:"Delete endpoint",$$events:{click:()=>qe(e(c))}}),"component",d,520,5,{componentTag:"ActionButton"}),s(se),s(T),te(()=>{Q(F,(Re(e(c)),h(()=>e(c).name))),Q(W,(Re(e(c)),h(()=>e(c).description))),Q(_e,(Re(e(c)),h(()=>e(c).endpoint_type)))}),B(y,T)}}}),"component",d,473,1,{componentTag:"DataTable"})}s(He);var et=r(He,2);{var Mt=a=>{var u=da(),y=o(u),$=r(y,2),c=o($),T=r(o(c),2);s(c);var A=r(c,2),N=o(A);w(()=>Xt(N,{get selectedForgeType(){return e(X)},set selectedForgeType(p){n(X,p)},$$events:{select:wt},$$legacy:!0}),"component",d,557,4,{componentTag:"ForgeTypeSelector"});var z=r(N,2),F=r(o(z),2);U(F),s(z);var R=r(z,2),W=r(o(R),2);at(W),s(R);var H=r(R,2),K=r(o(H),2);U(K),s(H);var J=r(H,2);{var _e=p=>{var k=sa(),l=Te(k),_=r(o(l),2);U(_),s(l);var b=r(l,2),f=r(o(b),2);U(f),s(b),L(_,()=>e(t).api_base_url,x=>g(t,e(t).api_base_url=x)),L(f,()=>e(t).upload_base_url,x=>g(t,e(t).upload_base_url=x)),B(p,k)},se=p=>{var k=na(),l=Te(k),_=r(o(l),2);U(_),de(2),s(l);var b=r(l,2),f=o(b),x=o(f),G=r(x,2),S=o(G);w(()=>Ge(S,{title:"Tools Metadata URL",content:"URL where GARM checks for act_runner binary downloads and release information. Defaults to https://gitea.com/api/v1/repos/gitea/act_runner/releases if not specified. Use a custom URL to point to your own tools repository or mirror.",position:"top",width:"w-80"}),"component",d,657,8,{componentTag:"Tooltip"}),s(G),s(f);var Z=r(f,2);U(Z);var he=r(Z,2),le=o(he,!0);s(he),s(b);var me=r(b,2),ke=o(me);U(ke);var we=r(ke,4),Ce=o(we);w(()=>Ge(Ce,{title:"Internal Tools Metadata",content:"When enabled, GARM uses built-in URLs for nightly act_runner binaries instead of calling the external tools metadata URL. This is useful in air-gapped environments where runner images already include the binaries and don't need to download them.",position:"top",width:"w-80"}),"component",d,688,7,{componentTag:"Tooltip"}),s(we),s(me),te(()=>{V(x,1,`block text-sm font-medium ${e(t),h(()=>e(t).use_internal_tools_metadata?"text-gray-400 dark:text-gray-500":"text-gray-700 dark:text-gray-300")??""}`),Z.disabled=(e(t),h(()=>e(t).use_internal_tools_metadata)),V(Z,1,`w-full px-3 py-2 border rounded-md focus:outline-none transition-colors ${e(t),h(()=>e(t).use_internal_tools_metadata?"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-400 dark:text-gray-500 cursor-not-allowed":"border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white")??""}`),V(he,1,`text-xs ${e(t),h(()=>e(t).use_internal_tools_metadata?"text-gray-400 dark:text-gray-500":"text-gray-500 dark:text-gray-400")??""} mt-1`),Q(le,(e(t),h(()=>e(t).use_internal_tools_metadata?"Disabled when using internal tools metadata":"Leave empty to use default Gitea releases URL")))}),L(_,()=>e(t).api_base_url,ee=>g(t,e(t).api_base_url=ee)),L(Z,()=>e(t).tools_metadata_url,ee=>g(t,e(t).tools_metadata_url=ee)),ot(ke,()=>e(t).use_internal_tools_metadata,ee=>g(t,e(t).use_internal_tools_metadata=ee)),B(p,k)};w(()=>ue(J,p=>{i(e(X),"github")?p(_e):p(se,!1)}),"if",d,605,4)}var Y=r(J,2),ne=r(o(Y),2),ge=o(ne),ye=r(ge,2);{var Ie=p=>{var k=la(),l=r(o(k),2),_=o(l,!0);s(l);var b=r(l,2),f=o(b),x=r(f,4);s(b),s(k),te(()=>Q(_,e(j))),m("click",f,()=>document.getElementById("ca_cert_file")?.click()),m("click",x,Xe),B(p,k)},Se=p=>{var k=ia(),l=r(o(k),2),_=o(l);de(),s(l),de(2),s(k),m("click",_,()=>document.getElementById("ca_cert_file")?.click()),B(p,k)};w(()=>ue(ye,p=>{e(j)?p(Ie):p(Se,!1)}),"if",d,709,6)}s(ne),s(Y);var De=r(Y,2),Fe=o(De),xe=r(Fe,2);s(De),s(A),s($),s(u),te(()=>{rt(F,"placeholder",i(e(X),"github")?"e.g., github-enterprise or github-com":"e.g., gitea-main or my-gitea"),rt(K,"placeholder",i(e(X),"github")?"https://github.com or https://github.example.com":"https://gitea.example.com"),V(ne,1,`border-2 border-dashed rounded-lg p-4 text-center transition-colors ${e(j)?"border-green-500 dark:border-green-400 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-400"}`),xe.disabled=!e(ve),V(xe,1,`px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors
							${e(ve)?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500 cursor-pointer":"bg-gray-400 cursor-not-allowed"}`)}),m("click",y,P),m("click",T,P),L(F,()=>e(t).name,p=>g(t,e(t).name=p)),L(W,()=>e(t).description,p=>g(t,e(t).description=p)),L(K,()=>e(t).base_url,p=>g(t,e(t).base_url=p)),m("change",ge,Qe),m("click",Fe,P),m("submit",A,st(Tt)),B(a,u)};w(()=>ue(et,a=>{e($e)&&a(Mt)}),"if",d,535,0)}var tt=r(et,2);{var Pt=a=>{var u=_a(),y=o(u),$=r(y,2),c=o($),T=o(c),A=o(T),N=o(A);s(A),de(2),s(T);var z=r(T,2);s(c);var F=r(c,2),R=o(F),W=r(o(R),2);U(W),s(R);var H=r(R,2),K=r(o(H),2);at(K),s(H);var J=r(H,2),_e=r(o(J),2);U(_e),s(J);var se=r(J,2);{var Y=l=>{var _=ua(),b=Te(_),f=r(o(b),2);U(f),s(b);var x=r(b,2),G=r(o(x),2);U(G),s(x),L(f,()=>e(t).api_base_url,S=>g(t,e(t).api_base_url=S)),L(G,()=>e(t).upload_base_url,S=>g(t,e(t).upload_base_url=S)),B(l,_)},ne=l=>{var _=ca(),b=Te(_),f=r(o(b),2);U(f),de(2),s(b);var x=r(b,2),G=o(x),S=o(G),Z=r(S,2),he=o(Z);w(()=>Ge(he,{title:"Tools Metadata URL",content:"URL where GARM checks for act_runner binary downloads and release information. Defaults to https://gitea.com/api/v1/repos/gitea/act_runner/releases if not specified. Use a custom URL to point to your own tools repository or mirror.",position:"top",width:"w-80"}),"component",d,878,8,{componentTag:"Tooltip"}),s(Z),s(G);var le=r(G,2);U(le);var me=r(le,2),ke=o(me,!0);s(me),s(x);var we=r(x,2),Ce=o(we);U(Ce);var ee=r(Ce,4),It=o(ee);w(()=>Ge(It,{title:"Internal Tools Metadata",content:"When enabled, GARM uses built-in URLs for nightly act_runner binaries instead of calling the external tools metadata URL. This is useful in air-gapped environments where runner images already include the binaries and don't need to download them.",position:"top",width:"w-80"}),"component",d,909,7,{componentTag:"Tooltip"}),s(ee),s(we),te(()=>{V(S,1,`block text-sm font-medium ${e(t),h(()=>e(t).use_internal_tools_metadata?"text-gray-400 dark:text-gray-500":"text-gray-700 dark:text-gray-300")??""}`),le.disabled=(e(t),h(()=>e(t).use_internal_tools_metadata)),V(le,1,`w-full px-3 py-2 border rounded-md focus:outline-none transition-colors ${e(t),h(()=>e(t).use_internal_tools_metadata?"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-400 dark:text-gray-500 cursor-not-allowed":"border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white")??""}`),V(me,1,`text-xs ${e(t),h(()=>e(t).use_internal_tools_metadata?"text-gray-400 dark:text-gray-500":"text-gray-500 dark:text-gray-400")??""} mt-1`),Q(ke,(e(t),h(()=>e(t).use_internal_tools_metadata?"Disabled when using internal tools metadata":"Leave empty to use default Gitea releases URL")))}),L(f,()=>e(t).api_base_url,Ee=>g(t,e(t).api_base_url=Ee)),L(le,()=>e(t).tools_metadata_url,Ee=>g(t,e(t).tools_metadata_url=Ee)),ot(Ce,()=>e(t).use_internal_tools_metadata,Ee=>g(t,e(t).use_internal_tools_metadata=Ee)),B(l,_)};w(()=>ue(se,l=>{e(C),h(()=>i(e(C).endpoint_type,"github"))?l(Y):l(ne,!1)}),"if",d,829,4)}var ge=r(se,2),ye=r(o(ge),2),Ie=o(ye),Se=r(Ie,2);{var De=l=>{var _=pa(),b=r(o(_),2),f=o(b,!0);s(b);var x=r(b,2),G=o(x),S=r(G,4);s(x),s(_),te(()=>Q(f,e(j))),m("click",G,()=>document.getElementById("edit_ca_cert_file")?.click()),m("click",S,Xe),B(l,_)},Fe=l=>{var _=ba(),b=r(o(_),2),f=o(b);de(),s(b),de(2),s(_),m("click",f,()=>document.getElementById("edit_ca_cert_file")?.click()),B(l,_)};w(()=>ue(Se,l=>{e(j)?l(De):l(Fe,!1)}),"if",d,930,6)}s(ye),s(ge);var xe=r(ge,2),p=o(xe),k=r(p,2);s(xe),s(F),s($),s(u),te(()=>{Q(N,`Edit ${e(C),h(()=>i(e(C).endpoint_type,"github")?"GitHub":"Gitea")??""} Endpoint`),V(ye,1,`border-2 border-dashed rounded-lg p-4 text-center transition-colors ${e(j)?"border-green-500 dark:border-green-400 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-400"}`),k.disabled=!e(ve),V(k,1,`px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors
							${e(ve)?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500 cursor-pointer":"bg-gray-400 cursor-not-allowed"}`)}),m("click",y,P),m("click",z,P),L(W,()=>e(t).name,l=>g(t,e(t).name=l)),L(K,()=>e(t).description,l=>g(t,e(t).description=l)),L(_e,()=>e(t).base_url,l=>g(t,e(t).base_url=l)),m("change",Ie,Qe),m("click",p,P),m("submit",F,st(Rt)),B(a,u)};w(()=>ue(tt,a=>{e(Ae)&&e(C)&&a(Pt)}),"if",d,767,0)}var $t=r(tt,2);{var At=a=>{var u=ga(),y=o(u),$=r(y,2),c=o($),T=o(c),A=r(o(T),2),N=r(o(A),2),z=o(N);s(N),s(A),s(T),s(c);var F=r(c,2),R=o(F),W=r(R,2);s(F),s($),s(u),te(()=>Q(z,`Are you sure you want to delete the endpoint "${e(q),h(()=>e(q).name)??""}"? This action cannot be undone.`)),m("click",y,P),m("click",R,P),m("click",W,Ut),B(a,u)};w(()=>ue($t,a=>{e(Be)&&e(q)&&a(At)}),"if",d,988,0)}B(ut,Ye);var Bt=Ht({...Gt()});return bt(),Bt}export{d as component};
