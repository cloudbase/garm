import{c as yt,a as k,b as f,l as ht,s as b,f as w,d as _t,e as M,r as kt,t as Ce}from"../chunks/CxOx-TIJ.js";import{i as wt}from"../chunks/3NxSoY2_.js";import{p as jt,o as $t,l as Dt,b as Tt,f as ce,d as u,t as z,a as Mt,s,g as e,m as D,u as c,h as Z,F as h,c as r,n as B,j as n,r as a,w as me,i as V,k as ee}from"../chunks/DzFKsO_V.js";import{s as Bt,a as Ft,i as F,v as Ot}from"../chunks/B_jyf0qs.js";import{e as Ne,i as Pe}from"../chunks/CdXRaxkX.js";import{w as ve}from"../chunks/DoJxysSt.js";import{c as ge,d as ue,g as pe,r as ze,B as Re}from"../chunks/BguOOs3x.js";import{b as xe}from"../chunks/BVM1034P.js";import{p as At}from"../chunks/CdEA5IGF.js";import{p as He}from"../chunks/DgabA6iF.js";import{g as Et}from"../chunks/BzzAh3Be.js";import{t as O}from"../chunks/li_-Mkq2.js";import{e as te}from"../chunks/BZiHL9L3.js";import{f as qe,a as ae}from"../chunks/aK-A9Gop.js";import{D as St}from"../chunks/DL1RlOO9.js";import{M as Ut}from"../chunks/Pgjt70l7.js";import{B as It}from"../chunks/1CdJgrM6.js";o[h]="src/routes/objects/[id]/+page.svelte";var Lt=k(w('<div class="bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-800 rounded-md p-4 mb-6"><div class="flex"><div class="ml-3"><h3 class="text-sm font-medium text-red-800 dark:text-red-200">Error</h3> <div class="mt-2 text-sm text-red-700 dark:text-red-300"> </div></div></div></div>'),o[h],[[224,1,[[225,2,[[226,3,[[227,4],[228,4]]]]]]]]),Ct=k(w('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-6 py-4 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Loading object details...</p></div></div>'),o[h],[[235,1,[[236,2,[[237,3],[238,3]]]]]]),Nt=k(w('<div class="flex flex-wrap gap-2"></div>'),o[h],[[311,7]]),Pt=k(w('<span class="text-gray-500 dark:text-gray-400 italic">No tags</span>'),o[h],[[317,7]]),zt=k(w('<div class="mt-6 bg-white dark:bg-gray-800 shadow rounded-lg p-6"><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Description</h3> <div class="text-sm text-gray-900 dark:text-white whitespace-pre-wrap break-words"> </div></div>'),o[h],[[327,2,[[328,3],[329,3]]]]),Rt=k(w('<div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white">File Information</h3> <div class="flex items-center space-x-3"><button class="px-4 py-2 bg-gray-600 hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-800 text-white rounded-lg font-medium text-sm cursor-pointer">Edit</button> <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white rounded-lg font-medium text-sm cursor-pointer">Download</button> <button class="px-4 py-2 bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-lg font-medium text-sm cursor-pointer">Delete</button></div></div> <dl class="space-y-3"><div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">ID:</dt> <dd class="text-sm font-mono text-gray-900 dark:text-white break-all"> </dd></div> <div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Name:</dt> <dd class="text-sm text-gray-900 dark:text-white"> </dd></div> <div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Size:</dt> <dd class="text-sm text-gray-900 dark:text-white"> </dd></div> <div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">File Type:</dt> <dd class="text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">SHA256:</dt> <dd class="text-xs font-mono text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-2 rounded break-all"> </dd></div></dl></div> <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6"><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Metadata & Timestamps</h3> <dl class="space-y-3"><div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Created At:</dt> <dd class="text-sm text-gray-900 dark:text-white"> </dd></div> <div class="flex justify-between"><dt class="text-sm font-medium text-gray-500 dark:text-gray-400">Updated At:</dt> <dd class="text-sm text-gray-900 dark:text-white"> </dd></div> <div><dt class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">Tags:</dt> <dd class="text-sm"><!></dd></div></dl></div></div> <!>',1),o[h],[[243,1,[[245,2,[[246,3,[[247,4],[248,4,[[249,5],[255,5],[261,5]]]]],[269,3,[[270,4,[[271,5],[272,5]]],[274,4,[[275,5],[276,5]]],[278,4,[[279,5],[280,5]]],[282,4,[[283,5],[284,5]]],[286,4,[[287,5],[288,5]]]]]]],[296,2,[[297,3],[298,3,[[299,4,[[300,5],[301,5]]],[303,4,[[304,5],[305,5]]],[307,4,[[308,5],[309,5]]]]]]]]]]),Ht=k(w('<span class="inline-flex items-center gap-1 px-2 py-1 text-sm font-medium text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900 rounded-md"> <button type="button" class="inline-flex items-center justify-center w-4 h-4 text-blue-700 dark:text-blue-300 hover:text-blue-900 dark:hover:text-blue-100 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></span>'),o[h],[[362,7,[[364,8,[[370,9,[[371,10]]]]]]]]),qt=k(w('<div class="max-w-2xl w-full p-6"><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Update Object</h3> <form class="space-y-4"><div><label for="update-file-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">File Name</label> <input id="update-file-name" type="text" class="block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm" placeholder="my-file.bin"/></div> <div><label for="update-file-tags" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tags</label> <div class="block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 min-h-[42px] flex flex-wrap gap-2 items-center"><!> <input id="update-file-tags" type="text" class="flex-1 min-w-[120px] bg-transparent border-none outline-none text-gray-900 dark:text-white text-sm"/></div> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Press Space or Enter to add a tag. Press Backspace on empty field to remove last tag.</p></div> <div><label for="update-file-description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description (optional)</label> <textarea id="update-file-description" maxlength="8192" rows="3" class="block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm resize-y" placeholder="Add a description for this file..."></textarea> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400"> </p></div> <div class="flex justify-end gap-3 pt-4"><!> <!></div></form></div>'),o[h],[[339,2,[[340,3],[342,3,[[343,4,[[344,5],[347,5]]],[356,4,[[357,5],[360,5,[[376,6]]],[386,5]]],[391,4,[[392,5],[395,5],[403,5]]],[408,4]]]]]]),Kt=k(w('<nav class="flex mb-6" aria-label="Breadcrumb"><ol class="inline-flex items-center space-x-1 md:space-x-3"><li class="inline-flex items-center"><a class="inline-flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Object Storage</a></li> <li><div class="flex items-center"><svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg> <span class="text-sm font-medium text-gray-500 dark:text-gray-400 ml-1 md:ml-2"> </span></div></li></ol></nav> <!> <!> <!> <!>',1),o[h],[[203,0,[[204,1,[[205,2,[[206,3]]],[210,2,[[211,3,[[212,4,[[213,5]]],[215,4]]]]]]]]]]);function o(Ke,Ge){yt(new.target),jt(Ge,!1,o);const[Je,Qe]=Bt(),fe=()=>(Ot(He,"page"),Ft(He,"$page",Je)),re=D();let t=D(null),W=D(!0),A=D(""),de=D(!1),R=D(!1),i=D({name:"",tags:[],description:""}),E=D("");$t(async()=>{(await B(be()))()});async function be(){if(!e(re)){n(A,"Invalid object ID"),n(W,!1);return}try{n(W,!0),n(A,""),n(t,(await B(pe.getFileObject(e(re))))())}catch(d){n(A,te(d)),O.add({type:"error",title:"Failed to load object",message:e(A)})}finally{n(W,!1)}}async function Ve(){if(e(t)?.id)try{(await B(pe.deleteFileObject(e(t).id.toString())))(),O.add({type:"success",title:"Object deleted",message:`Object "${e(t).name}" has been deleted successfully.`}),Et(ge("/objects"))}catch(d){const l=te(d);O.add({type:"error",title:"Failed to delete object",message:l})}}async function We(){if(e(t)?.id)try{const l=`${window.location.origin}/api/v1/objects/${e(t).id}/download`,m=(await B(fetch(l,{method:"HEAD",credentials:"include"})))();if(!m.ok){const p=(await B(m.text()))();throw new Error(p||`Download failed with status ${m.status}`)}const v=document.createElement("a");v.href=l,v.download=e(t).name||"download",document.body.appendChild(v),v.click(),document.body.removeChild(v),O.add({type:"success",title:"Download started",message:`Downloading "${e(t).name}"...`})}catch(d){const l=te(d);O.add({type:"error",title:"Download failed",message:l})}}function Xe(){e(t)&&(n(i,{name:e(t).name||"",tags:e(t).tags||[],description:e(t).description||""}),n(E,""),n(R,!0))}async function Ye(){if(e(t)?.id)try{(await B(pe.updateFileObject(e(t).id.toString(),{name:e(i).name||void 0,tags:e(i).tags,description:e(i).description||void 0})))(),O.add({type:"success",title:"Object updated",message:"Object has been updated successfully."}),n(R,!1),(await B(be()))()}catch(d){const l=te(d);O.add({type:"error",title:"Failed to update object",message:l})}}function Ze(d){const m=d.target.value.trim();(V(d.key," ")||V(d.key,"Enter"))&&m?(d.preventDefault(),ye(m),n(E,"")):V(d.key,"Backspace")&&!m&&e(i).tags.length>0&&(d.preventDefault(),he(e(i).tags.length-1))}function et(){const d=e(E).trim();d&&(ye(d),n(E,""))}function ye(d){const l=d.trim().toLowerCase();l&&(e(i).tags.includes(l)||ee(i,e(i).tags=[...e(i).tags,l]))}function he(d){ee(i,e(i).tags=e(i).tags.filter((l,m)=>V(m,d,!1)))}Dt(()=>fe(),()=>{n(re,fe().params.id||"")}),Tt(),wt();var _e=Kt(),se=ce(_e),ke=r(se),oe=r(ke),tt=r(oe);a(oe);var we=s(oe,2),je=r(we),$e=s(r(je),2),at=r($e,!0);a($e),a(je),a(we),a(ke),a(se);var De=s(se,2);{var rt=d=>{var l=Lt(),m=r(l),v=r(m),p=s(r(v),2),j=r(p,!0);a(p),a(v),a(m),a(l),z(()=>b(j,e(A))),f(d,l)};u(()=>F(De,d=>{e(A)&&d(rt)}),"if",o,223,0)}var Te=s(De,2);{var dt=d=>{var l=Ct();f(d,l)},st=d=>{var l=_t(),m=ce(l);{var v=p=>{var j=Rt(),S=ce(j),T=r(S),U=r(T),H=s(r(U),2),$=r(H),I=s($,2),q=s(I,2);a(H),a(U);var K=s(U,2),G=r(K),J=s(r(G),2),X=r(J,!0);a(J),a(G);var Q=s(G,2),g=s(r(Q),2),L=r(g,!0);a(g),a(Q);var _=s(Q,2),C=s(r(_),2),Y=r(C,!0);a(C),a(_);var N=s(_,2),Be=s(r(N),2),ct=r(Be,!0);a(Be),a(N);var Fe=s(N,2),Oe=s(r(Fe),2),mt=r(Oe,!0);a(Oe),a(Fe),a(K),a(T);var Ae=s(T,2),Ee=s(r(Ae),2),ie=r(Ee),Se=s(r(ie),2),vt=r(Se,!0);a(Se),a(ie);var le=s(ie,2),Ue=s(r(le),2),gt=r(Ue,!0);a(Ue),a(le);var Ie=s(le,2),Le=s(r(Ie),2),ut=r(Le);{var pt=x=>{var y=Nt();u(()=>Ne(y,5,()=>(e(t),c(()=>e(t).tags)),Pe,(P,ne)=>{u(()=>It(P,{variant:"blue",get text(){return e(ne)}}),"component",o,313,9,{componentTag:"Badge"})}),"each",o,312,8),a(y),f(x,y)},xt=x=>{var y=Pt();f(x,y)};u(()=>F(ut,x=>{e(t),c(()=>e(t).tags&&e(t).tags.length>0)?x(pt):x(xt,!1)}),"if",o,310,6)}a(Le),a(Ie),a(Ee),a(Ae),a(S);var ft=s(S,2);{var bt=x=>{var y=zt(),P=s(r(y),2),ne=r(P,!0);a(P),a(y),z(()=>b(ne,(e(t),c(()=>e(t).description)))),f(x,y)};u(()=>F(ft,x=>{e(t),c(()=>e(t).description)&&x(bt)}),"if",o,326,1)}z((x,y,P)=>{b(X,(e(t),c(()=>e(t).id))),b(L,(e(t),c(()=>e(t).name))),b(Y,x),b(ct,(e(t),c(()=>e(t).file_type||"N/A"))),b(mt,(e(t),c(()=>e(t).sha256||"N/A"))),b(vt,y),b(gt,P)},[()=>(Z(qe),e(t),c(()=>qe(e(t).size||0))),()=>(Z(ae),e(t),c(()=>ae(e(t).created_at))),()=>(Z(ae),e(t),c(()=>ae(e(t).updated_at)))]),M("click",$,Xe),M("click",I,We),M("click",q,()=>n(de,!0)),f(p,j)};u(()=>F(m,p=>{e(t)&&p(v)},!0),"if",o,241,0)}f(d,l)};u(()=>F(Te,d=>{e(W)?d(dt):d(st,!1)}),"if",o,234,0)}var Me=s(Te,2);{var ot=d=>{u(()=>Ut(d,{$$events:{close:()=>n(R,!1)},children:ve(o,(l,m)=>{var v=qt(),p=s(r(v),2),j=r(p),S=s(r(j),2);ze(S),a(j);var T=s(j,2),U=s(r(T),2),H=r(U);u(()=>Ne(H,1,()=>(e(i),c(()=>e(i).tags)),Pe,(g,L,_)=>{var C=Ht(),Y=r(C),N=s(Y);a(C),z(()=>{b(Y,`${e(L)??""} `),ue(N,"aria-label",`Remove tag ${e(L)??""}`)}),M("click",N,()=>he(_)),f(g,C)}),"each",o,361,6);var $=s(H,2);ze($),a(U),me(2),a(T);var I=s(T,2),q=s(r(I),2);kt(q);var K=s(q,2),G=r(K);a(K),a(I);var J=s(I,2),X=r(J);u(()=>Re(X,{type:"button",variant:"secondary",$$events:{click:()=>n(R,!1)},children:ve(o,(g,L)=>{me();var _=Ce("Cancel");f(g,_)}),$$slots:{default:!0}}),"component",o,409,5,{componentTag:"Button"});var Q=s(X,2);u(()=>Re(Q,{type:"submit",variant:"primary",children:ve(o,(g,L)=>{me();var _=Ce("Update Object");f(g,_)}),$$slots:{default:!0}}),"component",o,416,5,{componentTag:"Button"}),a(J),a(p),a(v),z(()=>{ue($,"placeholder",(e(i),c(()=>V(e(i).tags.length,0)?"Type and press Space or Enter":""))),b(G,`${e(i),c(()=>e(i).description.length)??""} / 8192 characters`)}),xe(S,()=>e(i).name,g=>ee(i,e(i).name=g)),xe($,()=>e(E),g=>n(E,g)),M("keydown",$,Ze),M("blur",$,et),xe(q,()=>e(i).description,g=>ee(i,e(i).description=g)),M("submit",p,At(Ye)),f(l,v)}),$$slots:{default:!0}}),"component",o,338,1,{componentTag:"Modal"})};u(()=>F(Me,d=>{e(R)&&e(t)&&d(ot)}),"if",o,337,0)}var it=s(Me,2);{var lt=d=>{u(()=>St(d,{title:"Delete Object",get message(){return`Are you sure you want to delete the object '${e(t),c(()=>e(t).name)??""}'? This action cannot be undone.`},$$events:{confirm:Ve,close:()=>n(de,!1)}}),"component",o,430,1,{componentTag:"DeleteModal"})};u(()=>F(it,d=>{e(de)&&e(t)&&d(lt)}),"if",o,429,0)}z(d=>{ue(tt,"href",d),b(at,(e(t),c(()=>e(t)?e(t).name:"Object Details")))},[()=>(Z(ge),c(()=>ge("/objects")))]),f(Ke,_e);var nt=Mt({...ht()});return Qe(),nt}export{o as component};
