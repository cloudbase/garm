import"./DsnmJJEf.js";import{i as Hr}from"./TJn6xDN9.js";import{p as Kr,E as Wr,m as u,o as Qr,k as n,l as pr,g as e,h as Vr,f as w,d,r as t,s as o,t as v,y as Pe,u as b,z as br,q as B,e as h,i as G,b as c,A as Xr,a as gr,D as cr,c as Yr}from"./DniTuB_0.js";import{p as Zr,i as I,s as et,a as rt}from"./DbNhg6mG.js";import{e as fr,i as vr}from"./Ck5PkeSc.js";import{r as k,s as mr,b as Ae,c as yr,g as tt,d as xr}from"./BZ2rxtTc.js";import{b as S,a as at}from"./CCQwxxp9.js";import{p as dt}from"./D4Caz1gY.js";import{M as ot}from"./CHjY0Kaf.js";import{J as it}from"./C-CyTC2O.js";import{e as _r}from"./BZiHL9L3.js";import{e as nt}from"./DKJ_c8yL.js";var st=w('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),lt=w('<div class="rounded-md bg-yellow-50 dark:bg-yellow-900 p-4"><p class="text-sm font-medium text-yellow-800 dark:text-yellow-200"> </p></div>'),ut=w('<div class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 flex items-center"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"></div> <span class="text-sm text-gray-600 dark:text-gray-400">Loading templates...</span></div>'),pt=w("<option> <!></option>"),bt=w('<select id="template" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"></select> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400"> </p>',1),gt=w('<div class="w-full px-3 py-2 border border-yellow-300 dark:border-yellow-600 rounded-md bg-yellow-50 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-200"><p class="text-sm"> </p> <p class="text-xs mt-1"><a class="text-yellow-700 dark:text-yellow-300 hover:underline">Create a template first</a> or proceed without a template to use default behavior.</p></div>'),ct=w('<span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"> <button type="button" class="ml-1 h-4 w-4 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800 flex items-center justify-center cursor-pointer"><svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></span>'),ft=w('<div class="flex flex-wrap gap-2"></div>'),vt=w('<div class="flex items-center"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div> Updating...</div>'),mt=w('<div class="max-w-6xl w-full max-h-[90vh] overflow-y-auto"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700"><h2 class="text-xl font-semibold text-gray-900 dark:text-white"> </h2></div> <form class="p-6 space-y-6"><!> <!> <div class="bg-gray-50 dark:bg-gray-900 p-4 rounded-lg"><h3 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Pool Information (Read-only)</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"><div class="flex"><span class="text-gray-500 dark:text-gray-400 w-20 flex-shrink-0">Provider:</span> <span class="text-gray-900 dark:text-white"> </span></div> <div class="flex"><span class="text-gray-500 dark:text-gray-400 w-16 flex-shrink-0">Entity:</span> <span class="text-gray-900 dark:text-white"> </span></div></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Image & OS Configuration</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="image" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Image</label> <input id="image" type="text" placeholder="e.g., ubuntu:22.04" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="flavor" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Flavor</label> <input id="flavor" type="text" placeholder="e.g., default" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="osType" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">OS Type</label> <select id="osType" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>Linux</option><option>Windows</option></select></div> <div><label for="osArch" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Architecture</label> <select id="osArch" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>AMD64</option><option>ARM64</option></select></div> <div class="col-span-2"><label for="template" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Runner Install Template</label> <!></div></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Runner Limits & Timing</h3> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label for="minIdleRunners" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Min Idle Runners</label> <input id="minIdleRunners" type="number" min="0" placeholder="0"/></div> <div><label for="maxRunners" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Max Runners</label> <input id="maxRunners" type="number" min="1" placeholder="10"/></div> <div><label for="bootstrapTimeout" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Bootstrap Timeout (min)</label> <input id="bootstrapTimeout" type="number" min="1" placeholder="20" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Advanced Settings</h3> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label for="runnerPrefix" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Runner Prefix</label> <input id="runnerPrefix" type="text" placeholder="garm" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="priority" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Priority</label> <input id="priority" type="number" min="1" placeholder="100" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="githubRunnerGroup" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">GitHub Runner Group (optional)</label> <input id="githubRunnerGroup" type="text" placeholder="Default group" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div></div> <div><fieldset><legend class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Tags</legend> <div class="space-y-2"><div class="flex"><input type="text" placeholder="Enter a tag" class="flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-l-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/> <button type="button" class="px-3 py-2 bg-blue-600 text-white rounded-r-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer">Add</button></div> <!></div></fieldset></div> <div><fieldset><legend class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Extra Specs (JSON)</legend> <!></fieldset></div> <div class="flex items-center"><input id="enabled" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="enabled" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">Pool enabled</label></div></div> <div class="flex justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer">Cancel</button> <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer"><!></button></div></form></div>');function Pt(hr,Je){Kr(Je,!1);const[kr,wr]=et(),U=()=>rt(nt,"$eagerCache",kr);let a=Zr(Je,"pool",8);const Z=Wr();let z=u(!1),D=u(""),T=u(""),m=u([]),ee=u(!1),L=u(a().image||""),F=u(a().flavor||""),O=u(a().max_runners),P=u(a().min_idle_runners),q=u(a().runner_bootstrap_timeout),H=u(a().priority),K=u(a().runner_prefix||""),y=u(a().os_type||"linux"),j=u(a().os_arch||"amd64"),W=u(a()["github-runner-group"]||""),Q=u(a().enabled),x=u((a().tags||[]).map(i=>i.name||"").filter(Boolean)),C=u(""),A=u("{}"),$=u(a().template_id);function Tr(i){if(i.repo_id){const s=U().repositories.find(p=>p.id===i.repo_id);return s?`${s.owner}/${s.name}`:"Unknown Entity"}if(i.org_id){const s=U().organizations.find(p=>p.id===i.org_id);return s&&s.name?s.name:"Unknown Entity"}if(i.enterprise_id){const s=U().enterprises.find(p=>p.id===i.enterprise_id);return s&&s.name?s.name:"Unknown Entity"}return"Unknown Entity"}function $r(i){return i.repo_id?"Repository":i.org_id?"Organization":i.enterprise_id?"Enterprise":"Unknown"}function re(){if(a().endpoint?.endpoint_type)return a().endpoint.endpoint_type;if(a().repo_id){const i=U().repositories.find(s=>s.id===a().repo_id);if(i?.endpoint?.endpoint_type)return i.endpoint.endpoint_type}if(a().org_id){const i=U().organizations.find(s=>s.id===a().org_id);if(i?.endpoint?.endpoint_type)return i.endpoint.endpoint_type}if(a().enterprise_id){const i=U().enterprises.find(s=>s.id===a().enterprise_id);if(i?.endpoint?.endpoint_type)return i.endpoint.endpoint_type}return null}async function Me(){try{n(ee,!0);const i=re();if(!i){n(m,[]);return}if(n(m,await tt.listTemplates(e(y),void 0,i)),!e($)||!e(m).find(s=>s.id===e($))){const s=e(m).find(p=>p.owner_id==="system");s?n($,s.id):e(m).length>0&&n($,e(m)[0].id)}}catch(i){n(D,_r(i))}finally{n(ee,!1)}}Qr(()=>{if(a().extra_specs)try{if(typeof a().extra_specs=="object")n(A,JSON.stringify(a().extra_specs,null,2));else{const i=JSON.parse(a().extra_specs);n(A,JSON.stringify(i,null,2))}}catch{n(A,a().extra_specs||"{}")}Me()});function Ne(){e(C).trim()&&!e(x).includes(e(C).trim())&&(n(x,[...e(x),e(C).trim()]),n(C,""))}function Er(i){n(x,e(x).filter((s,p)=>p!==i))}function Rr(i){i.key==="Enter"&&(i.preventDefault(),Ne())}async function Sr(){try{if(n(z,!0),n(D,""),e(T))throw new Error(e(T));let i={};if(e(A).trim())try{i=JSON.parse(e(A))}catch{throw new Error("Invalid JSON in extra specs")}const s={image:e(L)!==a().image?e(L):void 0,flavor:e(F)!==a().flavor?e(F):void 0,max_runners:e(O)!==a().max_runners?e(O):void 0,min_idle_runners:e(P)!==a().min_idle_runners?e(P):void 0,runner_bootstrap_timeout:e(q)!==a().runner_bootstrap_timeout?e(q):void 0,priority:e(H)!==a().priority?e(H):void 0,runner_prefix:e(K)!==a().runner_prefix?e(K):void 0,os_type:e(y)!==a().os_type?e(y):void 0,os_arch:e(j)!==a().os_arch?e(j):void 0,"github-runner-group":e(W)!==a()["github-runner-group"]&&e(W)||void 0,enabled:e(Q)!==a().enabled?e(Q):void 0,tags:JSON.stringify(e(x))!==JSON.stringify((a().tags||[]).map(p=>p.name||"").filter(Boolean))?e(x):void 0,extra_specs:e(A).trim()!==JSON.stringify(a().extra_specs||{},null,2).trim()?i:void 0,template_id:e($)!==a().template_id?e($):void 0};Object.keys(s).forEach(p=>{s[p]===void 0&&delete s[p]}),Z("submit",s)}catch(i){n(D,_r(i))}finally{n(z,!1)}}pr(()=>e(y),()=>{e(y)&&Me()}),pr(()=>(e(P),e(O)),()=>{e(P)!==null&&e(P)!==void 0&&e(O)!==null&&e(O)!==void 0&&e(P)>e(O)?n(T,"Min idle runners cannot be greater than max runners"):n(T,"")}),Vr(),Hr(),ot(hr,{$$events:{close:()=>Z("close")},children:(i,s)=>{var p=mt(),te=d(p),Ie=d(te),Or=d(Ie);t(Ie),t(te);var ae=o(te,2),Ue=d(ae);{var Pr=r=>{var l=st(),E=d(l),J=d(E,!0);t(E),t(l),v(()=>h(J,e(D))),c(r,l)};I(Ue,r=>{e(D)&&r(Pr)})}var Ce=o(Ue,2);{var Ar=r=>{var l=lt(),E=d(l),J=d(E,!0);t(E),t(l),v(()=>h(J,e(T))),c(r,l)};I(Ce,r=>{e(T)&&r(Ar)})}var de=o(Ce,2),De=o(d(de),2),oe=d(De),je=o(d(oe),2),Jr=d(je,!0);t(je),t(oe);var Be=o(oe,2),Ge=o(d(Be),2),Mr=d(Ge);t(Ge),t(Be),t(De),t(de);var ie=o(de,2),ze=o(d(ie),2),ne=d(ze),Le=o(d(ne),2);k(Le),t(ne);var se=o(ne,2),Fe=o(d(se),2);k(Fe),t(se);var le=o(se,2),ue=o(d(le),2);v(()=>{e(y),Pe(()=>{})});var pe=d(ue);pe.value=pe.__value="linux";var qe=o(pe);qe.value=qe.__value="windows",t(ue),t(le);var be=o(le,2),ge=o(d(be),2);v(()=>{e(j),Pe(()=>{})});var ce=d(ge);ce.value=ce.__value="amd64";var He=o(ce);He.value=He.__value="arm64",t(ge),t(be);var Ke=o(be,2),Nr=o(d(Ke),2);{var Ir=r=>{var l=ut();c(r,l)},Ur=r=>{var l=Xr(),E=gr(l);{var J=_=>{var R=bt(),f=gr(R);v(()=>{e($),Pe(()=>{e(m)})}),fr(f,5,()=>e(m),vr,(M,g)=>{var N=pt(),sr=d(N),Fr=o(sr);{var qr=Oe=>{var ur=cr();v(()=>h(ur,`- ${e(g),b(()=>e(g).description)??""}`)),c(Oe,ur)};I(Fr,Oe=>{e(g),b(()=>e(g).description)&&Oe(qr)})}t(N);var lr={};v(()=>{h(sr,`${e(g),b(()=>e(g).name)??""} ${e(g),b(()=>e(g).owner_id==="system"?"(System)":"")??""} `),lr!==(lr=(e(g),b(()=>e(g).id)))&&(N.value=(N.__value=(e(g),b(()=>e(g).id)))??"")}),c(M,N)}),t(f);var X=o(f,2),Y=d(X);t(X),v(M=>h(Y,`Templates define how the runner software is installed and configured.
								Showing templates for ${M??""} ${e(y)??""}.`),[()=>b(re)]),Ae(f,()=>e($),M=>n($,M)),c(_,R)},Se=_=>{var R=gt(),f=d(R),X=d(f);t(f);var Y=o(f,2),M=d(Y);br(),t(Y),t(R),v((g,N)=>{h(X,`No templates found for ${g??""} ${e(y)??""}.`),yr(M,"href",N)},[()=>b(re),()=>(B(xr),b(()=>xr("/templates")))]),c(_,R)};I(E,_=>{e(m),b(()=>e(m).length>0)?_(J):_(Se,!1)},!0)}c(r,l)};I(Nr,r=>{e(ee)?r(Ir):r(Ur,!1)})}t(Ke),t(ze),t(ie);var fe=o(ie,2),We=o(d(fe),2),ve=d(We),me=o(d(ve),2);k(me),t(ve);var ye=o(ve,2),xe=o(d(ye),2);k(xe),t(ye);var Qe=o(ye,2),Ve=o(d(Qe),2);k(Ve),t(Qe),t(We),t(fe);var _e=o(fe,2),he=o(d(_e),2),ke=d(he),Xe=o(d(ke),2);k(Xe),t(ke);var we=o(ke,2),Ye=o(d(we),2);k(Ye),t(we);var Ze=o(we,2),er=o(d(Ze),2);k(er),t(Ze),t(he);var Te=o(he,2),rr=d(Te),tr=o(d(rr),2),$e=d(tr),V=d($e);k(V);var Cr=o(V,2);t($e);var Dr=o($e,2);{var jr=r=>{var l=ft();fr(l,5,()=>e(x),vr,(E,J,Se)=>{var _=ct(),R=d(_),f=o(R);t(_),v(()=>{h(R,`${e(J)??""} `),yr(f,"aria-label",`Remove tag ${e(J)??""}`)}),G("click",f,()=>Er(Se)),c(E,_)}),t(l),c(r,l)};I(Dr,r=>{e(x),b(()=>e(x).length>0)&&r(jr)})}t(tr),t(rr),t(Te);var Ee=o(Te,2),ar=d(Ee),Br=o(d(ar),2);it(Br,{rows:4,placeholder:"{}",get value(){return e(A)},set value(r){n(A,r)},$$legacy:!0}),t(ar),t(Ee);var dr=o(Ee,2),or=d(dr);k(or),br(2),t(dr),t(_e);var ir=o(_e,2),nr=d(ir),Re=o(nr,2),Gr=d(Re);{var zr=r=>{var l=vt();c(r,l)},Lr=r=>{var l=cr("Update Pool");c(r,l)};I(Gr,r=>{e(z)?r(zr):r(Lr,!1)})}t(Re),t(ir),t(ae),t(p),v((r,l)=>{h(Or,`Update Pool ${B(a()),b(()=>a().id)??""}`),h(Jr,(B(a()),b(()=>a().provider_name))),h(Mr,`${r??""}: ${l??""}`),mr(me,1,`w-full px-3 py-2 border ${e(T)?"border-red-300 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white`),mr(xe,1,`w-full px-3 py-2 border ${e(T)?"border-red-300 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white`),Re.disabled=e(z)||e(T)!==""},[()=>(B(a()),b(()=>$r(a()))),()=>(B(a()),b(()=>Tr(a())))]),S(Le,()=>e(L),r=>n(L,r)),S(Fe,()=>e(F),r=>n(F,r)),Ae(ue,()=>e(y),r=>n(y,r)),Ae(ge,()=>e(j),r=>n(j,r)),S(me,()=>e(P),r=>n(P,r)),S(xe,()=>e(O),r=>n(O,r)),S(Ve,()=>e(q),r=>n(q,r)),S(Xe,()=>e(K),r=>n(K,r)),S(Ye,()=>e(H),r=>n(H,r)),S(er,()=>e(W),r=>n(W,r)),S(V,()=>e(C),r=>n(C,r)),G("keydown",V,Rr),G("click",Cr,Ne),at(or,()=>e(Q),r=>n(Q,r)),G("click",nr,()=>Z("close")),G("submit",ae,dt(Sr)),c(i,p)},$$slots:{default:!0}}),Yr(),wr()}export{Pt as U};
