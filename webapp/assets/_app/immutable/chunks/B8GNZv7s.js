import{c as Ye,a as _,s as p,b as g,t as Ze,e as ke,l as ea,f as h}from"./CxOx-TIJ.js";import{i as aa}from"./3NxSoY2_.js";import{p as ta,B as ra,o as sa,d as C,c as t,r,s as o,t as x,g as e,m as b,u as v,i as U,v as we,j as n,w as R,h as N,a as oa,n as na,F as m}from"./DzFKsO_V.js";import{p as Me,i as W}from"./B_jyf0qs.js";import{e as ia,i as la}from"./CdXRaxkX.js";import{w as da}from"./DoJxysSt.js";import{b as Ce,r as oe,g as ca}from"./BguOOs3x.js";import{b as va,a as Ee}from"./BVM1034P.js";import{p as pa}from"./CdEA5IGF.js";import{e as Se}from"./BZiHL9L3.js";import{M as ua}from"./Pgjt70l7.js";i[m]="src/lib/components/UpdateEntityModal.svelte";var ga=_(h('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),i[m],[[134,4,[[135,5]]]]),ba=_(h('<div><span class="text-gray-500 dark:text-gray-400">Owner:</span> <span class="ml-2 text-gray-900 dark:text-white"> </span></div>'),i[m],[[144,6,[[145,7],[146,7]]]]),ma=_(h('<div class="animate-pulse bg-gray-200 dark:bg-gray-700 h-10 rounded"></div>'),i[m],[[175,6]]),fa=_(h("<option> </option>"),i[m],[[184,8]]),ya=_(h('<select id="credentials" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>Keep current credentials</option><!></select>'),i[m],[[177,6,[[182,7]]]]),xa=_(h('<div><label for="webhookSecret" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">New Webhook Secret <span class="text-red-500">*</span></label> <input id="webhookSecret" type="password" placeholder="Enter new webhook secret" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Leave empty to auto-generate a new secret</p></div>'),i[m],[[250,6,[[251,7,[[252,27]]],[254,7],[262,7]]]]),_a=_(h('<div class="flex items-center"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div> Updating...</div>'),i[m],[[285,6,[[286,7]]]]),ha=_(h('<div class="max-w-2xl w-full"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700"><h2 class="text-xl font-semibold text-gray-900 dark:text-white"> </h2> <p class="mt-1 text-sm text-gray-500 dark:text-gray-400"> </p></div> <form class="p-6 space-y-6"><!> <div class="bg-gray-50 dark:bg-gray-900 p-4 rounded-lg"><h3 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"> </h3> <div class="space-y-2 text-sm"><!> <div><span class="text-gray-500 dark:text-gray-400">Name:</span> <span class="ml-2 text-gray-900 dark:text-white"> </span></div> <div><span class="text-gray-500 dark:text-gray-400">Endpoint:</span> <span class="ml-2 text-gray-900 dark:text-white"> </span></div> <div><span class="text-gray-500 dark:text-gray-400">Current Credentials:</span> <span class="ml-2 text-gray-900 dark:text-white"> </span></div> <div><span class="text-gray-500 dark:text-gray-400">Current Pool Balancer:</span> <span class="ml-2 text-gray-900 dark:text-white"> </span></div></div></div> <div class="space-y-4"><div><label for="credentials" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Credentials</label> <!> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Leave unchanged to keep current credentials</p></div> <div><label for="poolBalancer" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Pool Balancer Type</label> <select id="poolBalancer" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>Round Robin</option><option>Pack</option></select> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Round Robin distributes jobs evenly across pools, Pack fills pools in order</p></div> <div class="flex items-center"><input id="agentMode" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="agentMode" class="ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Agent Mode</label> <div class="ml-2 relative group"><svg class="w-4 h-4 text-gray-400 cursor-help" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-80 p-3 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">When enabled, runners will be installed with the GARM agent via userdata install templates. This allows for enhanced runner management and control. <div class="absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"></div></div></div></div> <div class="space-y-3"><div class="flex items-center"><input id="changeWebhookSecret" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="changeWebhookSecret" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">Change webhook secret</label></div> <!></div></div> <div class="flex justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer">Cancel</button> <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer"><!></button></div></form></div>'),i[m],[[126,1,[[127,2,[[128,3],[129,3]]],[132,2,[[140,3,[[141,4],[142,4,[[149,5,[[150,6],[151,6]]],[153,5,[[154,6],[155,6]]],[157,5,[[158,6],[159,6]]],[161,5,[[162,6],[163,6]]]]]]],[168,3,[[170,4,[[171,5],[190,5]]],[196,4,[[197,5],[200,5,[[205,6],[206,6]]],[208,5]]],[214,4,[[215,5],[221,5],[224,5,[[225,6,[[226,7]]],[228,6,[[230,7]]]]]]],[236,4,[[237,5,[[238,6],[244,6]]]]]]],[271,3,[[272,4],[279,4]]]]]]]]);function i(Ue,z){Ye(new.target),ta(z,!1,i);let l=Me(z,"entity",8),B=Me(z,"entityType",8);const j=ra();let P=b(!1),E=b(""),D=b([]),F=b(!1),k=b(""),w=b(""),M=b(""),f=b(!1),T=b(!1);function Be(){if(U(B(),"repository")){const c=l();return`${c.owner}/${c.name}`}return l().name||""}function I(){return B().charAt(0).toUpperCase()+B().slice(1)}function Pe(){return U(B(),"repository")&&l().owner||""}async function Te(){try{n(F,!0),n(D,(await na(ca.listCredentials()))())}catch(c){n(E,Se(c))}finally{n(F,!1)}}function Ae(){n(k,l().credentials_name||""),n(w,l().pool_balancing_type||"roundrobin"),n(M,""),n(f,!1),n(T,l().agent_mode??!1)}async function $e(){try{n(P,!0),n(E,"");const c={};let S=!1;if(e(k)&&U(e(k),l().credentials_name,!1)&&(c.credentials_name=e(k),S=!0),e(w)&&U(e(w),l().pool_balancing_type,!1)&&(c.pool_balancer_type=e(w),S=!0),U(e(T),l().agent_mode,!1)&&(c.agent_mode=e(T),S=!0),e(f)){if(!e(M).trim()){n(E,"Please enter a webhook secret or uncheck the option to change it");return}c.webhook_secret=e(M),S=!0}if(!S){j("close");return}j("submit",c)}catch(c){n(E,Se(c))}finally{n(P,!1)}}return sa(()=>{Te(),Ae()}),aa(),C(()=>ua(Ue,{$$events:{close:()=>j("close")},children:da(i,(c,S)=>{var L=ha(),q=t(L),O=t(q),Re=t(O);r(O);var ne=o(O,2),We=t(ne,!0);r(ne),r(q);var G=o(q,2),ie=t(G);{var je=a=>{var s=ga(),d=t(s),u=t(d,!0);r(d),r(s),x(()=>p(u,e(E))),g(a,s)};C(()=>W(ie,a=>{e(E)&&a(je)}),"if",i,133,3)}var K=o(ie,2),H=t(K),Ne=t(H);r(H);var le=o(H,2),de=t(le);{var ze=a=>{var s=ba(),d=o(t(s),2),u=t(d,!0);r(d),r(s),x(A=>p(u,A),[()=>v(Pe)]),g(a,s)};C(()=>W(de,a=>{U(B(),"repository")&&a(ze)}),"if",i,143,5)}var J=o(de,2),ce=o(t(J),2),De=t(ce,!0);r(ce),r(J);var Q=o(J,2),ve=o(t(Q),2),Fe=t(ve,!0);r(ve),r(Q);var V=o(Q,2),pe=o(t(V),2),Ie=t(pe,!0);r(pe),r(V);var ue=o(V,2),ge=o(t(ue),2),Le=t(ge,!0);r(ge),r(ue),r(le),r(K);var X=o(K,2),Y=t(X),qe=o(t(Y),2);{var Oe=a=>{var s=ma();g(a,s)},Ge=a=>{var s=ya();x(()=>{e(k),we(()=>{e(D)})});var d=t(s);d.value=d.__value="";var u=o(d);C(()=>ia(u,1,()=>e(D),la,(A,y)=>{var $=fa(),Xe=t($);r($);var he={};x(()=>{p(Xe,`${e(y),v(()=>e(y).name)??""} (${e(y),v(()=>e(y).endpoint?.name||"Unknown")??""})`),he!==(he=(e(y),v(()=>e(y).name)))&&($.value=($.__value=(e(y),v(()=>e(y).name)))??"")}),g(A,$)}),"each",i,183,7),r(s),Ce(s,()=>e(k),A=>n(k,A)),g(a,s)};C(()=>W(qe,a=>{e(F)?a(Oe):a(Ge,!1)}),"if",i,174,5)}R(2),r(Y);var Z=o(Y,2),ee=o(t(Z),2);x(()=>{e(w),we(()=>{})});var ae=t(ee);ae.value=ae.__value="roundrobin";var be=o(ae);be.value=be.__value="pack",r(ee),R(2),r(Z);var te=o(Z,2),me=t(te);oe(me),R(4),r(te);var fe=o(te,2),re=t(fe),ye=t(re);oe(ye),R(2),r(re);var Ke=o(re,2);{var He=a=>{var s=xa(),d=o(t(s),2);oe(d),R(2),r(s),x(()=>d.required=e(f)),va(d,()=>e(M),u=>n(M,u)),g(a,s)};C(()=>W(Ke,a=>{e(f)&&a(He)}),"if",i,249,5)}r(fe),r(X);var xe=o(X,2),_e=t(xe),se=o(_e,2),Je=t(se);{var Qe=a=>{var s=_a();g(a,s)},Ve=a=>{var s=Ze();x(d=>p(s,`Update ${d??""}`),[()=>v(I)]),g(a,s)};C(()=>W(Je,a=>{e(P)?a(Qe):a(Ve,!1)}),"if",i,284,5)}r(se),r(xe),r(G),r(L),x((a,s,d,u)=>{p(Re,`Update ${a??""}`),p(We,s),p(Ne,`${d??""} Information`),p(De,(N(l()),v(()=>l().name))),p(Fe,(N(l()),v(()=>l().endpoint?.name))),p(Ie,(N(l()),v(()=>l().credentials_name))),p(Le,(N(l()),v(()=>l().pool_balancing_type||"roundrobin"))),se.disabled=u},[()=>v(I),()=>v(Be),()=>v(I),()=>(e(P),e(f),e(M),v(()=>e(P)||e(f)&&!e(M).trim()))]),Ce(ee,()=>e(w),a=>n(w,a)),Ee(me,()=>e(T),a=>n(T,a)),Ee(ye,()=>e(f),a=>n(f,a)),ke("click",_e,()=>j("close")),ke("submit",G,pa($e)),g(c,L)}),$$slots:{default:!0}}),"component",i,125,0,{componentTag:"Modal"}),oa({...ea()})}export{i as U};
