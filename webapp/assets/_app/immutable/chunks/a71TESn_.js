import"./DsnmJJEf.js";import{i as Ar}from"./C7KraPli.js";import{p as Jr,E as Mr,m as u,o as Nr,k as s,l as or,g as e,h as Pr,f as M,d,r as a,s as o,q as R,u as p,t as f,y as Re,z as sr,e as y,i as ir,b,D,B as Ee,a as Q,c as Cr}from"./cPTQ2Ibn.js";import{p as Ur,i as E,s as Dr,a as Gr}from"./DqFqoVWr.js";import{e as jr,i as zr}from"./CiWDXYQd.js";import{r as $,s as nr,b as $e,g as Br,d as lr,c as Lr}from"./CdlKrnos.js";import{b as J,a as Fr}from"./B-_QCM7E.js";import{p as qr}from"./D4Caz1gY.js";import{M as Hr}from"./B1YG4Mwt.js";import{e as ur}from"./BZiHL9L3.js";import{J as Wr}from"./BRfNU74s.js";import{e as Kr}from"./DDCRlL5j.js";var Qr=M('<div class="rounded-md bg-red-50 dark:bg-red-900 p-4"><p class="text-sm font-medium text-red-800 dark:text-red-200"> </p></div>'),Vr=M('<div class="rounded-md bg-yellow-50 dark:bg-yellow-900 p-4"><p class="text-sm font-medium text-yellow-800 dark:text-yellow-200"> </p></div>'),Xr=M('<div class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 flex items-center"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"></div> <span class="text-sm text-gray-600 dark:text-gray-400">Loading templates...</span></div>'),Yr=M("<option> <!></option>"),Zr=M('<select id="template" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"></select> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400"> </p>',1),et=M('<div class="w-full px-3 py-2 border border-yellow-300 dark:border-yellow-600 rounded-md bg-yellow-50 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-200"><p class="text-sm"> </p> <p class="text-xs mt-1"><a class="text-yellow-700 dark:text-yellow-300 hover:underline">Create a template first</a> or proceed without a template to use default behavior.</p></div>'),rt=M('<div class="flex items-center"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div> Updating...</div>'),tt=M('<div class="max-w-6xl w-full max-h-[90vh] overflow-y-auto"><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700"><h2 class="text-xl font-semibold text-gray-900 dark:text-white"> </h2></div> <form class="p-6 space-y-6"><!> <!> <div class="bg-gray-50 dark:bg-gray-900 p-4 rounded-lg"><h3 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Scale Set Information</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"><div class="flex"><span class="text-gray-500 dark:text-gray-400 w-20 flex-shrink-0">Provider:</span> <span class="text-gray-900 dark:text-white"> </span></div> <div class="flex"><span class="text-gray-500 dark:text-gray-400 w-16 flex-shrink-0">Entity:</span> <span class="text-gray-900 dark:text-white"><!></span></div></div></div> <div><label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Name</label> <input id="name" type="text" placeholder="e.g., my-scale-set" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Image & OS Configuration</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="image" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Image</label> <input id="image" type="text" placeholder="e.g., ubuntu:22.04" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="flavor" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Flavor</label> <input id="flavor" type="text" placeholder="e.g., default" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="osType" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">OS Type</label> <select id="osType" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>Linux</option><option>Windows</option></select></div> <div><label for="osArch" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Architecture</label> <select id="osArch" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"><option>AMD64</option><option>ARM64</option></select></div> <div class="col-span-2"><label for="template" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Runner Install Template</label> <!></div></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Runner Limits & Timing</h3> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label for="minIdleRunners" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Min Idle Runners</label> <input id="minIdleRunners" type="number" min="0" placeholder="0"/></div> <div><label for="maxRunners" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Max Runners</label> <input id="maxRunners" type="number" min="1" placeholder="10"/></div> <div><label for="bootstrapTimeout" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Bootstrap Timeout (min)</label> <input id="bootstrapTimeout" type="number" min="1" placeholder="20" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div></div></div> <div class="space-y-4"><h3 class="text-lg font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2">Advanced Settings</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="runnerPrefix" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Runner Prefix</label> <input id="runnerPrefix" type="text" placeholder="garm" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div> <div><label for="githubRunnerGroup" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">GitHub Runner Group (optional)</label> <input id="githubRunnerGroup" type="text" placeholder="Default group" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"/></div></div> <div><fieldset><legend class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Extra Specs (JSON)</legend> <!></fieldset></div> <div class="flex items-center"><input id="enabled" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"/> <label for="enabled" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">Scale set enabled</label></div></div> <div class="flex justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700"><button type="button" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer">Cancel</button> <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer"><!></button></div></form></div>');function vt(pr,Oe){Jr(Oe,!1);const[br,cr]=Dr(),V=()=>Gr(Kr,"$eagerCache",br);let r=Ur(Oe,"scaleSet",8);const X=Mr();let z=u(!1),G=u(""),k=u(""),x=u([]),Y=u(!1),B=u(r().name||""),L=u(r().image||""),F=u(r().flavor||""),O=u(r().max_runners),I=u(r().min_idle_runners),q=u(r().runner_bootstrap_timeout),H=u(r().runner_prefix||""),_=u(r().os_type||"linux"),j=u(r().os_arch||"amd64"),W=u(r()["github-runner-group"]||""),K=u(r().enabled),A=u("{}"),w=u(r().template_id);function Z(){if(r().endpoint?.endpoint_type)return r().endpoint.endpoint_type;if(r().repo_id){const i=V().repositories.find(c=>c.id===r().repo_id);if(i?.endpoint?.endpoint_type)return i.endpoint.endpoint_type}if(r().org_id){const i=V().organizations.find(c=>c.id===r().org_id);if(i?.endpoint?.endpoint_type)return i.endpoint.endpoint_type}if(r().enterprise_id){const i=V().enterprises.find(c=>c.id===r().enterprise_id);if(i?.endpoint?.endpoint_type)return i.endpoint.endpoint_type}return null}async function Ie(){try{s(Y,!0);const i=Z();if(!i){s(x,[]);return}if(s(x,await Br.listTemplates(e(_),void 0,i)),!e(w)||!e(x).find(c=>c.id===e(w))){const c=e(x).find(S=>S.owner_id==="system");c?s(w,c.id):e(x).length>0&&s(w,e(x)[0].id)}}catch(i){s(G,ur(i))}finally{s(Y,!1)}}Nr(()=>{if(r().extra_specs)try{if(typeof r().extra_specs=="object")s(A,JSON.stringify(r().extra_specs,null,2));else{const i=JSON.parse(r().extra_specs);s(A,JSON.stringify(i,null,2))}}catch{s(A,r().extra_specs||"{}")}Ie()});async function gr(){try{if(s(z,!0),s(G,""),e(k))throw new Error(e(k));let i={};if(e(A).trim())try{i=JSON.parse(e(A))}catch{throw new Error("Invalid JSON in extra specs")}const c={name:e(B)!==r().name?e(B):void 0,image:e(L)!==r().image?e(L):void 0,flavor:e(F)!==r().flavor?e(F):void 0,max_runners:e(O)!==r().max_runners?e(O):void 0,min_idle_runners:e(I)!==r().min_idle_runners?e(I):void 0,runner_bootstrap_timeout:e(q)!==r().runner_bootstrap_timeout?e(q):void 0,runner_prefix:e(H)!==r().runner_prefix?e(H):void 0,os_type:e(_)!==r().os_type?e(_):void 0,os_arch:e(j)!==r().os_arch?e(j):void 0,"github-runner-group":e(W)!==r()["github-runner-group"]&&e(W)||void 0,enabled:e(K)!==r().enabled?e(K):void 0,extra_specs:e(A).trim()!==JSON.stringify(r().extra_specs||{},null,2).trim()?i:void 0,template_id:e(w)!==r().template_id?e(w):void 0};Object.keys(c).forEach(S=>{c[S]===void 0&&delete c[S]}),X("submit",c)}catch(i){s(G,ur(i))}finally{s(z,!1)}}or(()=>e(_),()=>{e(_)&&Ie()}),or(()=>(e(I),e(O)),()=>{e(I)!==null&&e(I)!==void 0&&e(O)!==null&&e(O)!==void 0&&e(I)>e(O)?s(k,"Min idle runners cannot be greater than max runners"):s(k,"")}),Pr(),Ar(),Hr(pr,{$$events:{close:()=>X("close")},children:(i,c)=>{var S=tt(),ee=d(S),Ae=d(ee),vr=d(Ae);a(Ae),a(ee);var re=o(ee,2),Je=d(re);{var fr=t=>{var n=Qr(),T=d(n),N=d(T,!0);a(T),a(n),f(()=>y(N,e(G))),b(t,n)};E(Je,t=>{e(G)&&t(fr)})}var Me=o(Je,2);{var mr=t=>{var n=Vr(),T=d(n),N=d(T,!0);a(T),a(n),f(()=>y(N,e(k))),b(t,n)};E(Me,t=>{e(k)&&t(mr)})}var te=o(Me,2),Ne=o(d(te),2),ae=d(Ne),Pe=o(d(ae),2),yr=d(Pe,!0);a(Pe),a(ae);var Ce=o(ae,2),Ue=o(d(Ce),2),xr=d(Ue);{var _r=t=>{var n=D();f(()=>y(n,`Repository: ${R(r()),p(()=>r().repo_name)??""}`)),b(t,n)},hr=t=>{var n=Ee(),T=Q(n);{var N=v=>{var m=D();f(()=>y(m,`Organization: ${R(r()),p(()=>r().org_name)??""}`)),b(v,m)},Se=v=>{var m=Ee(),h=Q(m);{var C=g=>{var l=D();f(()=>y(l,`Enterprise: ${R(r()),p(()=>r().enterprise_name)??""}`)),b(g,l)},U=g=>{var l=D("Unknown Entity");b(g,l)};E(h,g=>{R(r()),p(()=>r().enterprise_name)?g(C):g(U,!1)},!0)}b(v,m)};E(T,v=>{R(r()),p(()=>r().org_name)?v(N):v(Se,!1)},!0)}b(t,n)};E(xr,t=>{R(r()),p(()=>r().repo_name)?t(_r):t(hr,!1)})}a(Ue),a(Ce),a(Ne),a(te);var de=o(te,2),De=o(d(de),2);$(De),a(de);var oe=o(de,2),Ge=o(d(oe),2),se=d(Ge),je=o(d(se),2);$(je),a(se);var ie=o(se,2),ze=o(d(ie),2);$(ze),a(ie);var ne=o(ie,2),le=o(d(ne),2);f(()=>{e(_),Re(()=>{})});var ue=d(le);ue.value=ue.__value="linux";var Be=o(ue);Be.value=Be.__value="windows",a(le),a(ne);var pe=o(ne,2),be=o(d(pe),2);f(()=>{e(j),Re(()=>{})});var ce=d(be);ce.value=ce.__value="amd64";var Le=o(ce);Le.value=Le.__value="arm64",a(be),a(pe);var Fe=o(pe,2),kr=o(d(Fe),2);{var wr=t=>{var n=Xr();b(t,n)},Sr=t=>{var n=Ee(),T=Q(n);{var N=v=>{var m=Zr(),h=Q(m);f(()=>{e(w),Re(()=>{e(x)})}),jr(h,5,()=>e(x),zr,(g,l)=>{var P=Yr(),tr=d(P),Or=o(tr);{var Ir=Te=>{var dr=D();f(()=>y(dr,`- ${e(l),p(()=>e(l).description)??""}`)),b(Te,dr)};E(Or,Te=>{e(l),p(()=>e(l).description)&&Te(Ir)})}a(P);var ar={};f(()=>{y(tr,`${e(l),p(()=>e(l).name)??""} ${e(l),p(()=>e(l).owner_id==="system"?"(System)":"")??""} `),ar!==(ar=(e(l),p(()=>e(l).id)))&&(P.value=(P.__value=(e(l),p(()=>e(l).id)))??"")}),b(g,P)}),a(h);var C=o(h,2),U=d(C);a(C),f(g=>y(U,`Templates define how the runner software is installed and configured.
								Showing templates for ${g??""} ${e(_)??""}.`),[()=>p(Z)]),$e(h,()=>e(w),g=>s(w,g)),b(v,m)},Se=v=>{var m=et(),h=d(m),C=d(h);a(h);var U=o(h,2),g=d(U);sr(),a(U),a(m),f((l,P)=>{y(C,`No templates found for ${l??""} ${e(_)??""}.`),Lr(g,"href",P)},[()=>p(Z),()=>(R(lr),p(()=>lr("/templates")))]),b(v,m)};E(T,v=>{e(x),p(()=>e(x).length>0)?v(N):v(Se,!1)},!0)}b(t,n)};E(kr,t=>{e(Y)?t(wr):t(Sr,!1)})}a(Fe),a(Ge),a(oe);var ge=o(oe,2),qe=o(d(ge),2),ve=d(qe),fe=o(d(ve),2);$(fe),a(ve);var me=o(ve,2),ye=o(d(me),2);$(ye),a(me);var He=o(me,2),We=o(d(He),2);$(We),a(He),a(qe),a(ge);var xe=o(ge,2),_e=o(d(xe),2),he=d(_e),Ke=o(d(he),2);$(Ke),a(he);var Qe=o(he,2),Ve=o(d(Qe),2);$(Ve),a(Qe),a(_e);var ke=o(_e,2),Xe=d(ke),Tr=o(d(Xe),2);Wr(Tr,{rows:4,placeholder:"{}",get value(){return e(A)},set value(t){s(A,t)},$$legacy:!0}),a(Xe),a(ke);var Ye=o(ke,2),Ze=d(Ye);$(Ze),sr(2),a(Ye),a(xe);var er=o(xe,2),rr=d(er),we=o(rr,2),Rr=d(we);{var Er=t=>{var n=rt();b(t,n)},$r=t=>{var n=D("Update Scale Set");b(t,n)};E(Rr,t=>{e(z)?t(Er):t($r,!1)})}a(we),a(er),a(re),a(S),f(()=>{y(vr,`Update Scale Set ${R(r()),p(()=>r().name)??""}`),y(yr,(R(r()),p(()=>r().provider_name))),nr(fe,1,`w-full px-3 py-2 border ${e(k)?"border-red-300 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white`),nr(ye,1,`w-full px-3 py-2 border ${e(k)?"border-red-300 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white`),we.disabled=e(z)||e(k)!==""}),J(De,()=>e(B),t=>s(B,t)),J(je,()=>e(L),t=>s(L,t)),J(ze,()=>e(F),t=>s(F,t)),$e(le,()=>e(_),t=>s(_,t)),$e(be,()=>e(j),t=>s(j,t)),J(fe,()=>e(I),t=>s(I,t)),J(ye,()=>e(O),t=>s(O,t)),J(We,()=>e(q),t=>s(q,t)),J(Ke,()=>e(H),t=>s(H,t)),J(Ve,()=>e(W),t=>s(W,t)),Fr(Ze,()=>e(K),t=>s(K,t)),ir("click",rr,()=>X("close")),ir("submit",re,qr(gr)),b(i,S)},$$slots:{default:!0}}),Cr(),cr()}export{vt as U};
