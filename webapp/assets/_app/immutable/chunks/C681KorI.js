import{f as p,a as l,c as T,t as D,s as B}from"./ZGz3X54u.js";import{i as ae}from"./CY7Wcm-1.js";import{p as se,v as re,l as V,h as ie,d as r,g as t,m as y,b as le,c as v,s as F,r as f,a as oe,f as N,n as q,t as R,u as ne}from"./kDtaAWAK.js";import{p as A,i as m}from"./Cun6jNAp.js";import{g as h,B as G}from"./CYK-UalN.js";import{t as k}from"./BVGCMSWJ.js";import{e as de}from"./BZiHL9L3.js";var ce=p('<div class="flex items-center"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"></div> <span class="text-sm text-gray-500 dark:text-gray-400">Checking...</span></div>'),ve=p('<div class="ml-4 text-xs text-gray-500 dark:text-gray-400"> </div>'),fe=p('<div class="flex items-center"><svg class="w-4 h-4 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg> <span class="text-sm text-green-700 dark:text-green-300">Webhook installed</span></div> <!>',1),he=p('<div class="flex items-center"><svg class="w-4 h-4 text-gray-400 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm0-2a6 6 0 100-12 6 6 0 000 12zm0-10a1 1 0 011 1v3a1 1 0 01-2 0V7a1 1 0 011-1z" clip-rule="evenodd"></path></svg> <span class="text-sm text-gray-500 dark:text-gray-400">No webhook installed</span></div>'),ue=p('<div class="bg-white dark:bg-gray-800 shadow rounded-lg"><div class="px-4 py-5 sm:p-6"><div class="flex items-center justify-between"><div><h3 class="text-lg font-medium text-gray-900 dark:text-white">Webhook Status</h3> <div class="mt-1 flex items-center"><!></div></div> <div class="flex space-x-2"><!></div></div></div></div>');function _e(H,g){se(g,!1);const x=y();let u=A(g,"entityType",8),s=A(g,"entityId",8),E=A(g,"entityName",8),i=y(null),o=y(!1),b=y(!0);const O=re();async function _(){if(s())try{r(b,!0),u()==="repository"?r(i,await h.getRepositoryWebhookInfo(s())):r(i,await h.getOrganizationWebhookInfo(s()))}catch(e){e&&typeof e=="object"&&"response"in e&&e.response?.status===404?r(i,null):(console.warn("Failed to check webhook status:",e),r(i,null))}finally{r(b,!1)}}async function J(){if(s())try{r(o,!0),u()==="repository"?await h.installRepositoryWebhook(s()):await h.installOrganizationWebhook(s()),k.success("Webhook Installed",`Webhook for ${u()} ${E()} has been installed successfully.`),await _(),O("webhookStatusChanged",{installed:!0})}catch(e){k.error("Webhook Installation Failed",e instanceof Error?e.message:"Failed to install webhook.")}finally{r(o,!1)}}async function K(){if(s())try{r(o,!0),u()==="repository"?await h.uninstallRepositoryWebhook(s()):await h.uninstallOrganizationWebhook(s()),k.success("Webhook Uninstalled",`Webhook for ${u()} ${E()} has been uninstalled successfully.`),await _(),O("webhookStatusChanged",{installed:!1})}catch(e){k.error("Webhook Uninstall Failed",de(e))}finally{r(o,!1)}}V(()=>ie(s()),()=>{s()&&_()}),V(()=>t(i),()=>{r(x,t(i)&&t(i).active)}),le(),ae();var w=ue(),P=v(w),j=v(P),W=v(j),L=F(v(W),2),Q=v(L);{var X=e=>{var d=ce();l(e,d)},Y=e=>{var d=T(),I=N(d);{var z=a=>{var n=fe(),C=F(N(n),2);{var c=U=>{var $=ve(),te=v($);f($),R(()=>B(te,`URL: ${t(i),ne(()=>t(i).url||"N/A")??""}`)),l(U,$)};m(C,U=>{t(i)&&U(c)})}l(a,n)},S=a=>{var n=he();l(a,n)};m(I,a=>{t(x)?a(z):a(S,!1)},!0)}l(e,d)};m(Q,e=>{t(b)?e(X):e(Y,!1)})}f(L),f(W);var M=F(W,2),Z=v(M);{var ee=e=>{var d=T(),I=N(d);{var z=a=>{G(a,{variant:"danger",size:"sm",get disabled(){return t(o)},$$events:{click:K},children:(n,C)=>{q();var c=D();R(()=>B(c,t(o)?"Uninstalling...":"Uninstall")),l(n,c)},$$slots:{default:!0}})},S=a=>{G(a,{variant:"primary",size:"sm",get disabled(){return t(o)},$$events:{click:J},children:(n,C)=>{q();var c=D();R(()=>B(c,t(o)?"Installing...":"Install Webhook")),l(n,c)},$$slots:{default:!0}})};m(I,a=>{t(x)?a(z):a(S,!1)})}l(e,d)};m(Z,e=>{t(b)||e(ee)})}f(M),f(j),f(P),f(w),l(H,w),oe()}export{_e as W};
